/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs"],function(t){"use strict";var e=function(e,o){void 0===o&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),o=document),t.Object3D.call(this),this.visible=!1,this.domElement=o;var n=new TransformControlsGizmo;this.add(n);var i=new TransformControlsPlane;this.add(i);var a=this;D("camera",e),D("object",void 0),D("enabled",!0),D("axis",null),D("mode","translate"),D("translationSnap",null),D("rotationSnap",null),D("scaleSnap",null),D("space","world"),D("size",1),D("dragging",!1),D("showX",!0),D("showY",!0),D("showZ",!0);var s={type:"change"},r={type:"mouseDown"},c={type:"mouseUp",mode:a.mode},h={type:"objectChange"},l=new t.Raycaster,p=new t.Vector3,d=new t.Vector3,u=new t.Quaternion,m={X:new t.Vector3(1,0,0),Y:new t.Vector3(0,1,0),Z:new t.Vector3(0,0,1)},v=new t.Vector3,b=new t.Vector3,y=new t.Vector3,f=new t.Vector3,w=new t.Vector3,x=new t.Vector3,E=0,g=new t.Vector3,S=new t.Quaternion,j=new t.Vector3,M=new t.Vector3,L=new t.Quaternion,V=new t.Quaternion,z=new t.Vector3,Q=new t.Vector3,X=new t.Quaternion,Y=new t.Vector3,Z=new t.Vector3,T=new t.Quaternion,W=new t.Quaternion,O=new t.Vector3,C=new t.Vector3,F=new t.Vector3,P=new t.Quaternion,A=new t.Vector3;function D(t,e){var o=e;Object.defineProperty(a,t,{get:function(){return void 0!==o?o:e},set:function(e){o!==e&&(o=e,i[t]=e,n[t]=e,a.dispatchEvent({type:t+"-changed",value:e}),a.dispatchEvent(s))}}),a[t]=e,i[t]=e,n[t]=e}function H(t){if(document.pointerLockElement)return{x:0,y:0,button:t.button};var e=t.changedTouches?t.changedTouches[0]:t,n=o.getBoundingClientRect();return{x:(e.clientX-n.left)/n.width*2-1,y:-(e.clientY-n.top)/n.height*2+1,button:t.button}}function R(t){a.enabled&&a.pointerHover(H(t))}function q(t){a.enabled&&(document.addEventListener("mousemove",k,!1),a.pointerHover(H(t)),a.pointerDown(H(t)))}function k(t){a.enabled&&a.pointerMove(H(t))}function U(t){a.enabled&&(document.removeEventListener("mousemove",k,!1),a.pointerUp(H(t)))}D("worldPosition",Z),D("worldPositionStart",Q),D("worldQuaternion",T),D("worldQuaternionStart",X),D("cameraPosition",g),D("cameraQuaternion",S),D("pointStart",v),D("pointEnd",b),D("rotationAxis",f),D("rotationAngle",E),D("eye",C),o.addEventListener("mousedown",q,!1),o.addEventListener("touchstart",q,!1),o.addEventListener("mousemove",R,!1),o.addEventListener("touchmove",R,!1),o.addEventListener("touchmove",k,!1),document.addEventListener("mouseup",U,!1),o.addEventListener("touchend",U,!1),o.addEventListener("touchcancel",U,!1),o.addEventListener("touchleave",U,!1),this.dispose=function(){o.removeEventListener("mousedown",q),o.removeEventListener("touchstart",q),o.removeEventListener("mousemove",R),document.removeEventListener("mousemove",k),o.removeEventListener("touchmove",R),o.removeEventListener("touchmove",k),document.removeEventListener("mouseup",U),o.removeEventListener("touchend",U),o.removeEventListener("touchcancel",U),o.removeEventListener("touchleave",U),this.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})},this.attach=function(t){return this.object=t,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be THREE part of the scene graph."):this.object.parent.matrixWorld.decompose(M,L,z),this.object.matrixWorld.decompose(Z,T,O),V.copy(L).inverse(),W.copy(T).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(g,S,j),C.copy(g).sub(Z).normalize(),t.Object3D.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(t){if(void 0!==this.object&&!0!==this.dragging&&(void 0===t.button||0===t.button)){l.setFromCamera(t,this.camera);var e=l.intersectObjects(n.picker[this.mode].children,!0)[0]||!1;this.axis=e?e.object.name:null}},this.pointerDown=function(t){if(!(void 0===this.object||!0===this.dragging||void 0!==t.button&&0!==t.button||0!==t.button&&void 0!==t.button||null===this.axis)){l.setFromCamera(t,this.camera);var e=l.intersectObjects([i],!0)[0]||!1;if(e){var o=this.space;if("scale"===this.mode?o="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(o="world"),"local"===o&&"rotate"===this.mode){var n=this.rotationSnap;"X"===this.axis&&n&&(this.object.rotation.x=Math.round(this.object.rotation.x/n)*n),"Y"===this.axis&&n&&(this.object.rotation.y=Math.round(this.object.rotation.y/n)*n),"Z"===this.axis&&n&&(this.object.rotation.z=Math.round(this.object.rotation.z/n)*n)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),F.copy(this.object.position),P.copy(this.object.quaternion),A.copy(this.object.scale),this.object.matrixWorld.decompose(Q,X,Y),v.copy(e.point).sub(Q)}this.dragging=!0,r.mode=this.mode,this.dispatchEvent(r)}},this.pointerMove=function(t){var e=this.axis,o=this.mode,n=this.object,a=this.space;if("scale"===o?a="local":"E"!==e&&"XYZE"!==e&&"XYZ"!==e||(a="world"),void 0!==n&&null!==e&&!1!==this.dragging&&(void 0===t.button||0===t.button)){l.setFromCamera(t,this.camera);var r=l.intersectObjects([i],!0)[0]||!1;if(!1!==r){if(b.copy(r.point).sub(Q),"translate"===o)y.copy(b).sub(v),"local"===a&&"XYZ"!==e&&y.applyQuaternion(W),-1===e.indexOf("X")&&(y.x=0),-1===e.indexOf("Y")&&(y.y=0),-1===e.indexOf("Z")&&(y.z=0),"local"===a&&"XYZ"!==e?y.applyQuaternion(P).divide(z):y.applyQuaternion(V).divide(z),n.position.copy(y).add(F),this.translationSnap&&("local"===a&&(n.position.applyQuaternion(u.copy(P).inverse()),-1!==e.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==e.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==e.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.position.applyQuaternion(P)),"world"===a&&(n.parent&&n.position.add(p.setFromMatrixPosition(n.parent.matrixWorld)),-1!==e.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==e.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==e.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.parent&&n.position.sub(p.setFromMatrixPosition(n.parent.matrixWorld))));else if("scale"===o){if(-1!==e.search("XYZ")){var c=b.length()/v.length();b.dot(v)<0&&(c*=-1),d.set(c,c,c)}else p.copy(v),d.copy(b),p.applyQuaternion(W),d.applyQuaternion(W),d.divide(p),-1===e.search("X")&&(d.x=1),-1===e.search("Y")&&(d.y=1),-1===e.search("Z")&&(d.z=1);n.scale.copy(A).multiply(d),this.scaleSnap&&(-1!==e.search("X")&&(n.scale.x=Math.round(n.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==e.search("Y")&&(n.scale.y=Math.round(n.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==e.search("Z")&&(n.scale.z=Math.round(n.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===o){y.copy(b).sub(v);var g=20/Z.distanceTo(p.setFromMatrixPosition(this.camera.matrixWorld));"E"===e?(f.copy(C),E=b.angleTo(v),w.copy(v).normalize(),x.copy(b).normalize(),E*=x.cross(w).dot(C)<0?1:-1):"XYZE"===e?(f.copy(y).cross(C).normalize(),E=y.dot(p.copy(f).cross(this.eye))*g):"X"!==e&&"Y"!==e&&"Z"!==e||(f.copy(m[e]),p.copy(m[e]),"local"===a&&p.applyQuaternion(T),E=y.dot(p.cross(C).normalize())*g),this.rotationSnap&&(E=Math.round(E/this.rotationSnap)*this.rotationSnap),this.rotationAngle=E,"local"===a&&"E"!==e&&"XYZE"!==e?(n.quaternion.copy(P),n.quaternion.multiply(u.setFromAxisAngle(f,E)).normalize()):(f.applyQuaternion(V),n.quaternion.copy(u.setFromAxisAngle(f,E)),n.quaternion.multiply(P).normalize())}this.dispatchEvent(s),this.dispatchEvent(h)}}},this.pointerUp=function(t){void 0!==t.button&&0!==t.button||(this.dragging&&null!==this.axis&&(c.mode=this.mode,this.dispatchEvent(c)),this.dragging=!1,void 0===t.button&&(this.axis=null))},this.getMode=function(){return a.mode},this.setMode=function(t){a.mode=t},this.setTranslationSnap=function(t){a.translationSnap=t},this.setRotationSnap=function(t){a.rotationSnap=t},this.setScaleSnap=function(t){a.scaleSnap=t},this.setSize=function(t){a.size=t},this.setSpace=function(t){a.space=t},this.update=function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}};return e.prototype=Object.assign(Object.create(t.Object3D.prototype),{constructor:e,isTransformControls:!0}),e});
//# sourceMappingURL=../sourcemaps/controls/TransformControls.js.map

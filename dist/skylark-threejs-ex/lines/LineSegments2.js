/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs","../threex","./LineSegmentsGeometry","./LineMaterial"],function(t,e,r,a){"use strict";var n,i,o=function(e,n){t.Mesh.call(this),this.type="LineSegments2",this.geometry=void 0!==e?e:new r,this.material=void 0!==n?n:new a({color:16777215*Math.random()})};return o.prototype=Object.assign(Object.create(t.Mesh.prototype),{constructor:o,isLineSegments2:!0,computeLineDistances:(n=new t.Vector3,i=new t.Vector3,function(){for(var e=this.geometry,r=e.attributes.instanceStart,a=e.attributes.instanceEnd,o=new Float32Array(2*r.data.count),s=0,c=0,u=r.data.count;s<u;s++,c+=2)n.fromBufferAttribute(r,s),i.fromBufferAttribute(a,s),o[c]=0===c?0:o[c-1],o[c+1]=o[c]+n.distanceTo(i);var l=new t.InstancedInterleavedBuffer(o,2,1);return e.setAttribute("instanceDistanceStart",new t.InterleavedBufferAttribute(l,1,0)),e.setAttribute("instanceDistanceEnd",new t.InterleavedBufferAttribute(l,1,1)),this}),raycast:function(){var e=new t.Vector4,r=new t.Vector4,a=new t.Vector4,n=new t.Vector3,i=new t.Matrix4,o=new t.Line3,s=new t.Vector3;return function(c,u){null===c.camera&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');var l=c.ray,f=c.camera,p=f.projectionMatrix,y=this.geometry,m=this.material,d=m.resolution,w=m.linewidth,x=y.attributes.instanceStart,v=y.attributes.instanceEnd;l.at(1,a),a.w=1,a.applyMatrix4(f.matrixWorldInverse),a.applyMatrix4(p),a.multiplyScalar(1/a.w),a.x*=d.x/2,a.y*=d.y/2,a.z=0,n.copy(a);var b=this.matrixWorld;i.multiplyMatrices(f.matrixWorldInverse,b);for(var h=0,M=x.count;h<M;h++){e.fromBufferAttribute(x,h),r.fromBufferAttribute(v,h),e.w=1,r.w=1,e.applyMatrix4(i),r.applyMatrix4(i),e.applyMatrix4(p),r.applyMatrix4(p),e.multiplyScalar(1/e.w),r.multiplyScalar(1/r.w);var S=e.z<-1&&r.z<-1,g=e.z>1&&r.z>1;if(!S&&!g){e.x*=d.x/2,e.y*=d.y/2,r.x*=d.x/2,r.y*=d.y/2,o.start.copy(e),o.start.z=0,o.end.copy(r),o.end.z=0;var A=o.closestPointToPointParameter(n,!0);o.at(A,s);var L=t.MathUtils.lerp(e.z,r.z,A),z=L>=-1&&L<=1,B=n.distanceTo(s)<.5*w;if(z&&B){o.start.fromBufferAttribute(x,h),o.end.fromBufferAttribute(v,h),o.start.applyMatrix4(b),o.end.applyMatrix4(b);var V=new t.Vector3,I=new t.Vector3;l.distanceSqToSegment(o.start,o.end,I,V),u.push({point:I,pointOnLine:V,distance:l.origin.distanceTo(I),object:this,face:null,faceIndex:h,uv:null,uv2:null})}}}}}()}),e.lines.LineSegments2=o});
//# sourceMappingURL=../sourcemaps/lines/LineSegments2.js.map

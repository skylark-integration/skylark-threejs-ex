{"version":3,"sources":["loaders/obj2/worker/main/WorkerExecutionSupport.js"],"names":["define","CodeBuilderInstructions","supportsStandardWorker","supportsJsmWorker","preferJsmWorker","this","startCode","codeFragments","importStatements","jsmWorkerUrl","defaultGeometryType","prototype","constructor","isSupportsStandardWorker","isSupportsJsmWorker","isPreferJsmWorker","setJsmWorkerUrl","undefined","addStartCode","addCodeFragment","code","push","addLibraryImport","libraryPath","URL","window","location","href","getImportStatements","getCodeFragments","getStartCode","WorkerExecutionSupport","Worker","Blob","createObjectURL","_reset","WORKER_SUPPORT_VERSION","console","info","logging","enabled","debug","scope","worker","native","jsmWorker","workerRunner","name","usesMeshDisassembler","terminateWorkerOnLoad","forceWorkerDataCopy","started","queuedMessage","callbacks","onAssetAvailable","onLoad","terminate","_terminate","setLogging","setForceWorkerDataCopy","setTerminateWorkerOnLoad","isWorkerLoaded","updateCallbacks","_verifyCallbacks","buildWorker","codeBuilderInstructions","jsmSuccess","_buildWorkerJsm","_buildWorkerStandard","_buildWorkerCheckPreconditions","type","_configureWorkerCommunication","e","TypeError","SyntaxError","error","concatenateCode","forEach","element","blob","requireJsmWorker","timeLabel","workerAvailable","time","haveJsmWorker","scopedReceiveWorkerMessage","event","_receiveWorkerMessage","onmessage","onerror","timeEnd","payload","data","workerRunnerName","cmd","msg","executeParallel","transferables","_verifyWorkerIsAvailable","_postMessage","ready","warn","input","ArrayBuffer","slice","length","concat","postMessage"],"mappings":"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","file":"../../../../../loaders/obj2/worker/main/WorkerExecutionSupport.js","sourcesContent":["define(function () {\n    'use strict';\n    const CodeBuilderInstructions = function (supportsStandardWorker, supportsJsmWorker, preferJsmWorker) {\n        this.supportsStandardWorker = supportsStandardWorker;\n        this.supportsJsmWorker = supportsJsmWorker;\n        this.preferJsmWorker = preferJsmWorker;\n        this.startCode = '';\n        this.codeFragments = [];\n        this.importStatements = [];\n        this.jsmWorkerUrl = null;\n        this.defaultGeometryType = 0;\n    };\n    CodeBuilderInstructions.prototype = {\n        constructor: CodeBuilderInstructions,\n        isSupportsStandardWorker: function () {\n            return this.supportsStandardWorker;\n        },\n        isSupportsJsmWorker: function () {\n            return this.supportsJsmWorker;\n        },\n        isPreferJsmWorker: function () {\n            return this.preferJsmWorker;\n        },\n        setJsmWorkerUrl: function (jsmWorkerUrl) {\n            if (jsmWorkerUrl !== undefined && jsmWorkerUrl !== null) {\n                this.jsmWorkerUrl = jsmWorkerUrl;\n            }\n        },\n        addStartCode: function (startCode) {\n            this.startCode = startCode;\n        },\n        addCodeFragment: function (code) {\n            this.codeFragments.push(code);\n        },\n        addLibraryImport: function (libraryPath) {\n            let libraryUrl = new URL(libraryPath, window.location.href).href;\n            let code = 'importScripts( \"' + libraryUrl + '\" );';\n            this.importStatements.push(code);\n        },\n        getImportStatements: function () {\n            return this.importStatements;\n        },\n        getCodeFragments: function () {\n            return this.codeFragments;\n        },\n        getStartCode: function () {\n            return this.startCode;\n        }\n    };\n    const WorkerExecutionSupport = function () {\n        if (window.Worker === undefined)\n            throw 'This browser does not support web workers!';\n        if (window.Blob === undefined)\n            throw 'This browser does not support Blob!';\n        if (typeof window.URL.createObjectURL !== 'function')\n            throw 'This browser does not support Object creation from URL!';\n        this._reset();\n    };\n    WorkerExecutionSupport.WORKER_SUPPORT_VERSION = '3.2.0';\n    console.info('Using WorkerSupport version: ' + WorkerExecutionSupport.WORKER_SUPPORT_VERSION);\n    WorkerExecutionSupport.prototype = {\n        constructor: WorkerExecutionSupport,\n        _reset: function () {\n            this.logging = {\n                enabled: false,\n                debug: false\n            };\n            let scope = this;\n            let scopeTerminate = function () {\n                scope._terminate();\n            };\n            this.worker = {\n                native: null,\n                jsmWorker: false,\n                logging: true,\n                workerRunner: {\n                    name: 'WorkerRunner',\n                    usesMeshDisassembler: false,\n                    defaultGeometryType: 0\n                },\n                terminateWorkerOnLoad: true,\n                forceWorkerDataCopy: false,\n                started: false,\n                queuedMessage: null,\n                callbacks: {\n                    onAssetAvailable: null,\n                    onLoad: null,\n                    terminate: scopeTerminate\n                }\n            };\n        },\n        setLogging: function (enabled, debug) {\n            this.logging.enabled = enabled === true;\n            this.logging.debug = debug === true;\n            this.worker.logging = enabled === true;\n            return this;\n        },\n        setForceWorkerDataCopy: function (forceWorkerDataCopy) {\n            this.worker.forceWorkerDataCopy = forceWorkerDataCopy === true;\n            return this;\n        },\n        setTerminateWorkerOnLoad: function (terminateWorkerOnLoad) {\n            this.worker.terminateWorkerOnLoad = terminateWorkerOnLoad === true;\n            if (this.worker.terminateWorkerOnLoad && this.isWorkerLoaded(this.worker.jsmWorker) && this.worker.queuedMessage === null && this.worker.started) {\n                if (this.logging.enabled) {\n                    console.info('Worker is terminated immediately as it is not running!');\n                }\n                this._terminate();\n            }\n            return this;\n        },\n        updateCallbacks: function (onAssetAvailable, onLoad) {\n            if (onAssetAvailable !== undefined && onAssetAvailable !== null) {\n                this.worker.callbacks.onAssetAvailable = onAssetAvailable;\n            }\n            if (onLoad !== undefined && onLoad !== null) {\n                this.worker.callbacks.onLoad = onLoad;\n            }\n            this._verifyCallbacks();\n        },\n        _verifyCallbacks: function () {\n            if (this.worker.callbacks.onAssetAvailable === undefined || this.worker.callbacks.onAssetAvailable === null) {\n                throw 'Unable to run as no \"onAssetAvailable\" callback is set.';\n            }\n        },\n        buildWorker: function (codeBuilderInstructions) {\n            let jsmSuccess = false;\n            if (codeBuilderInstructions.isSupportsJsmWorker() && codeBuilderInstructions.isPreferJsmWorker()) {\n                jsmSuccess = this._buildWorkerJsm(codeBuilderInstructions);\n            }\n            if (!jsmSuccess && codeBuilderInstructions.isSupportsStandardWorker()) {\n                this._buildWorkerStandard(codeBuilderInstructions);\n            }\n        },\n        _buildWorkerJsm: function (codeBuilderInstructions) {\n            let jsmSuccess = true;\n            let timeLabel = 'buildWorkerJsm';\n            let workerAvailable = this._buildWorkerCheckPreconditions(true, timeLabel);\n            if (!workerAvailable) {\n                try {\n                    let worker = new Worker(codeBuilderInstructions.jsmWorkerUrl.href, { type: 'module' });\n                    this._configureWorkerCommunication(worker, true, codeBuilderInstructions.defaultGeometryType, timeLabel);\n                } catch (e) {\n                    jsmSuccess = false;\n                    if (e instanceof TypeError || e instanceof SyntaxError) {\n                        console.error('Modules are not supported in workers.');\n                    }\n                }\n            }\n            return jsmSuccess;\n        },\n        _buildWorkerStandard: function (codeBuilderInstructions) {\n            let timeLabel = 'buildWorkerStandard';\n            let workerAvailable = this._buildWorkerCheckPreconditions(false, timeLabel);\n            if (!workerAvailable) {\n                let concatenateCode = '';\n                codeBuilderInstructions.getImportStatements().forEach(function (element) {\n                    concatenateCode += element + '\\n';\n                });\n                concatenateCode += '\\n';\n                codeBuilderInstructions.getCodeFragments().forEach(function (element) {\n                    concatenateCode += element + '\\n';\n                });\n                concatenateCode += '\\n';\n                concatenateCode += codeBuilderInstructions.getStartCode();\n                let blob = new Blob([concatenateCode], { type: 'application/javascript' });\n                let worker = new Worker(window.URL.createObjectURL(blob));\n                this._configureWorkerCommunication(worker, false, codeBuilderInstructions.defaultGeometryType, timeLabel);\n            }\n        },\n        _buildWorkerCheckPreconditions: function (requireJsmWorker, timeLabel) {\n            let workerAvailable = false;\n            if (this.isWorkerLoaded(requireJsmWorker)) {\n                workerAvailable = true;\n            } else {\n                if (this.logging.enabled) {\n                    console.info('WorkerExecutionSupport: Building ' + (requireJsmWorker ? 'jsm' : 'standard') + ' worker code...');\n                    console.time(timeLabel);\n                }\n            }\n            return workerAvailable;\n        },\n        _configureWorkerCommunication: function (worker, haveJsmWorker, defaultGeometryType, timeLabel) {\n            this.worker.native = worker;\n            this.worker.jsmWorker = haveJsmWorker;\n            let scope = this;\n            let scopedReceiveWorkerMessage = function (event) {\n                scope._receiveWorkerMessage(event);\n            };\n            this.worker.native.onmessage = scopedReceiveWorkerMessage;\n            this.worker.native.onerror = scopedReceiveWorkerMessage;\n            if (defaultGeometryType !== undefined && defaultGeometryType !== null) {\n                this.worker.workerRunner.defaultGeometryType = defaultGeometryType;\n            }\n            if (this.logging.enabled) {\n                console.timeEnd(timeLabel);\n            }\n        },\n        isWorkerLoaded: function (requireJsmWorker) {\n            return this.worker.native !== null && (requireJsmWorker && this.worker.jsmWorker || !requireJsmWorker && !this.worker.jsmWorker);\n        },\n        _receiveWorkerMessage: function (event) {\n            if (event.type === 'error') {\n                console.error(event);\n                return;\n            }\n            let payload = event.data;\n            let workerRunnerName = this.worker.workerRunner.name;\n            switch (payload.cmd) {\n            case 'assetAvailable':\n                this.worker.callbacks.onAssetAvailable(payload);\n                break;\n            case 'completeOverall':\n                this.worker.queuedMessage = null;\n                this.worker.started = false;\n                if (this.worker.callbacks.onLoad !== null) {\n                    this.worker.callbacks.onLoad(payload.msg);\n                }\n                if (this.worker.terminateWorkerOnLoad) {\n                    if (this.worker.logging.enabled) {\n                        console.info('WorkerSupport [' + workerRunnerName + ']: Run is complete. Terminating application on request!');\n                    }\n                    this.worker.callbacks.terminate();\n                }\n                break;\n            case 'error':\n                console.error('WorkerSupport [' + workerRunnerName + ']: Reported error: ' + payload.msg);\n                this.worker.queuedMessage = null;\n                this.worker.started = false;\n                if (this.worker.callbacks.onLoad !== null) {\n                    this.worker.callbacks.onLoad(payload.msg);\n                }\n                if (this.worker.terminateWorkerOnLoad) {\n                    if (this.worker.logging.enabled) {\n                        console.info('WorkerSupport [' + workerRunnerName + ']: Run reported error. Terminating application on request!');\n                    }\n                    this.worker.callbacks.terminate();\n                }\n                break;\n            default:\n                console.error('WorkerSupport [' + workerRunnerName + ']: Received unknown command: ' + payload.cmd);\n                break;\n            }\n        },\n        executeParallel: function (payload, transferables) {\n            payload.cmd = 'parse';\n            payload.usesMeshDisassembler = this.worker.workerRunner.usesMeshDisassembler;\n            payload.defaultGeometryType = this.worker.workerRunner.defaultGeometryType;\n            if (!this._verifyWorkerIsAvailable(payload, transferables))\n                return;\n            this._postMessage();\n        },\n        _verifyWorkerIsAvailable: function (payload, transferables) {\n            this._verifyCallbacks();\n            let ready = true;\n            if (this.worker.queuedMessage !== null) {\n                console.warn('Already processing message. Rejecting new run instruction');\n                ready = false;\n            } else {\n                this.worker.queuedMessage = {\n                    payload: payload,\n                    transferables: transferables === undefined || transferables === null ? [] : transferables\n                };\n                this.worker.started = true;\n            }\n            return ready;\n        },\n        _postMessage: function () {\n            if (this.worker.queuedMessage !== null) {\n                if (this.worker.queuedMessage.payload.data.input instanceof ArrayBuffer) {\n                    let transferables = [];\n                    if (this.worker.forceWorkerDataCopy) {\n                        transferables.push(this.worker.queuedMessage.payload.data.input.slice(0));\n                    } else {\n                        transferables.push(this.worker.queuedMessage.payload.data.input);\n                    }\n                    if (this.worker.queuedMessage.transferables.length > 0) {\n                        transferables = transferables.concat(this.worker.queuedMessage.transferables);\n                    }\n                    this.worker.native.postMessage(this.worker.queuedMessage.payload, transferables);\n                } else {\n                    this.worker.native.postMessage(this.worker.queuedMessage.payload);\n                }\n            }\n        },\n        _terminate: function () {\n            this.worker.native.terminate();\n            this._reset();\n        }\n    };\n    return {\n        CodeBuilderInstructions,\n        WorkerExecutionSupport\n    };\n});"]}
{"version":3,"sources":["loaders/PDBLoader.js"],"names":["define","THREE","threex","PDBLoader","manager","Loader","call","this","prototype","Object","assign","create","constructor","load","url","onLoad","onProgress","onError","scope","loader","FileLoader","setPath","path","text","parse","trim","replace","capitalize","charAt","toUpperCase","substr","toLowerCase","parseBond","start","length","s","e","eatom","parseInt","lines","i","h","satom","Math","min","max","undefined","bhash","bonds","push","x","y","z","index","CPK","he","li","be","b","c","n","o","f","ne","na","mg","al","si","p","cl","ar","k","ca","sc","ti","v","cr","mn","fe","co","ni","cu","zn","ga","ge","as","se","br","kr","rb","sr","zr","nb","mo","tc","ru","rh","pd","ag","cd","in","sn","sb","te","xe","cs","ba","la","ce","pr","nd","pm","sm","eu","gd","tb","dy","ho","er","tm","yb","lu","hf","ta","w","re","os","ir","pt","au","hg","tl","pb","bi","po","at","rn","fr","ra","ac","th","pa","u","np","pu","am","cm","bk","cf","es","fm","md","no","lr","rf","db","sg","bh","hs","mt","ds","rg","cn","uut","uuq","uup","uuh","uus","uuo","atoms","histogram","split","l","parseFloat","build","geometryAtoms","BufferGeometry","geometryBonds","json","verticesAtoms","colorsAtoms","verticesBonds","atom","r","g","bond","end","setAttribute","Float32BufferAttribute","buildGeometry","loaders"],"mappings":";;;;;;;AAAAA,QACI,kBACA,aACD,SACCC,EACAC,GAEA,aACA,IAAIC,EAAY,SAAUC,GACtBH,EAAMI,OAAOC,KAAKC,KAAMH,IAusB5B,OArsBAD,EAAUK,UAAYC,OAAOC,OAAOD,OAAOE,OAAOV,EAAMI,OAAOG,YAC3DI,YAAaT,EACbU,KAAM,SAAUC,EAAKC,EAAQC,EAAYC,GACrC,IAAIC,EAAQX,KACRY,EAAS,IAAIlB,EAAMmB,WAAWF,EAAMd,SACxCe,EAAOE,QAAQH,EAAMI,MACrBH,EAAON,KAAKC,EAAK,SAAUS,GACvBR,EAAOG,EAAMM,MAAMD,KACpBP,EAAYC,IAEnBO,MAAO,SAAUD,GACb,SAASE,EAAKF,GACV,OAAOA,EAAKG,QAAQ,SAAU,IAAIA,QAAQ,SAAU,IAExD,SAASC,EAAWJ,GAChB,OAAOA,EAAKK,OAAO,GAAGC,cAAgBN,EAAKO,OAAO,GAAGC,cAKzD,SAASC,EAAUC,EAAOC,GACtB,IAJUC,EAAGC,EAITC,EAAQC,SAASC,EAAMC,GAAGV,OAAOG,EAAOC,IAC5C,GAAIG,EAAO,CACP,IAAII,GANEN,EAMOO,EANJN,EAMWC,EALjB,IAAMM,KAAKC,IAAIT,EAAGC,GAAK,IAAMO,KAAKE,IAAIV,EAAGC,SAM3BU,IAAbC,EAAMN,KACNO,EAAMC,MACFP,EAAQ,EACRL,EAAQ,EACR,IAEJU,EAAMN,GAAKO,EAAMd,OAAS,IAqoBtC,IAtlBA,IAolBIgB,EAAGC,EAAGC,EAAGC,EAAOjB,EAplBhBkB,GACAb,GACI,IACA,IACA,KAEJc,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,GAEJC,GACI,IACA,IACA,KAEJC,GACI,IACA,IACA,KAEJC,GACI,GACA,GACA,KAEJC,GACI,IACA,GACA,IAEJC,GACI,IACA,IACA,IAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,IACA,GAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,GACI,IACA,IACA,GAEJjC,GACI,IACA,IACA,IAEJkC,IACI,GACA,IACA,IAEJC,IACI,IACA,IACA,KAEJC,GACI,IACA,GACA,KAEJC,IACI,GACA,IACA,GAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,GACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,IAEJC,IACI,IACA,IACA,KAEJC,IACI,GACA,IACA,IAEJC,IACI,IACA,IACA,IAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,GAEJC,IACI,IACA,GACA,IAEJC,IACI,GACA,IACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,EACA,IACA,GAEJvC,GACI,IACA,IACA,KAEJwC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,EACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,IACA,GAEJ/D,GACI,IACA,EACA,KAEJgE,IACI,GACA,IACA,KAEJC,IACI,GACA,GACA,KAEJC,IACI,EACA,IACA,GAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,EACA,IACA,KAEJC,IACI,EACA,IACA,KAEJC,IACI,EACA,IACA,IAEJC,IACI,EACA,IACA,IAEJC,IACI,EACA,IACA,IAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,GACI,GACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,GACA,KAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,IACA,IAEJC,IACI,IACA,IACA,KAEJC,IACI,IACA,GACA,IAEJC,IACI,GACA,GACA,IAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,GACA,GAEJC,IACI,IACA,GACA,IAEJC,IACI,GACA,IACA,KAEJC,IACI,GACA,EACA,KAEJC,IACI,EACA,IACA,GAEJC,IACI,IACA,IACA,KAEJC,IACI,EACA,IACA,KAEJC,IACI,EACA,IACA,KAEJC,GACI,EACA,IACA,KAEJC,IACI,EACA,IACA,KAEJC,IACI,EACA,IACA,KAEJC,IACI,GACA,GACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,GACA,KAEJC,IACI,IACA,EACA,KAEJC,IACI,IACA,EACA,IAEJC,IACI,IACA,EACA,IAEJC,IACI,IACA,EACA,IAEJC,IACI,IACA,EACA,IAEJC,IACI,IACA,EACA,IAEJC,IACI,IACA,EACA,IAEJC,IACI,IACA,EACA,IAEJC,IACI,IACA,EACA,IAEJC,IACI,IACA,EACA,IAEJC,KACI,IACA,EACA,IAEJC,KACI,IACA,EACA,IAEJC,KACI,IACA,EACA,IAEJC,KACI,IACA,EACA,IAEJC,KACI,IACA,EACA,IAEJC,KACI,IACA,EACA,KAGJC,KACAzH,KACA0H,KACA3H,KAEAR,EAAQhB,EAAKoJ,MAAM,MACdnI,EAAI,EAAGoI,EAAIrI,EAAML,OAAQM,EAAIoI,EAAGpI,IACrC,GAA8B,SAA1BD,EAAMC,GAAGV,OAAO,EAAG,IAA2C,WAA1BS,EAAMC,GAAGV,OAAO,EAAG,GACvDoB,EAAI2H,WAAWtI,EAAMC,GAAGV,OAAO,GAAI,IACnCqB,EAAI0H,WAAWtI,EAAMC,GAAGV,OAAO,GAAI,IACnCsB,EAAIyH,WAAWtI,EAAMC,GAAGV,OAAO,GAAI,IACnCuB,EAAQf,SAASC,EAAMC,GAAGV,OAAO,EAAG,IAAM,EAEhC,MADVM,EAAIX,EAAKc,EAAMC,GAAGV,OAAO,GAAI,IAAIC,iBAE7BK,EAAIX,EAAKc,EAAMC,GAAGV,OAAO,GAAI,IAAIC,eAErC0I,EAAMpH,IACFH,EACAC,EACAC,EACAE,EAAIlB,GACJT,EAAWS,SAEMU,IAAjB4H,EAAUtI,GACVsI,EAAUtI,GAAK,EAEfsI,EAAUtI,IAAM,OAEjB,GAA8B,WAA1BG,EAAMC,GAAGV,OAAO,EAAG,GAAiB,CAC3C,IAAIY,EAAQJ,SAASC,EAAMC,GAAGV,OAAO,EAAG,IACxCE,EAAU,GAAI,GACdA,EAAU,GAAI,GACdA,EAAU,GAAI,GACdA,EAAU,GAAI,GAGtB,OA9pBA,WACI,IAUIQ,EAAGoI,EAVHE,GACAC,cAAe,IAAI9K,EAAM+K,eACzBC,cAAe,IAAIhL,EAAM+K,eACzBE,MACIT,MAAOA,EACPzH,MAAOA,IAGX+H,EAAgBD,EAAMC,cACtBE,EAAgBH,EAAMG,cAEtBE,KACAC,KACAC,KACJ,IAAK7I,EAAI,EAAGoI,EAAIH,EAAMvI,OAAQM,EAAIoI,EAAGpI,IAAK,CACtC,IAAI8I,EAAOb,EAAMjI,GACbU,EAAIoI,EAAK,GACTnI,EAAImI,EAAK,GACTlI,EAAIkI,EAAK,GACbH,EAAclI,KAAKC,EAAGC,EAAGC,GACzB,IAAImI,EAAID,EAAK,GAAG,GAAK,IACjBE,EAAIF,EAAK,GAAG,GAAK,IACjB5H,EAAI4H,EAAK,GAAG,GAAK,IACrBF,EAAYnI,KAAKsI,EAAGC,EAAG9H,GAE3B,IAAKlB,EAAI,EAAGoI,EAAI5H,EAAMd,OAAQM,EAAIoI,EAAGpI,IAAK,CACtC,IAAIiJ,EAAOzI,EAAMR,GACbP,EAAQwJ,EAAK,GACbC,EAAMD,EAAK,GACfJ,EAAcpI,KAAKkI,EAAsB,EAARlJ,EAAY,IAC7CoJ,EAAcpI,KAAKkI,EAAsB,EAARlJ,EAAY,IAC7CoJ,EAAcpI,KAAKkI,EAAsB,EAARlJ,EAAY,IAC7CoJ,EAAcpI,KAAKkI,EAAoB,EAANO,EAAU,IAC3CL,EAAcpI,KAAKkI,EAAoB,EAANO,EAAU,IAC3CL,EAAcpI,KAAKkI,EAAoB,EAANO,EAAU,IAK/C,OAHAX,EAAcY,aAAa,WAAY,IAAI1L,EAAM2L,uBAAuBT,EAAe,IACvFJ,EAAcY,aAAa,QAAS,IAAI1L,EAAM2L,uBAAuBR,EAAa,IAClFH,EAAcU,aAAa,WAAY,IAAI1L,EAAM2L,uBAAuBP,EAAe,IAChFP,EAsnBJe,MAIR3L,EAAO4L,QAAQ3L,UAAYA","file":"../../loaders/PDBLoader.js","sourcesContent":["define([\r\n    \"skylark-threejs\",\r\n    \"../threex\"\r\n], function (\r\n    THREE,\r\n    threex\r\n) {\r\n    'use strict';\r\n    var PDBLoader = function (manager) {\r\n        THREE.Loader.call(this, manager);\r\n    };\r\n    PDBLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {\r\n        constructor: PDBLoader,\r\n        load: function (url, onLoad, onProgress, onError) {\r\n            var scope = this;\r\n            var loader = new THREE.FileLoader(scope.manager);\r\n            loader.setPath(scope.path);\r\n            loader.load(url, function (text) {\r\n                onLoad(scope.parse(text));\r\n            }, onProgress, onError);\r\n        },\r\n        parse: function (text) {\r\n            function trim(text) {\r\n                return text.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\r\n            }\r\n            function capitalize(text) {\r\n                return text.charAt(0).toUpperCase() + text.substr(1).toLowerCase();\r\n            }\r\n            function hash(s, e) {\r\n                return 's' + Math.min(s, e) + 'e' + Math.max(s, e);\r\n            }\r\n            function parseBond(start, length) {\r\n                var eatom = parseInt(lines[i].substr(start, length));\r\n                if (eatom) {\r\n                    var h = hash(satom, eatom);\r\n                    if (bhash[h] === undefined) {\r\n                        bonds.push([\r\n                            satom - 1,\r\n                            eatom - 1,\r\n                            1\r\n                        ]);\r\n                        bhash[h] = bonds.length - 1;\r\n                    } else {\r\n                    }\r\n                }\r\n            }\r\n            function buildGeometry() {\r\n                var build = {\r\n                    geometryAtoms: new THREE.BufferGeometry(),\r\n                    geometryBonds: new THREE.BufferGeometry(),\r\n                    json: {\r\n                        atoms: atoms,\r\n                        bonds: bonds\r\n                    }\r\n                };\r\n                var geometryAtoms = build.geometryAtoms;\r\n                var geometryBonds = build.geometryBonds;\r\n                var i, l;\r\n                var verticesAtoms = [];\r\n                var colorsAtoms = [];\r\n                var verticesBonds = [];\r\n                for (i = 0, l = atoms.length; i < l; i++) {\r\n                    var atom = atoms[i];\r\n                    var x = atom[0];\r\n                    var y = atom[1];\r\n                    var z = atom[2];\r\n                    verticesAtoms.push(x, y, z);\r\n                    var r = atom[3][0] / 255;\r\n                    var g = atom[3][1] / 255;\r\n                    var b = atom[3][2] / 255;\r\n                    colorsAtoms.push(r, g, b);\r\n                }\r\n                for (i = 0, l = bonds.length; i < l; i++) {\r\n                    var bond = bonds[i];\r\n                    var start = bond[0];\r\n                    var end = bond[1];\r\n                    verticesBonds.push(verticesAtoms[start * 3 + 0]);\r\n                    verticesBonds.push(verticesAtoms[start * 3 + 1]);\r\n                    verticesBonds.push(verticesAtoms[start * 3 + 2]);\r\n                    verticesBonds.push(verticesAtoms[end * 3 + 0]);\r\n                    verticesBonds.push(verticesAtoms[end * 3 + 1]);\r\n                    verticesBonds.push(verticesAtoms[end * 3 + 2]);\r\n                }\r\n                geometryAtoms.setAttribute('position', new THREE.Float32BufferAttribute(verticesAtoms, 3));\r\n                geometryAtoms.setAttribute('color', new THREE.Float32BufferAttribute(colorsAtoms, 3));\r\n                geometryBonds.setAttribute('position', new THREE.Float32BufferAttribute(verticesBonds, 3));\r\n                return build;\r\n            }\r\n            var CPK = {\r\n                h: [\r\n                    255,\r\n                    255,\r\n                    255\r\n                ],\r\n                he: [\r\n                    217,\r\n                    255,\r\n                    255\r\n                ],\r\n                li: [\r\n                    204,\r\n                    128,\r\n                    255\r\n                ],\r\n                be: [\r\n                    194,\r\n                    255,\r\n                    0\r\n                ],\r\n                b: [\r\n                    255,\r\n                    181,\r\n                    181\r\n                ],\r\n                c: [\r\n                    144,\r\n                    144,\r\n                    144\r\n                ],\r\n                n: [\r\n                    48,\r\n                    80,\r\n                    248\r\n                ],\r\n                o: [\r\n                    255,\r\n                    13,\r\n                    13\r\n                ],\r\n                f: [\r\n                    144,\r\n                    224,\r\n                    80\r\n                ],\r\n                ne: [\r\n                    179,\r\n                    227,\r\n                    245\r\n                ],\r\n                na: [\r\n                    171,\r\n                    92,\r\n                    242\r\n                ],\r\n                mg: [\r\n                    138,\r\n                    255,\r\n                    0\r\n                ],\r\n                al: [\r\n                    191,\r\n                    166,\r\n                    166\r\n                ],\r\n                si: [\r\n                    240,\r\n                    200,\r\n                    160\r\n                ],\r\n                p: [\r\n                    255,\r\n                    128,\r\n                    0\r\n                ],\r\n                s: [\r\n                    255,\r\n                    255,\r\n                    48\r\n                ],\r\n                cl: [\r\n                    31,\r\n                    240,\r\n                    31\r\n                ],\r\n                ar: [\r\n                    128,\r\n                    209,\r\n                    227\r\n                ],\r\n                k: [\r\n                    143,\r\n                    64,\r\n                    212\r\n                ],\r\n                ca: [\r\n                    61,\r\n                    255,\r\n                    0\r\n                ],\r\n                sc: [\r\n                    230,\r\n                    230,\r\n                    230\r\n                ],\r\n                ti: [\r\n                    191,\r\n                    194,\r\n                    199\r\n                ],\r\n                v: [\r\n                    166,\r\n                    166,\r\n                    171\r\n                ],\r\n                cr: [\r\n                    138,\r\n                    153,\r\n                    199\r\n                ],\r\n                mn: [\r\n                    156,\r\n                    122,\r\n                    199\r\n                ],\r\n                fe: [\r\n                    224,\r\n                    102,\r\n                    51\r\n                ],\r\n                co: [\r\n                    240,\r\n                    144,\r\n                    160\r\n                ],\r\n                ni: [\r\n                    80,\r\n                    208,\r\n                    80\r\n                ],\r\n                cu: [\r\n                    200,\r\n                    128,\r\n                    51\r\n                ],\r\n                zn: [\r\n                    125,\r\n                    128,\r\n                    176\r\n                ],\r\n                ga: [\r\n                    194,\r\n                    143,\r\n                    143\r\n                ],\r\n                ge: [\r\n                    102,\r\n                    143,\r\n                    143\r\n                ],\r\n                as: [\r\n                    189,\r\n                    128,\r\n                    227\r\n                ],\r\n                se: [\r\n                    255,\r\n                    161,\r\n                    0\r\n                ],\r\n                br: [\r\n                    166,\r\n                    41,\r\n                    41\r\n                ],\r\n                kr: [\r\n                    92,\r\n                    184,\r\n                    209\r\n                ],\r\n                rb: [\r\n                    112,\r\n                    46,\r\n                    176\r\n                ],\r\n                sr: [\r\n                    0,\r\n                    255,\r\n                    0\r\n                ],\r\n                y: [\r\n                    148,\r\n                    255,\r\n                    255\r\n                ],\r\n                zr: [\r\n                    148,\r\n                    224,\r\n                    224\r\n                ],\r\n                nb: [\r\n                    115,\r\n                    194,\r\n                    201\r\n                ],\r\n                mo: [\r\n                    84,\r\n                    181,\r\n                    181\r\n                ],\r\n                tc: [\r\n                    59,\r\n                    158,\r\n                    158\r\n                ],\r\n                ru: [\r\n                    36,\r\n                    143,\r\n                    143\r\n                ],\r\n                rh: [\r\n                    10,\r\n                    125,\r\n                    140\r\n                ],\r\n                pd: [\r\n                    0,\r\n                    105,\r\n                    133\r\n                ],\r\n                ag: [\r\n                    192,\r\n                    192,\r\n                    192\r\n                ],\r\n                cd: [\r\n                    255,\r\n                    217,\r\n                    143\r\n                ],\r\n                in: [\r\n                    166,\r\n                    117,\r\n                    115\r\n                ],\r\n                sn: [\r\n                    102,\r\n                    128,\r\n                    128\r\n                ],\r\n                sb: [\r\n                    158,\r\n                    99,\r\n                    181\r\n                ],\r\n                te: [\r\n                    212,\r\n                    122,\r\n                    0\r\n                ],\r\n                i: [\r\n                    148,\r\n                    0,\r\n                    148\r\n                ],\r\n                xe: [\r\n                    66,\r\n                    158,\r\n                    176\r\n                ],\r\n                cs: [\r\n                    87,\r\n                    23,\r\n                    143\r\n                ],\r\n                ba: [\r\n                    0,\r\n                    201,\r\n                    0\r\n                ],\r\n                la: [\r\n                    112,\r\n                    212,\r\n                    255\r\n                ],\r\n                ce: [\r\n                    255,\r\n                    255,\r\n                    199\r\n                ],\r\n                pr: [\r\n                    217,\r\n                    255,\r\n                    199\r\n                ],\r\n                nd: [\r\n                    199,\r\n                    255,\r\n                    199\r\n                ],\r\n                pm: [\r\n                    163,\r\n                    255,\r\n                    199\r\n                ],\r\n                sm: [\r\n                    143,\r\n                    255,\r\n                    199\r\n                ],\r\n                eu: [\r\n                    97,\r\n                    255,\r\n                    199\r\n                ],\r\n                gd: [\r\n                    69,\r\n                    255,\r\n                    199\r\n                ],\r\n                tb: [\r\n                    48,\r\n                    255,\r\n                    199\r\n                ],\r\n                dy: [\r\n                    31,\r\n                    255,\r\n                    199\r\n                ],\r\n                ho: [\r\n                    0,\r\n                    255,\r\n                    156\r\n                ],\r\n                er: [\r\n                    0,\r\n                    230,\r\n                    117\r\n                ],\r\n                tm: [\r\n                    0,\r\n                    212,\r\n                    82\r\n                ],\r\n                yb: [\r\n                    0,\r\n                    191,\r\n                    56\r\n                ],\r\n                lu: [\r\n                    0,\r\n                    171,\r\n                    36\r\n                ],\r\n                hf: [\r\n                    77,\r\n                    194,\r\n                    255\r\n                ],\r\n                ta: [\r\n                    77,\r\n                    166,\r\n                    255\r\n                ],\r\n                w: [\r\n                    33,\r\n                    148,\r\n                    214\r\n                ],\r\n                re: [\r\n                    38,\r\n                    125,\r\n                    171\r\n                ],\r\n                os: [\r\n                    38,\r\n                    102,\r\n                    150\r\n                ],\r\n                ir: [\r\n                    23,\r\n                    84,\r\n                    135\r\n                ],\r\n                pt: [\r\n                    208,\r\n                    208,\r\n                    224\r\n                ],\r\n                au: [\r\n                    255,\r\n                    209,\r\n                    35\r\n                ],\r\n                hg: [\r\n                    184,\r\n                    184,\r\n                    208\r\n                ],\r\n                tl: [\r\n                    166,\r\n                    84,\r\n                    77\r\n                ],\r\n                pb: [\r\n                    87,\r\n                    89,\r\n                    97\r\n                ],\r\n                bi: [\r\n                    158,\r\n                    79,\r\n                    181\r\n                ],\r\n                po: [\r\n                    171,\r\n                    92,\r\n                    0\r\n                ],\r\n                at: [\r\n                    117,\r\n                    79,\r\n                    69\r\n                ],\r\n                rn: [\r\n                    66,\r\n                    130,\r\n                    150\r\n                ],\r\n                fr: [\r\n                    66,\r\n                    0,\r\n                    102\r\n                ],\r\n                ra: [\r\n                    0,\r\n                    125,\r\n                    0\r\n                ],\r\n                ac: [\r\n                    112,\r\n                    171,\r\n                    250\r\n                ],\r\n                th: [\r\n                    0,\r\n                    186,\r\n                    255\r\n                ],\r\n                pa: [\r\n                    0,\r\n                    161,\r\n                    255\r\n                ],\r\n                u: [\r\n                    0,\r\n                    143,\r\n                    255\r\n                ],\r\n                np: [\r\n                    0,\r\n                    128,\r\n                    255\r\n                ],\r\n                pu: [\r\n                    0,\r\n                    107,\r\n                    255\r\n                ],\r\n                am: [\r\n                    84,\r\n                    92,\r\n                    242\r\n                ],\r\n                cm: [\r\n                    120,\r\n                    92,\r\n                    227\r\n                ],\r\n                bk: [\r\n                    138,\r\n                    79,\r\n                    227\r\n                ],\r\n                cf: [\r\n                    161,\r\n                    54,\r\n                    212\r\n                ],\r\n                es: [\r\n                    179,\r\n                    31,\r\n                    212\r\n                ],\r\n                fm: [\r\n                    179,\r\n                    31,\r\n                    186\r\n                ],\r\n                md: [\r\n                    179,\r\n                    13,\r\n                    166\r\n                ],\r\n                no: [\r\n                    189,\r\n                    13,\r\n                    135\r\n                ],\r\n                lr: [\r\n                    199,\r\n                    0,\r\n                    102\r\n                ],\r\n                rf: [\r\n                    204,\r\n                    0,\r\n                    89\r\n                ],\r\n                db: [\r\n                    209,\r\n                    0,\r\n                    79\r\n                ],\r\n                sg: [\r\n                    217,\r\n                    0,\r\n                    69\r\n                ],\r\n                bh: [\r\n                    224,\r\n                    0,\r\n                    56\r\n                ],\r\n                hs: [\r\n                    230,\r\n                    0,\r\n                    46\r\n                ],\r\n                mt: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ],\r\n                ds: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ],\r\n                rg: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ],\r\n                cn: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ],\r\n                uut: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ],\r\n                uuq: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ],\r\n                uup: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ],\r\n                uuh: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ],\r\n                uus: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ],\r\n                uuo: [\r\n                    235,\r\n                    0,\r\n                    38\r\n                ]\r\n            };\r\n            var atoms = [];\r\n            var bonds = [];\r\n            var histogram = {};\r\n            var bhash = {};\r\n            var x, y, z, index, e;\r\n            var lines = text.split('\\n');\r\n            for (var i = 0, l = lines.length; i < l; i++) {\r\n                if (lines[i].substr(0, 4) === 'ATOM' || lines[i].substr(0, 6) === 'HETATM') {\r\n                    x = parseFloat(lines[i].substr(30, 7));\r\n                    y = parseFloat(lines[i].substr(38, 7));\r\n                    z = parseFloat(lines[i].substr(46, 7));\r\n                    index = parseInt(lines[i].substr(6, 5)) - 1;\r\n                    e = trim(lines[i].substr(76, 2)).toLowerCase();\r\n                    if (e === '') {\r\n                        e = trim(lines[i].substr(12, 2)).toLowerCase();\r\n                    }\r\n                    atoms[index] = [\r\n                        x,\r\n                        y,\r\n                        z,\r\n                        CPK[e],\r\n                        capitalize(e)\r\n                    ];\r\n                    if (histogram[e] === undefined) {\r\n                        histogram[e] = 1;\r\n                    } else {\r\n                        histogram[e] += 1;\r\n                    }\r\n                } else if (lines[i].substr(0, 6) === 'CONECT') {\r\n                    var satom = parseInt(lines[i].substr(6, 5));\r\n                    parseBond(11, 5);\r\n                    parseBond(16, 5);\r\n                    parseBond(21, 5);\r\n                    parseBond(26, 5);\r\n                }\r\n            }\r\n            return buildGeometry();\r\n        }\r\n    });\r\n\r\n    return threex.loaders.PDBLoader = PDBLoader;\r\n});"]}
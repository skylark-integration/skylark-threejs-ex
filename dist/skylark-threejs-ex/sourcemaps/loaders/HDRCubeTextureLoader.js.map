{"version":3,"sources":["loaders/HDRCubeTextureLoader.js"],"names":["define","THREE","RGBELoader","HDRCubeTextureLoader","manager","Loader","call","this","hdrLoader","type","UnsignedByteType","prototype","Object","assign","create","constructor","load","urls","onLoad","onProgress","onError","Array","isArray","console","warn","setDataType","arguments","texture","CubeTexture","encoding","RGBEEncoding","format","RGBAFormat","minFilter","NearestFilter","magFilter","generateMipmaps","FloatType","HalfFloatType","LinearEncoding","RGBFormat","LinearFilter","scope","loaded","loadHDRData","i","FileLoader","setPath","path","setResponseType","buffer","texData","parse","undefined","data","dataTexture","DataTexture","width","height","images","needsUpdate","length","value"],"mappings":";;;;;;;AAAAA,QACI,kBACA,gBACD,SACCC,EACAC,GAEA,aACA,IAAIC,EAAuB,SAAUC,GACjCH,EAAMI,OAAOC,KAAKC,KAAMH,GACxBG,KAAKC,UAAY,IAAIN,EACrBK,KAAKE,KAAOR,EAAMS,kBA0EtB,OAxEAP,EAAqBQ,UAAYC,OAAOC,OAAOD,OAAOE,OAAOb,EAAMI,OAAOM,YACtEI,YAAaZ,EACba,KAAM,SAAUC,EAAMC,EAAQC,EAAYC,GACjCC,MAAMC,QAAQL,KACfM,QAAQC,KAAK,iFACbjB,KAAKkB,YAAYR,GACjBA,EAAOC,EACPA,EAASC,EACTA,EAAaC,EACbA,EAAUM,UAAU,IAExB,IAAIC,EAAU,IAAI1B,EAAM2B,YAExB,OADAD,EAAQlB,KAAOF,KAAKE,KACZkB,EAAQlB,MAChB,KAAKR,EAAMS,iBACPiB,EAAQE,SAAW5B,EAAM6B,aACzBH,EAAQI,OAAS9B,EAAM+B,WACvBL,EAAQM,UAAYhC,EAAMiC,cAC1BP,EAAQQ,UAAYlC,EAAMiC,cAC1BP,EAAQS,iBAAkB,EAC1B,MACJ,KAAKnC,EAAMoC,UAOX,KAAKpC,EAAMqC,cACPX,EAAQE,SAAW5B,EAAMsC,eACzBZ,EAAQI,OAAS9B,EAAMuC,UACvBb,EAAQM,UAAYhC,EAAMwC,aAC1Bd,EAAQQ,UAAYlC,EAAMwC,aAC1Bd,EAAQS,iBAAkB,EAG9B,IAAIM,EAAQnC,KACRoC,EAAS,EACb,SAASC,EAAYC,EAAG3B,EAAQC,EAAYC,GACxC,IAAInB,EAAM6C,WAAWJ,EAAMtC,SAAS2C,QAAQL,EAAMM,MAAMC,gBAAgB,eAAejC,KAAKC,EAAK4B,GAAI,SAAUK,GAC3GP,IACA,IAAIQ,EAAUT,EAAMlC,UAAU4C,MAAMF,GACpC,GAAKC,EAAL,CAEA,QAAqBE,IAAjBF,EAAQG,KAAoB,CAC5B,IAAIC,EAAc,IAAItD,EAAMuD,YAAYL,EAAQG,KAAMH,EAAQM,MAAON,EAAQO,QAC7EH,EAAY9C,KAAOkB,EAAQlB,KAC3B8C,EAAY1B,SAAWF,EAAQE,SAC/B0B,EAAYxB,OAASJ,EAAQI,OAC7BwB,EAAYtB,UAAYN,EAAQM,UAChCsB,EAAYpB,UAAYR,EAAQQ,UAChCoB,EAAYnB,gBAAkBT,EAAQS,gBACtCT,EAAQgC,OAAOd,GAAKU,EAET,IAAXZ,IACAhB,EAAQiC,aAAc,EAClB1C,GACAA,EAAOS,MAEhBR,EAAYC,GAEnB,IAAK,IAAIyB,EAAI,EAAGA,EAAI5B,EAAK4C,OAAQhB,IAC7BD,EAAYC,EAAG3B,EAAQC,EAAYC,GAEvC,OAAOO,GAEXF,YAAa,SAAUqC,GAGnB,OAFAvD,KAAKE,KAAOqD,EACZvD,KAAKC,UAAUiB,YAAYqC,GACpBvD,QAGRJ","file":"../../loaders/HDRCubeTextureLoader.js","sourcesContent":["define([\n    \"skylark-threejs\",\n    './RGBELoader'\n], function (\n    THREE, \n    RGBELoader\n) {\n    'use strict';\n    var HDRCubeTextureLoader = function (manager) {\n        THREE.Loader.call(this, manager);\n        this.hdrLoader = new RGBELoader();\n        this.type = THREE.UnsignedByteType;\n    };\n    HDRCubeTextureLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {\n        constructor: HDRCubeTextureLoader,\n        load: function (urls, onLoad, onProgress, onError) {\n            if (!Array.isArray(urls)) {\n                console.warn('THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead.');\n                this.setDataType(urls);\n                urls = onLoad;\n                onLoad = onProgress;\n                onProgress = onError;\n                onError = arguments[4];\n            }\n            var texture = new THREE.CubeTexture();\n            texture.type = this.type;\n            switch (texture.type) {\n            case THREE.UnsignedByteType:\n                texture.encoding = THREE.RGBEEncoding;\n                texture.format = THREE.RGBAFormat;\n                texture.minFilter = THREE.NearestFilter;\n                texture.magFilter = THREE.NearestFilter;\n                texture.generateMipmaps = false;\n                break;\n            case THREE.FloatType:\n                texture.encoding = THREE.LinearEncoding;\n                texture.format = THREE.RGBFormat;\n                texture.minFilter = THREE.LinearFilter;\n                texture.magFilter = THREE.LinearFilter;\n                texture.generateMipmaps = false;\n                break;\n            case THREE.HalfFloatType:\n                texture.encoding = THREE.LinearEncoding;\n                texture.format = THREE.RGBFormat;\n                texture.minFilter = THREE.LinearFilter;\n                texture.magFilter = THREE.LinearFilter;\n                texture.generateMipmaps = false;\n                break;\n            }\n            var scope = this;\n            var loaded = 0;\n            function loadHDRData(i, onLoad, onProgress, onError) {\n                new THREE.FileLoader(scope.manager).setPath(scope.path).setResponseType('arraybuffer').load(urls[i], function (buffer) {\n                    loaded++;\n                    var texData = scope.hdrLoader.parse(buffer);\n                    if (!texData)\n                        return;\n                    if (texData.data !== undefined) {\n                        var dataTexture = new THREE.DataTexture(texData.data, texData.width, texData.height);\n                        dataTexture.type = texture.type;\n                        dataTexture.encoding = texture.encoding;\n                        dataTexture.format = texture.format;\n                        dataTexture.minFilter = texture.minFilter;\n                        dataTexture.magFilter = texture.magFilter;\n                        dataTexture.generateMipmaps = texture.generateMipmaps;\n                        texture.images[i] = dataTexture;\n                    }\n                    if (loaded === 6) {\n                        texture.needsUpdate = true;\n                        if (onLoad)\n                            onLoad(texture);\n                    }\n                }, onProgress, onError);\n            }\n            for (var i = 0; i < urls.length; i++) {\n                loadHDRData(i, onLoad, onProgress, onError);\n            }\n            return texture;\n        },\n        setDataType: function (value) {\n            this.type = value;\n            this.hdrLoader.setDataType(value);\n            return this;\n        }\n    });\n    return HDRCubeTextureLoader;\n});"]}
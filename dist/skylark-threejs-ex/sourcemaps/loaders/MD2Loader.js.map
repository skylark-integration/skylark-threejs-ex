{"version":3,"sources":["loaders/MD2Loader.js"],"names":["define","THREE","normalData","MD2Loader","manager","Loader","call","this","prototype","Object","assign","create","constructor","load","url","onLoad","onProgress","onError","scope","loader","FileLoader","setPath","path","setResponseType","buffer","parse","data","DataView","header","headerNames","i","length","getInt32","ident","version","offset_end","byteLength","geometry","BufferGeometry","uvsTemp","offset","offset_st","l","num_st","u","getInt16","v","push","skinwidth","skinheight","offset_tris","vertexIndices","uvIndices","num_tris","getUint16","translation","Vector3","scale","string","frames","offset_frames","num_frames","set","getFloat32","j","character","getUint8","frame","name","String","fromCharCode","apply","vertices","normals","num_vertices","x","y","z","n","positions","uvs","verticesTemp","normalsTemp","stride","nx","ny","nz","setAttribute","Float32BufferAttribute","morphPositions","morphNormals","attributeName","jl","positionAttribute","normalAttribute","morphAttributes","position","normal","morphTargetsRelative","animations","AnimationClip","CreateClipsFromMorphTargetSequences","console","error"],"mappings":"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","file":"../../loaders/MD2Loader.js","sourcesContent":["define([\n\t\"skylark-threejs\"\n],function(THREE){\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\n\tTHREE.MD2Loader = function ( manager ) {\n\n\t\tTHREE.Loader.call( this, manager );\n\n\t};\n\n\tTHREE.MD2Loader.prototype = Object.assign( Object.create( THREE.Loader.prototype ), {\n\n\t\tconstructor: THREE.MD2Loader,\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar loader = new THREE.FileLoader( scope.manager );\n\t\t\tloader.setPath( scope.path );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\tonLoad( scope.parse( buffer ) );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\tparse: ( function () {\n\n\t\t\tvar normalData = [\n\t\t\t\t[ - 0.525731, 0.000000, 0.850651 ], [ - 0.442863, 0.238856, 0.864188 ],\n\t\t\t\t[ - 0.295242, 0.000000, 0.955423 ], [ - 0.309017, 0.500000, 0.809017 ],\n\t\t\t\t[ - 0.162460, 0.262866, 0.951056 ], [ 0.000000, 0.000000, 1.000000 ],\n\t\t\t\t[ 0.000000, 0.850651, 0.525731 ], [ - 0.147621, 0.716567, 0.681718 ],\n\t\t\t\t[ 0.147621, 0.716567, 0.681718 ], [ 0.000000, 0.525731, 0.850651 ],\n\t\t\t\t[ 0.309017, 0.500000, 0.809017 ], [ 0.525731, 0.000000, 0.850651 ],\n\t\t\t\t[ 0.295242, 0.000000, 0.955423 ], [ 0.442863, 0.238856, 0.864188 ],\n\t\t\t\t[ 0.162460, 0.262866, 0.951056 ], [ - 0.681718, 0.147621, 0.716567 ],\n\t\t\t\t[ - 0.809017, 0.309017, 0.500000 ], [ - 0.587785, 0.425325, 0.688191 ],\n\t\t\t\t[ - 0.850651, 0.525731, 0.000000 ], [ - 0.864188, 0.442863, 0.238856 ],\n\t\t\t\t[ - 0.716567, 0.681718, 0.147621 ], [ - 0.688191, 0.587785, 0.425325 ],\n\t\t\t\t[ - 0.500000, 0.809017, 0.309017 ], [ - 0.238856, 0.864188, 0.442863 ],\n\t\t\t\t[ - 0.425325, 0.688191, 0.587785 ], [ - 0.716567, 0.681718, - 0.147621 ],\n\t\t\t\t[ - 0.500000, 0.809017, - 0.309017 ], [ - 0.525731, 0.850651, 0.000000 ],\n\t\t\t\t[ 0.000000, 0.850651, - 0.525731 ], [ - 0.238856, 0.864188, - 0.442863 ],\n\t\t\t\t[ 0.000000, 0.955423, - 0.295242 ], [ - 0.262866, 0.951056, - 0.162460 ],\n\t\t\t\t[ 0.000000, 1.000000, 0.000000 ], [ 0.000000, 0.955423, 0.295242 ],\n\t\t\t\t[ - 0.262866, 0.951056, 0.162460 ], [ 0.238856, 0.864188, 0.442863 ],\n\t\t\t\t[ 0.262866, 0.951056, 0.162460 ], [ 0.500000, 0.809017, 0.309017 ],\n\t\t\t\t[ 0.238856, 0.864188, - 0.442863 ], [ 0.262866, 0.951056, - 0.162460 ],\n\t\t\t\t[ 0.500000, 0.809017, - 0.309017 ], [ 0.850651, 0.525731, 0.000000 ],\n\t\t\t\t[ 0.716567, 0.681718, 0.147621 ], [ 0.716567, 0.681718, - 0.147621 ],\n\t\t\t\t[ 0.525731, 0.850651, 0.000000 ], [ 0.425325, 0.688191, 0.587785 ],\n\t\t\t\t[ 0.864188, 0.442863, 0.238856 ], [ 0.688191, 0.587785, 0.425325 ],\n\t\t\t\t[ 0.809017, 0.309017, 0.500000 ], [ 0.681718, 0.147621, 0.716567 ],\n\t\t\t\t[ 0.587785, 0.425325, 0.688191 ], [ 0.955423, 0.295242, 0.000000 ],\n\t\t\t\t[ 1.000000, 0.000000, 0.000000 ], [ 0.951056, 0.162460, 0.262866 ],\n\t\t\t\t[ 0.850651, - 0.525731, 0.000000 ], [ 0.955423, - 0.295242, 0.000000 ],\n\t\t\t\t[ 0.864188, - 0.442863, 0.238856 ], [ 0.951056, - 0.162460, 0.262866 ],\n\t\t\t\t[ 0.809017, - 0.309017, 0.500000 ], [ 0.681718, - 0.147621, 0.716567 ],\n\t\t\t\t[ 0.850651, 0.000000, 0.525731 ], [ 0.864188, 0.442863, - 0.238856 ],\n\t\t\t\t[ 0.809017, 0.309017, - 0.500000 ], [ 0.951056, 0.162460, - 0.262866 ],\n\t\t\t\t[ 0.525731, 0.000000, - 0.850651 ], [ 0.681718, 0.147621, - 0.716567 ],\n\t\t\t\t[ 0.681718, - 0.147621, - 0.716567 ], [ 0.850651, 0.000000, - 0.525731 ],\n\t\t\t\t[ 0.809017, - 0.309017, - 0.500000 ], [ 0.864188, - 0.442863, - 0.238856 ],\n\t\t\t\t[ 0.951056, - 0.162460, - 0.262866 ], [ 0.147621, 0.716567, - 0.681718 ],\n\t\t\t\t[ 0.309017, 0.500000, - 0.809017 ], [ 0.425325, 0.688191, - 0.587785 ],\n\t\t\t\t[ 0.442863, 0.238856, - 0.864188 ], [ 0.587785, 0.425325, - 0.688191 ],\n\t\t\t\t[ 0.688191, 0.587785, - 0.425325 ], [ - 0.147621, 0.716567, - 0.681718 ],\n\t\t\t\t[ - 0.309017, 0.500000, - 0.809017 ], [ 0.000000, 0.525731, - 0.850651 ],\n\t\t\t\t[ - 0.525731, 0.000000, - 0.850651 ], [ - 0.442863, 0.238856, - 0.864188 ],\n\t\t\t\t[ - 0.295242, 0.000000, - 0.955423 ], [ - 0.162460, 0.262866, - 0.951056 ],\n\t\t\t\t[ 0.000000, 0.000000, - 1.000000 ], [ 0.295242, 0.000000, - 0.955423 ],\n\t\t\t\t[ 0.162460, 0.262866, - 0.951056 ], [ - 0.442863, - 0.238856, - 0.864188 ],\n\t\t\t\t[ - 0.309017, - 0.500000, - 0.809017 ], [ - 0.162460, - 0.262866, - 0.951056 ],\n\t\t\t\t[ 0.000000, - 0.850651, - 0.525731 ], [ - 0.147621, - 0.716567, - 0.681718 ],\n\t\t\t\t[ 0.147621, - 0.716567, - 0.681718 ], [ 0.000000, - 0.525731, - 0.850651 ],\n\t\t\t\t[ 0.309017, - 0.500000, - 0.809017 ], [ 0.442863, - 0.238856, - 0.864188 ],\n\t\t\t\t[ 0.162460, - 0.262866, - 0.951056 ], [ 0.238856, - 0.864188, - 0.442863 ],\n\t\t\t\t[ 0.500000, - 0.809017, - 0.309017 ], [ 0.425325, - 0.688191, - 0.587785 ],\n\t\t\t\t[ 0.716567, - 0.681718, - 0.147621 ], [ 0.688191, - 0.587785, - 0.425325 ],\n\t\t\t\t[ 0.587785, - 0.425325, - 0.688191 ], [ 0.000000, - 0.955423, - 0.295242 ],\n\t\t\t\t[ 0.000000, - 1.000000, 0.000000 ], [ 0.262866, - 0.951056, - 0.162460 ],\n\t\t\t\t[ 0.000000, - 0.850651, 0.525731 ], [ 0.000000, - 0.955423, 0.295242 ],\n\t\t\t\t[ 0.238856, - 0.864188, 0.442863 ], [ 0.262866, - 0.951056, 0.162460 ],\n\t\t\t\t[ 0.500000, - 0.809017, 0.309017 ], [ 0.716567, - 0.681718, 0.147621 ],\n\t\t\t\t[ 0.525731, - 0.850651, 0.000000 ], [ - 0.238856, - 0.864188, - 0.442863 ],\n\t\t\t\t[ - 0.500000, - 0.809017, - 0.309017 ], [ - 0.262866, - 0.951056, - 0.162460 ],\n\t\t\t\t[ - 0.850651, - 0.525731, 0.000000 ], [ - 0.716567, - 0.681718, - 0.147621 ],\n\t\t\t\t[ - 0.716567, - 0.681718, 0.147621 ], [ - 0.525731, - 0.850651, 0.000000 ],\n\t\t\t\t[ - 0.500000, - 0.809017, 0.309017 ], [ - 0.238856, - 0.864188, 0.442863 ],\n\t\t\t\t[ - 0.262866, - 0.951056, 0.162460 ], [ - 0.864188, - 0.442863, 0.238856 ],\n\t\t\t\t[ - 0.809017, - 0.309017, 0.500000 ], [ - 0.688191, - 0.587785, 0.425325 ],\n\t\t\t\t[ - 0.681718, - 0.147621, 0.716567 ], [ - 0.442863, - 0.238856, 0.864188 ],\n\t\t\t\t[ - 0.587785, - 0.425325, 0.688191 ], [ - 0.309017, - 0.500000, 0.809017 ],\n\t\t\t\t[ - 0.147621, - 0.716567, 0.681718 ], [ - 0.425325, - 0.688191, 0.587785 ],\n\t\t\t\t[ - 0.162460, - 0.262866, 0.951056 ], [ 0.442863, - 0.238856, 0.864188 ],\n\t\t\t\t[ 0.162460, - 0.262866, 0.951056 ], [ 0.309017, - 0.500000, 0.809017 ],\n\t\t\t\t[ 0.147621, - 0.716567, 0.681718 ], [ 0.000000, - 0.525731, 0.850651 ],\n\t\t\t\t[ 0.425325, - 0.688191, 0.587785 ], [ 0.587785, - 0.425325, 0.688191 ],\n\t\t\t\t[ 0.688191, - 0.587785, 0.425325 ], [ - 0.955423, 0.295242, 0.000000 ],\n\t\t\t\t[ - 0.951056, 0.162460, 0.262866 ], [ - 1.000000, 0.000000, 0.000000 ],\n\t\t\t\t[ - 0.850651, 0.000000, 0.525731 ], [ - 0.955423, - 0.295242, 0.000000 ],\n\t\t\t\t[ - 0.951056, - 0.162460, 0.262866 ], [ - 0.864188, 0.442863, - 0.238856 ],\n\t\t\t\t[ - 0.951056, 0.162460, - 0.262866 ], [ - 0.809017, 0.309017, - 0.500000 ],\n\t\t\t\t[ - 0.864188, - 0.442863, - 0.238856 ], [ - 0.951056, - 0.162460, - 0.262866 ],\n\t\t\t\t[ - 0.809017, - 0.309017, - 0.500000 ], [ - 0.681718, 0.147621, - 0.716567 ],\n\t\t\t\t[ - 0.681718, - 0.147621, - 0.716567 ], [ - 0.850651, 0.000000, - 0.525731 ],\n\t\t\t\t[ - 0.688191, 0.587785, - 0.425325 ], [ - 0.587785, 0.425325, - 0.688191 ],\n\t\t\t\t[ - 0.425325, 0.688191, - 0.587785 ], [ - 0.425325, - 0.688191, - 0.587785 ],\n\t\t\t\t[ - 0.587785, - 0.425325, - 0.688191 ], [ - 0.688191, - 0.587785, - 0.425325 ]\n\t\t\t];\n\n\t\t\treturn function ( buffer ) {\n\n\t\t\t\tvar data = new DataView( buffer );\n\n\t\t\t\t// http://tfc.duke.free.fr/coding/md2-specs-en.html\n\n\t\t\t\tvar header = {};\n\t\t\t\tvar headerNames = [\n\t\t\t\t\t'ident', 'version',\n\t\t\t\t\t'skinwidth', 'skinheight',\n\t\t\t\t\t'framesize',\n\t\t\t\t\t'num_skins', 'num_vertices', 'num_st', 'num_tris', 'num_glcmds', 'num_frames',\n\t\t\t\t\t'offset_skins', 'offset_st', 'offset_tris', 'offset_frames', 'offset_glcmds', 'offset_end'\n\t\t\t\t];\n\n\t\t\t\tfor ( var i = 0; i < headerNames.length; i ++ ) {\n\n\t\t\t\t\theader[ headerNames[ i ] ] = data.getInt32( i * 4, true );\n\n\t\t\t\t}\n\n\t\t\t\tif ( header.ident !== 844121161 || header.version !== 8 ) {\n\n\t\t\t\t\tconsole.error( 'Not a valid MD2 file' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( header.offset_end !== data.byteLength ) {\n\n\t\t\t\t\tconsole.error( 'Corrupted MD2 file' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\t//\n\n\t\t\t\tvar geometry = new THREE.BufferGeometry();\n\n\t\t\t\t// uvs\n\n\t\t\t\tvar uvsTemp = [];\n\t\t\t\tvar offset = header.offset_st;\n\n\t\t\t\tfor ( var i = 0, l = header.num_st; i < l; i ++ ) {\n\n\t\t\t\t\tvar u = data.getInt16( offset + 0, true );\n\t\t\t\t\tvar v = data.getInt16( offset + 2, true );\n\n\t\t\t\t\tuvsTemp.push( u / header.skinwidth, 1 - ( v / header.skinheight ) );\n\n\t\t\t\t\toffset += 4;\n\n\t\t\t\t}\n\n\t\t\t\t// triangles\n\n\t\t\t\toffset = header.offset_tris;\n\n\t\t\t\tvar vertexIndices = [];\n\t\t\t\tvar uvIndices = [];\n\n\t\t\t\tfor ( var i = 0, l = header.num_tris; i < l; i ++ ) {\n\n\t\t\t\t\tvertexIndices.push(\n\t\t\t\t\t\tdata.getUint16( offset + 0, true ),\n\t\t\t\t\t\tdata.getUint16( offset + 2, true ),\n\t\t\t\t\t\tdata.getUint16( offset + 4, true )\n\t\t\t\t\t);\n\n\t\t\t\t\tuvIndices.push(\n\t\t\t\t\t\tdata.getUint16( offset + 6, true ),\n\t\t\t\t\t\tdata.getUint16( offset + 8, true ),\n\t\t\t\t\t\tdata.getUint16( offset + 10, true )\n\t\t\t\t\t);\n\n\t\t\t\t\toffset += 12;\n\n\t\t\t\t}\n\n\t\t\t\t// frames\n\n\t\t\t\tvar translation = new THREE.Vector3();\n\t\t\t\tvar scale = new THREE.Vector3();\n\t\t\t\tvar string = [];\n\n\t\t\t\tvar frames = [];\n\n\t\t\t\toffset = header.offset_frames;\n\n\t\t\t\tfor ( var i = 0, l = header.num_frames; i < l; i ++ ) {\n\n\t\t\t\t\tscale.set(\n\t\t\t\t\t\tdata.getFloat32( offset + 0, true ),\n\t\t\t\t\t\tdata.getFloat32( offset + 4, true ),\n\t\t\t\t\t\tdata.getFloat32( offset + 8, true )\n\t\t\t\t\t);\n\n\t\t\t\t\ttranslation.set(\n\t\t\t\t\t\tdata.getFloat32( offset + 12, true ),\n\t\t\t\t\t\tdata.getFloat32( offset + 16, true ),\n\t\t\t\t\t\tdata.getFloat32( offset + 20, true )\n\t\t\t\t\t);\n\n\t\t\t\t\toffset += 24;\n\n\t\t\t\t\tfor ( var j = 0; j < 16; j ++ ) {\n\n\t\t\t\t\t\tvar character = data.getUint8( offset + j, true );\n\t\t\t\t\t\tif ( character === 0 ) break;\n\n\t\t\t\t\t\tstring[ j ] = character;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar frame = {\n\t\t\t\t\t\tname: String.fromCharCode.apply( null, string ),\n\t\t\t\t\t\tvertices: [],\n\t\t\t\t\t\tnormals: []\n\t\t\t\t\t};\n\n\t\t\t\t\toffset += 16;\n\n\t\t\t\t\tfor ( var j = 0; j < header.num_vertices; j ++ ) {\n\n\t\t\t\t\t\tvar x = data.getUint8( offset ++, true );\n\t\t\t\t\t\tvar y = data.getUint8( offset ++, true );\n\t\t\t\t\t\tvar z = data.getUint8( offset ++, true );\n\t\t\t\t\t\tvar n = normalData[ data.getUint8( offset ++, true ) ];\n\n\t\t\t\t\t\tx = x * scale.x + translation.x;\n\t\t\t\t\t\ty = y * scale.y + translation.y;\n\t\t\t\t\t\tz = z * scale.z + translation.z;\n\n\t\t\t\t\t\tframe.vertices.push( x, z, y ); // convert to Y-up\n\t\t\t\t\t\tframe.normals.push( n[ 0 ], n[ 2 ], n[ 1 ] ); // convert to Y-up\n\n\t\t\t\t\t}\n\n\t\t\t\t\tframes.push( frame );\n\n\t\t\t\t}\n\n\t\t\t\t// static\n\n\t\t\t\tvar positions = [];\n\t\t\t\tvar normals = [];\n\t\t\t\tvar uvs = [];\n\n\t\t\t\tvar verticesTemp = frames[ 0 ].vertices;\n\t\t\t\tvar normalsTemp = frames[ 0 ].normals;\n\n\t\t\t\tfor ( var i = 0, l = vertexIndices.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar vertexIndex = vertexIndices[ i ];\n\t\t\t\t\tvar stride = vertexIndex * 3;\n\n\t\t\t\t\t//\n\n\t\t\t\t\tvar x = verticesTemp[ stride ];\n\t\t\t\t\tvar y = verticesTemp[ stride + 1 ];\n\t\t\t\t\tvar z = verticesTemp[ stride + 2 ];\n\n\t\t\t\t\tpositions.push( x, y, z );\n\n\t\t\t\t\t//\n\n\t\t\t\t\tvar nx = normalsTemp[ stride ];\n\t\t\t\t\tvar ny = normalsTemp[ stride + 1 ];\n\t\t\t\t\tvar nz = normalsTemp[ stride + 2 ];\n\n\t\t\t\t\tnormals.push( nx, ny, nz );\n\n\t\t\t\t\t//\n\n\t\t\t\t\tvar uvIndex = uvIndices[ i ];\n\t\t\t\t\tstride = uvIndex * 2;\n\n\t\t\t\t\tvar u = uvsTemp[ stride ];\n\t\t\t\t\tvar v = uvsTemp[ stride + 1 ];\n\n\t\t\t\t\tuvs.push( u, v );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'position', new THREE.Float32BufferAttribute( positions, 3 ) );\n\t\t\t\tgeometry.setAttribute( 'normal', new THREE.Float32BufferAttribute( normals, 3 ) );\n\t\t\t\tgeometry.setAttribute( 'uv', new THREE.Float32BufferAttribute( uvs, 2 ) );\n\n\t\t\t\t// animation\n\n\t\t\t\tvar morphPositions = [];\n\t\t\t\tvar morphNormals = [];\n\n\t\t\t\tfor ( var i = 0, l = frames.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar frame = frames[ i ];\n\t\t\t\t\tvar attributeName = frame.name;\n\n\t\t\t\t\tif ( frame.vertices.length > 0 ) {\n\n\t\t\t\t\t\tvar positions = [];\n\n\t\t\t\t\t\tfor ( var j = 0, jl = vertexIndices.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tvar vertexIndex = vertexIndices[ j ];\n\t\t\t\t\t\t\tvar stride = vertexIndex * 3;\n\n\t\t\t\t\t\t\tvar x = frame.vertices[ stride ];\n\t\t\t\t\t\t\tvar y = frame.vertices[ stride + 1 ];\n\t\t\t\t\t\t\tvar z = frame.vertices[ stride + 2 ];\n\n\t\t\t\t\t\t\tpositions.push( x, y, z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar positionAttribute = new THREE.Float32BufferAttribute( positions, 3 );\n\t\t\t\t\t\tpositionAttribute.name = attributeName;\n\n\t\t\t\t\t\tmorphPositions.push( positionAttribute );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( frame.normals.length > 0 ) {\n\n\t\t\t\t\t\tvar normals = [];\n\n\t\t\t\t\t\tfor ( var j = 0, jl = vertexIndices.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tvar vertexIndex = vertexIndices[ j ];\n\t\t\t\t\t\t\tvar stride = vertexIndex * 3;\n\n\t\t\t\t\t\t\tvar nx = frame.normals[ stride ];\n\t\t\t\t\t\t\tvar ny = frame.normals[ stride + 1 ];\n\t\t\t\t\t\t\tvar nz = frame.normals[ stride + 2 ];\n\n\t\t\t\t\t\t\tnormals.push( nx, ny, nz );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar normalAttribute = new THREE.Float32BufferAttribute( normals, 3 );\n\t\t\t\t\t\tnormalAttribute.name = attributeName;\n\n\t\t\t\t\t\tmorphNormals.push( normalAttribute );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.morphAttributes.position = morphPositions;\n\t\t\t\tgeometry.morphAttributes.normal = morphNormals;\n\t\t\t\tgeometry.morphTargetsRelative = false;\n\n\t\t\t\tgeometry.animations = THREE.AnimationClip.CreateClipsFromMorphTargetSequences( frames, 10 );\n\n\t\t\t\treturn geometry;\n\n\t\t\t};\n\n\t\t} )()\n\n\t} );\n\t\n\treturn THREE.MD2Loader;\n});\n"]}
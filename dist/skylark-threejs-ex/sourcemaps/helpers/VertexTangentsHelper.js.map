{"version":3,"sources":["helpers/VertexTangentsHelper.js"],"names":["define","THREE","_v1","Vector3","_v2","VertexTangentsHelper","object","size","hex","linewidth","this","undefined","color","width","objGeometry","geometry","isBufferGeometry","nTangents","attributes","tangent","count","BufferGeometry","positions","Float32BufferAttribute","setAttribute","LineSegments","call","LineBasicMaterial","matrixAutoUpdate","update","console","error","prototype","Object","create","constructor","updateMatrixWorld","matrixWorld","position","objPos","objTan","idx","j","jl","set","getX","getY","getZ","applyMatrix4","transformDirection","multiplyScalar","add","setXYZ","x","y","z","needsUpdate"],"mappings":";;;;;;;AAAAA,QACI,mBACD,SAAUC,GACT,aACA,IAAIC,EAAM,IAAID,EAAME,QAChBC,EAAM,IAAIH,EAAME,QACpB,SAASE,EAAqBC,EAAQC,EAAMC,EAAKC,GAC7CC,KAAKJ,OAASA,EACdI,KAAKH,UAAgBI,IAATJ,EAAqBA,EAAO,EACxC,IAAIK,OAAgBD,IAARH,EAAoBA,EAAM,MAClCK,OAAsBF,IAAdF,EAA0BA,EAAY,EAC9CK,EAAcJ,KAAKJ,OAAOS,SAC9B,GAAMD,GAAeA,EAAYE,iBAAjC,CAIA,IAAIC,EAAYH,EAAYI,WAAWC,QAAQC,MAC3CL,EAAW,IAAId,EAAMoB,eACrBC,EAAY,IAAIrB,EAAMsB,uBAAmC,EAAZN,EAAgB,EAAG,GACpEF,EAASS,aAAa,WAAYF,GAClCrB,EAAMwB,aAAaC,KAAKhB,KAAMK,EAAU,IAAId,EAAM0B,mBAC9Cf,MAAOA,EACPH,UAAWI,KAEfH,KAAKkB,kBAAmB,EACxBlB,KAAKmB,cAZDC,QAAQC,MAAM,gFAAiFjB,GAoCvG,OAtBAT,EAAqB2B,UAAYC,OAAOC,OAAOjC,EAAMwB,aAAaO,WAClE3B,EAAqB2B,UAAUG,YAAc9B,EAC7CA,EAAqB2B,UAAUH,OAAS,WACpCnB,KAAKJ,OAAO8B,mBAAkB,GAO9B,IANA,IAAIC,EAAc3B,KAAKJ,OAAO+B,YAC1BC,EAAW5B,KAAKK,SAASG,WAAWoB,SACpCxB,EAAcJ,KAAKJ,OAAOS,SAC1BwB,EAASzB,EAAYI,WAAWoB,SAChCE,EAAS1B,EAAYI,WAAWC,QAChCsB,EAAM,EACDC,EAAI,EAAGC,EAAKJ,EAAOnB,MAAOsB,EAAIC,EAAID,IACvCxC,EAAI0C,IAAIL,EAAOM,KAAKH,GAAIH,EAAOO,KAAKJ,GAAIH,EAAOQ,KAAKL,IAAIM,aAAaX,GACrEjC,EAAIwC,IAAIJ,EAAOK,KAAKH,GAAIF,EAAOM,KAAKJ,GAAIF,EAAOO,KAAKL,IACpDtC,EAAI6C,mBAAmBZ,GAAaa,eAAexC,KAAKH,MAAM4C,IAAIjD,GAClEoC,EAASc,OAAOX,EAAKvC,EAAImD,EAAGnD,EAAIoD,EAAGpD,EAAIqD,GACvCd,GAAY,EACZH,EAASc,OAAOX,EAAKrC,EAAIiD,EAAGjD,EAAIkD,EAAGlD,EAAImD,GACvCd,GAAY,EAEhBH,EAASkB,aAAc,GAGpBnD","file":"../../helpers/VertexTangentsHelper.js","sourcesContent":["define([\n    \"skylark-threejs\"\n], function (THREE) {\n    'use strict';\n    var _v1 = new THREE.Vector3();\n    var _v2 = new THREE.Vector3();\n    function VertexTangentsHelper(object, size, hex, linewidth) {\n        this.object = object;\n        this.size = size !== undefined ? size : 1;\n        var color = hex !== undefined ? hex : 65535;\n        var width = linewidth !== undefined ? linewidth : 1;\n        var objGeometry = this.object.geometry;\n        if (!(objGeometry && objGeometry.isBufferGeometry)) {\n            console.error('THREE.VertexTangentsHelper: geometry not an instance of THREE.BufferGeometry.', objGeometry);\n            return;\n        }\n        var nTangents = objGeometry.attributes.tangent.count;\n        var geometry = new THREE.BufferGeometry();\n        var positions = new THREE.Float32BufferAttribute(nTangents * 2 * 3, 3);\n        geometry.setAttribute('position', positions);\n        THREE.LineSegments.call(this, geometry, new THREE.LineBasicMaterial({\n            color: color,\n            linewidth: width\n        }));\n        this.matrixAutoUpdate = false;\n        this.update();\n    }\n    VertexTangentsHelper.prototype = Object.create(THREE.LineSegments.prototype);\n    VertexTangentsHelper.prototype.constructor = VertexTangentsHelper;\n    VertexTangentsHelper.prototype.update = function () {\n        this.object.updateMatrixWorld(true);\n        var matrixWorld = this.object.matrixWorld;\n        var position = this.geometry.attributes.position;\n        var objGeometry = this.object.geometry;\n        var objPos = objGeometry.attributes.position;\n        var objTan = objGeometry.attributes.tangent;\n        var idx = 0;\n        for (var j = 0, jl = objPos.count; j < jl; j++) {\n            _v1.set(objPos.getX(j), objPos.getY(j), objPos.getZ(j)).applyMatrix4(matrixWorld);\n            _v2.set(objTan.getX(j), objTan.getY(j), objTan.getZ(j));\n            _v2.transformDirection(matrixWorld).multiplyScalar(this.size).add(_v1);\n            position.setXYZ(idx, _v1.x, _v1.y, _v1.z);\n            idx = idx + 1;\n            position.setXYZ(idx, _v2.x, _v2.y, _v2.z);\n            idx = idx + 1;\n        }\n        position.needsUpdate = true;\n    };\n\n    return VertexTangentsHelper;\n});"]}
{"version":3,"sources":["lines/Wireframe.js"],"names":["define","THREE","threex","LineSegmentsGeometry","LineMaterial","start","end","Wireframe","geometry","material","Mesh","call","this","type","undefined","color","Math","random","prototype","Object","assign","create","constructor","isWireframe","computeLineDistances","Vector3","instanceStart","attributes","instanceEnd","lineDistances","Float32Array","data","count","i","j","l","fromBufferAttribute","distanceTo","instanceDistanceBuffer","InstancedInterleavedBuffer","setAttribute","InterleavedBufferAttribute","lines"],"mappings":";;;;;;;AAAAA,QACI,kBACA,YACA,yBACA,kBACD,SACCC,EACAC,EACAC,EACAC,GAEA,aACA,IAUYC,EACAC,EAXRC,EAAY,SAAUC,EAAUC,GAChCR,EAAMS,KAAKC,KAAKC,MAChBA,KAAKC,KAAO,YACZD,KAAKJ,cAAwBM,IAAbN,EAAyBA,EAAW,IAAIL,EACxDS,KAAKH,cAAwBK,IAAbL,EAAyBA,EAAW,IAAIL,GAAeW,MAAuB,SAAhBC,KAAKC,YA0BvF,OAxBAV,EAAUW,UAAYC,OAAOC,OAAOD,OAAOE,OAAOpB,EAAMS,KAAKQ,YACzDI,YAAaf,EACbgB,aAAa,EACbC,sBACQnB,EAAQ,IAAIJ,EAAMwB,QAClBnB,EAAM,IAAIL,EAAMwB,QACb,WAKH,IAJA,IAAIjB,EAAWI,KAAKJ,SAChBkB,EAAgBlB,EAASmB,WAAWD,cACpCE,EAAcpB,EAASmB,WAAWC,YAClCC,EAAgB,IAAIC,aAAa,EAAIJ,EAAcK,KAAKC,OACnDC,EAAI,EAAGC,EAAI,EAAGC,EAAIT,EAAcK,KAAKC,MAAOC,EAAIE,EAAGF,IAAKC,GAAK,EAClE7B,EAAM+B,oBAAoBV,EAAeO,GACzC3B,EAAI8B,oBAAoBR,EAAaK,GACrCJ,EAAcK,GAAW,IAANA,EAAU,EAAIL,EAAcK,EAAI,GACnDL,EAAcK,EAAI,GAAKL,EAAcK,GAAK7B,EAAMgC,WAAW/B,GAE/D,IAAIgC,EAAyB,IAAIrC,EAAMsC,2BAA2BV,EAAe,EAAG,GAGpF,OAFArB,EAASgC,aAAa,wBAAyB,IAAIvC,EAAMwC,2BAA2BH,EAAwB,EAAG,IAC/G9B,EAASgC,aAAa,sBAAuB,IAAIvC,EAAMwC,2BAA2BH,EAAwB,EAAG,IACtG1B,SAIZV,EAAOwC,MAAMnC,UAAYA","file":"../../lines/Wireframe.js","sourcesContent":["define([\r\n    \"skylark-threejs\",\r\n    \"../threex\",\r\n    './LineSegmentsGeometry',\r\n    './LineMaterial'\r\n], function (\r\n    THREE, \r\n    threex,\r\n    LineSegmentsGeometry, \r\n    LineMaterial\r\n) {\r\n    'use strict';\r\n    var Wireframe = function (geometry, material) {\r\n        THREE.Mesh.call(this);\r\n        this.type = 'Wireframe';\r\n        this.geometry = geometry !== undefined ? geometry : new LineSegmentsGeometry();\r\n        this.material = material !== undefined ? material : new LineMaterial({ color: Math.random() * 16777215 });\r\n    };\r\n    Wireframe.prototype = Object.assign(Object.create(THREE.Mesh.prototype), {\r\n        constructor: Wireframe,\r\n        isWireframe: true,\r\n        computeLineDistances: function () {\r\n            var start = new THREE.Vector3();\r\n            var end = new THREE.Vector3();\r\n            return function computeLineDistances() {\r\n                var geometry = this.geometry;\r\n                var instanceStart = geometry.attributes.instanceStart;\r\n                var instanceEnd = geometry.attributes.instanceEnd;\r\n                var lineDistances = new Float32Array(2 * instanceStart.data.count);\r\n                for (var i = 0, j = 0, l = instanceStart.data.count; i < l; i++, j += 2) {\r\n                    start.fromBufferAttribute(instanceStart, i);\r\n                    end.fromBufferAttribute(instanceEnd, i);\r\n                    lineDistances[j] = j === 0 ? 0 : lineDistances[j - 1];\r\n                    lineDistances[j + 1] = lineDistances[j] + start.distanceTo(end);\r\n                }\r\n                var instanceDistanceBuffer = new THREE.InstancedInterleavedBuffer(lineDistances, 2, 1);\r\n                geometry.setAttribute('instanceDistanceStart', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 0));\r\n                geometry.setAttribute('instanceDistanceEnd', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 1));\r\n                return this;\r\n            };\r\n        }()\r\n    });\r\n    return threex.lines.Wireframe = Wireframe;\r\n});"]}
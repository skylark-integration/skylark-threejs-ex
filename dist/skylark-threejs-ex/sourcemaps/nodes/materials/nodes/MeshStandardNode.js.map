{"version":3,"sources":["nodes/materials/nodes/MeshStandardNode.js"],"names":["define","THREE","StandardNode","PropertyNode","OperatorNode","SwitchNode","NormalMapNode","MeshStandardNode","call","this","properties","color","Color","roughness","metalness","normalScale","Vector2","inputs","prototype","Object","create","constructor","nodeType","build","builder","props","isShader","findNode","map","resolve","MUL","roughnessMap","metalnessMap","normalMap","normal","scale","undefined","environment","envMap","toJSON","meta","data","getJSONNode","createJSONNode","console","warn"],"mappings":";;;;;;;AAAAA,QACI,kBACA,iBACA,4BACA,0BACA,yBACA,4BACD,SACCC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA,aACA,SAASC,IACLL,EAAaM,KAAKC,MAClBA,KAAKC,YACDC,MAAO,IAAIV,EAAMW,MAAM,UACvBC,UAAW,GACXC,UAAW,GACXC,YAAa,IAAId,EAAMe,QAAQ,EAAG,IAEtCP,KAAKQ,QACDN,MAAO,IAAIR,EAAaM,KAAKC,WAAY,QAAS,KAClDG,UAAW,IAAIV,EAAaM,KAAKC,WAAY,YAAa,KAC1DI,UAAW,IAAIX,EAAaM,KAAKC,WAAY,YAAa,KAC1DK,YAAa,IAAIZ,EAAaM,KAAKC,WAAY,cAAe,OAiCtE,OA9BAH,EAAiBW,UAAYC,OAAOC,OAAOlB,EAAagB,WACxDX,EAAiBW,UAAUG,YAAcd,EACzCA,EAAiBW,UAAUI,SAAW,eACtCf,EAAiBW,UAAUK,MAAQ,SAAUC,GACzC,IAAIC,EAAQhB,KAAKC,WAAYO,EAASR,KAAKQ,OAC3C,GAAIO,EAAQE,SAAS,YAAa,CAC9B,IAAIf,EAAQa,EAAQG,SAASF,EAAMd,MAAOM,EAAON,OAAQiB,EAAMJ,EAAQK,QAAQJ,EAAMG,KACrFnB,KAAKE,MAAQiB,EAAM,IAAIxB,EAAaO,EAAOiB,EAAKxB,EAAa0B,KAAOnB,EACpE,IAAIE,EAAYW,EAAQG,SAASF,EAAMZ,UAAWI,EAAOJ,WAAYkB,EAAeP,EAAQK,QAAQJ,EAAMM,cAC1GtB,KAAKI,UAAYkB,EAAe,IAAI3B,EAAaS,EAAW,IAAIR,EAAW0B,EAAc,KAAM3B,EAAa0B,KAAOjB,EACnH,IAAIC,EAAYU,EAAQG,SAASF,EAAMX,UAAWG,EAAOH,WAAYkB,EAAeR,EAAQK,QAAQJ,EAAMO,cAC1GvB,KAAKK,UAAYkB,EAAe,IAAI5B,EAAaU,EAAW,IAAIT,EAAW2B,EAAc,KAAM5B,EAAa0B,KAAOhB,EAC/GW,EAAMQ,WACNxB,KAAKyB,OAAS,IAAI5B,EAAckB,EAAQK,QAAQJ,EAAMQ,YACtDxB,KAAKyB,OAAOC,MAAQX,EAAQG,SAASF,EAAMV,YAAaE,EAAOF,cAE/DN,KAAKyB,YAASE,EAElB3B,KAAK4B,YAAcb,EAAQK,QAAQJ,EAAMa,QAE7C,OAAOpC,EAAagB,UAAUK,MAAMf,KAAKC,KAAMe,IAEnDjB,EAAiBW,UAAUqB,OAAS,SAAUC,GAC1C,IAAIC,EAAOhC,KAAKiC,YAAYF,GAK5B,OAJKC,IACDA,EAAOhC,KAAKkC,eAAeH,GAC3BI,QAAQC,KAAK,6BAA8BpC,OAExCgC,GAEJlC","file":"../../../../nodes/materials/nodes/MeshStandardNode.js","sourcesContent":["define([\n    'skylark-threejs',\n    './StandardNode',\n    '../../inputs/PropertyNode',\n    '../../math/OperatorNode',\n    '../../utils/SwitchNode',\n    '../../misc/NormalMapNode'\n], function (\n    THREE, \n    StandardNode, \n    PropertyNode, \n    OperatorNode, \n    SwitchNode, \n    NormalMapNode\n) {\n    'use strict';\n    function MeshStandardNode() {\n        StandardNode.call(this);\n        this.properties = {\n            color: new THREE.Color(16777215),\n            roughness: 0.5,\n            metalness: 0.5,\n            normalScale: new THREE.Vector2(1, 1)\n        };\n        this.inputs = {\n            color: new PropertyNode(this.properties, 'color', 'c'),\n            roughness: new PropertyNode(this.properties, 'roughness', 'f'),\n            metalness: new PropertyNode(this.properties, 'metalness', 'f'),\n            normalScale: new PropertyNode(this.properties, 'normalScale', 'v2')\n        };\n    }\n    MeshStandardNode.prototype = Object.create(StandardNode.prototype);\n    MeshStandardNode.prototype.constructor = MeshStandardNode;\n    MeshStandardNode.prototype.nodeType = 'MeshStandard';\n    MeshStandardNode.prototype.build = function (builder) {\n        var props = this.properties, inputs = this.inputs;\n        if (builder.isShader('fragment')) {\n            var color = builder.findNode(props.color, inputs.color), map = builder.resolve(props.map);\n            this.color = map ? new OperatorNode(color, map, OperatorNode.MUL) : color;\n            var roughness = builder.findNode(props.roughness, inputs.roughness), roughnessMap = builder.resolve(props.roughnessMap);\n            this.roughness = roughnessMap ? new OperatorNode(roughness, new SwitchNode(roughnessMap, 'g'), OperatorNode.MUL) : roughness;\n            var metalness = builder.findNode(props.metalness, inputs.metalness), metalnessMap = builder.resolve(props.metalnessMap);\n            this.metalness = metalnessMap ? new OperatorNode(metalness, new SwitchNode(metalnessMap, 'b'), OperatorNode.MUL) : metalness;\n            if (props.normalMap) {\n                this.normal = new NormalMapNode(builder.resolve(props.normalMap));\n                this.normal.scale = builder.findNode(props.normalScale, inputs.normalScale);\n            } else {\n                this.normal = undefined;\n            }\n            this.environment = builder.resolve(props.envMap);\n        }\n        return StandardNode.prototype.build.call(this, builder);\n    };\n    MeshStandardNode.prototype.toJSON = function (meta) {\n        var data = this.getJSONNode(meta);\n        if (!data) {\n            data = this.createJSONNode(meta);\n            console.warn('.toJSON not implemented in', this);\n        }\n        return data;\n    };\n    return MeshStandardNode;\n});"]}
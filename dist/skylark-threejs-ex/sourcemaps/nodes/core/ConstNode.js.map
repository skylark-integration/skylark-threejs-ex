{"version":3,"sources":["nodes/core/ConstNode.js"],"names":["define","TempNode","declarationRegexp","ConstNode","src","useDefine","call","this","parse","PI","PI2","RECIPROCAL_PI","RECIPROCAL_PI2","LOG2","EPSILON","prototype","Object","create","constructor","nodeType","getType","builder","getTypeByFormat","type","name","value","match","charAt","length","build","output","include","format","generate","copy","source","toJSON","meta","data","getJSONNode","createJSONNode"],"mappings":";;;;;;;AAAAA,QACI,cACD,SAAUC,GACT,aACA,IAAIC,EAAoB,mDACxB,SAASC,EAAUC,EAAKC,GACpBJ,EAASK,KAAKC,MACdA,KAAKC,MAAMJ,GAAOD,EAAUM,GAAIJ,GAgEpC,OA9DAF,EAAUM,GAAK,KACfN,EAAUO,IAAM,MAChBP,EAAUQ,cAAgB,gBAC1BR,EAAUS,eAAiB,iBAC3BT,EAAUU,KAAO,OACjBV,EAAUW,QAAU,UACpBX,EAAUY,UAAYC,OAAOC,OAAOhB,EAASc,WAC7CZ,EAAUY,UAAUG,YAAcf,EAClCA,EAAUY,UAAUI,SAAW,QAC/BhB,EAAUY,UAAUK,QAAU,SAAUC,GACpC,OAAOA,EAAQC,gBAAgBf,KAAKgB,OAExCpB,EAAUY,UAAUP,MAAQ,SAAUJ,EAAKC,GACvCE,KAAKH,IAAMA,GAAO,GAClB,IAAIoB,EAAMD,EAAME,EAAQ,GACpBC,EAAQnB,KAAKH,IAAIsB,MAAMxB,GAC3BK,KAAKF,UAAYA,GAAoC,MAAvBE,KAAKH,IAAIuB,OAAO,GAC1CD,GAASA,EAAME,OAAS,GACxBL,EAAOG,EAAM,GACbF,EAAOE,EAAM,GACbD,EAAQC,EAAM,KAEdF,EAAOjB,KAAKH,IACZmB,EAAO,KAEXhB,KAAKiB,KAAOA,EACZjB,KAAKgB,KAAOA,EACZhB,KAAKkB,MAAQA,GAEjBtB,EAAUY,UAAUc,MAAQ,SAAUR,EAASS,GAC3C,MAAe,WAAXA,GAUAT,EAAQU,QAAQxB,MACTc,EAAQW,OAAOzB,KAAKiB,KAAMjB,KAAKa,QAAQC,GAAUS,IAVpDvB,KAAKkB,MACDlB,KAAKF,UACE,WAAaE,KAAKiB,KAAO,IAAMjB,KAAKkB,MAExC,SAAWlB,KAAKgB,KAAO,IAAMhB,KAAKiB,KAAO,MAAQjB,KAAKkB,MAAQ,IAC9DlB,KAAKF,UACLE,KAAKH,SADT,GAQfD,EAAUY,UAAUkB,SAAW,SAAUZ,EAASS,GAC9C,OAAOT,EAAQW,OAAOzB,KAAKiB,KAAMjB,KAAKa,QAAQC,GAAUS,IAE5D3B,EAAUY,UAAUmB,KAAO,SAAUC,GAGjC,OAFAlC,EAASc,UAAUmB,KAAK5B,KAAKC,KAAM4B,GACnC5B,KAAKC,MAAM2B,EAAO/B,IAAK+B,EAAO9B,WACvBE,MAEXJ,EAAUY,UAAUqB,OAAS,SAAUC,GACnC,IAAIC,EAAO/B,KAAKgC,YAAYF,GAO5B,OANKC,KACDA,EAAO/B,KAAKiC,eAAeH,IACtBjC,IAAMG,KAAKH,KACO,IAAnBkC,EAAKjC,YACLiC,EAAKjC,WAAY,IAElBiC,GAEJnC","file":"../../../nodes/core/ConstNode.js","sourcesContent":["define([\r\n    './TempNode'\r\n], function (TempNode) {\r\n    'use strict';\r\n    var declarationRegexp = /^([a-z_0-9]+)\\s([a-z_0-9]+)\\s?\\=?\\s?(.*?)(\\;|$)/i;\r\n    function ConstNode(src, useDefine) {\r\n        TempNode.call(this);\r\n        this.parse(src || ConstNode.PI, useDefine);\r\n    }\r\n    ConstNode.PI = 'PI';\r\n    ConstNode.PI2 = 'PI2';\r\n    ConstNode.RECIPROCAL_PI = 'RECIPROCAL_PI';\r\n    ConstNode.RECIPROCAL_PI2 = 'RECIPROCAL_PI2';\r\n    ConstNode.LOG2 = 'LOG2';\r\n    ConstNode.EPSILON = 'EPSILON';\r\n    ConstNode.prototype = Object.create(TempNode.prototype);\r\n    ConstNode.prototype.constructor = ConstNode;\r\n    ConstNode.prototype.nodeType = 'Const';\r\n    ConstNode.prototype.getType = function (builder) {\r\n        return builder.getTypeByFormat(this.type);\r\n    };\r\n    ConstNode.prototype.parse = function (src, useDefine) {\r\n        this.src = src || '';\r\n        var name, type, value = '';\r\n        var match = this.src.match(declarationRegexp);\r\n        this.useDefine = useDefine || this.src.charAt(0) === '#';\r\n        if (match && match.length > 1) {\r\n            type = match[1];\r\n            name = match[2];\r\n            value = match[3];\r\n        } else {\r\n            name = this.src;\r\n            type = 'f';\r\n        }\r\n        this.name = name;\r\n        this.type = type;\r\n        this.value = value;\r\n    };\r\n    ConstNode.prototype.build = function (builder, output) {\r\n        if (output === 'source') {\r\n            if (this.value) {\r\n                if (this.useDefine) {\r\n                    return '#define ' + this.name + ' ' + this.value;\r\n                }\r\n                return 'const ' + this.type + ' ' + this.name + ' = ' + this.value + ';';\r\n            } else if (this.useDefine) {\r\n                return this.src;\r\n            }\r\n        } else {\r\n            builder.include(this);\r\n            return builder.format(this.name, this.getType(builder), output);\r\n        }\r\n    };\r\n    ConstNode.prototype.generate = function (builder, output) {\r\n        return builder.format(this.name, this.getType(builder), output);\r\n    };\r\n    ConstNode.prototype.copy = function (source) {\r\n        TempNode.prototype.copy.call(this, source);\r\n        this.parse(source.src, source.useDefine);\r\n        return this;\r\n    };\r\n    ConstNode.prototype.toJSON = function (meta) {\r\n        var data = this.getJSONNode(meta);\r\n        if (!data) {\r\n            data = this.createJSONNode(meta);\r\n            data.src = this.src;\r\n            if (data.useDefine === true)\r\n                data.useDefine = true;\r\n        }\r\n        return data;\r\n    };\r\n    return ConstNode;\r\n});"]}
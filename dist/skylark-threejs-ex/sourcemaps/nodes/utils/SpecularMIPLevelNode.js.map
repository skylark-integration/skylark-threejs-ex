{"version":3,"sources":["nodes/utils/SpecularMIPLevelNode.js"],"names":["define","TempNode","FunctionNode","MaxMIPLevelNode","SpecularMIPLevelNode","roughness","texture","call","this","maxMIPLevel","undefined","Nodes","getSpecularMIPLevel","join","prototype","Object","create","constructor","nodeType","setTexture","generate","builder","output","isShader","include","format","build","type","console","warn","shader","copy","source","toJSON","meta","data","getJSONNode","createJSONNode"],"mappings":";;;;;;;AAAAA,QACI,mBACA,uBACA,qBACD,SACCC,EACAC,EACAC,GAEA,aACA,SAASC,EAAqBC,EAAWC,GACrCL,EAASM,KAAKC,KAAM,KACpBA,KAAKH,UAAYA,EACjBG,KAAKF,QAAUA,EACfE,KAAKC,iBAAcC,EA6CvB,OA3CAN,EAAqBO,OAQRC,oBAPiB,IAAIV,GAC1B,4FACA,oEACA,+DACA,6DACA,KACFW,KAAK,QAGXT,EAAqBU,UAAYC,OAAOC,OAAOf,EAASa,WACxDV,EAAqBU,UAAUG,YAAcb,EAC7CA,EAAqBU,UAAUI,SAAW,mBAC1Cd,EAAqBU,UAAUK,WAAa,SAAUb,GAElD,OADAE,KAAKF,QAAUA,EACRE,MAEXJ,EAAqBU,UAAUM,SAAW,SAAUC,EAASC,GACzD,GAAID,EAAQE,SAAS,YAAa,CAC9Bf,KAAKC,YAAcD,KAAKC,aAAe,IAAIN,EAC3CK,KAAKC,YAAYH,QAAUE,KAAKF,QAChC,IAAIM,EAAsBS,EAAQG,QAAQpB,EAAqBO,MAAMC,qBACrE,OAAOS,EAAQI,OAAOb,EAAsB,KAAOJ,KAAKH,UAAUqB,MAAML,EAAS,KAAO,KAAOb,KAAKC,YAAYiB,MAAML,EAAS,KAAO,KAAMb,KAAKmB,KAAML,GAGvJ,OADAM,QAAQC,KAAK,qDAAuDR,EAAQS,OAAS,YAC9ET,EAAQI,OAAO,MAAOjB,KAAKmB,KAAML,IAGhDlB,EAAqBU,UAAUiB,KAAO,SAAUC,GAI5C,OAHA/B,EAASa,UAAUiB,KAAKxB,KAAKC,KAAMwB,GACnCxB,KAAKF,QAAU0B,EAAO1B,QACtBE,KAAKH,UAAY2B,EAAO3B,UACjBG,MAEXJ,EAAqBU,UAAUmB,OAAS,SAAUC,GAC9C,IAAIC,EAAO3B,KAAK4B,YAAYF,GAM5B,OALKC,KACDA,EAAO3B,KAAK6B,eAAeH,IACtB5B,QAAUE,KAAKF,QACpB6B,EAAK9B,UAAYG,KAAKH,WAEnB8B,GAEJ/B","file":"../../../nodes/utils/SpecularMIPLevelNode.js","sourcesContent":["define([\r\n    '../core/TempNode',\r\n    '../core/FunctionNode',\r\n    './MaxMIPLevelNode'\r\n], function (\r\n    TempNode, \r\n    FunctionNode, \r\n    MaxMIPLevelNode\r\n) {\r\n    'use strict';\r\n    function SpecularMIPLevelNode(roughness, texture) {\r\n        TempNode.call(this, 'f');\r\n        this.roughness = roughness;\r\n        this.texture = texture;\r\n        this.maxMIPLevel = undefined;\r\n    }\r\n    SpecularMIPLevelNode.Nodes = function () {\r\n        var getSpecularMIPLevel = new FunctionNode([\r\n            'float getSpecularMIPLevel( const in float roughness, const in float maxMIPLevelScalar ) {',\r\n            '\\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );',\r\n            '\\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );',\r\n            '\\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );',\r\n            '}'\r\n        ].join('\\n'));\r\n        return { getSpecularMIPLevel: getSpecularMIPLevel };\r\n    }();\r\n    SpecularMIPLevelNode.prototype = Object.create(TempNode.prototype);\r\n    SpecularMIPLevelNode.prototype.constructor = SpecularMIPLevelNode;\r\n    SpecularMIPLevelNode.prototype.nodeType = 'SpecularMIPLevel';\r\n    SpecularMIPLevelNode.prototype.setTexture = function (texture) {\r\n        this.texture = texture;\r\n        return this;\r\n    };\r\n    SpecularMIPLevelNode.prototype.generate = function (builder, output) {\r\n        if (builder.isShader('fragment')) {\r\n            this.maxMIPLevel = this.maxMIPLevel || new MaxMIPLevelNode();\r\n            this.maxMIPLevel.texture = this.texture;\r\n            var getSpecularMIPLevel = builder.include(SpecularMIPLevelNode.Nodes.getSpecularMIPLevel);\r\n            return builder.format(getSpecularMIPLevel + '( ' + this.roughness.build(builder, 'f') + ', ' + this.maxMIPLevel.build(builder, 'f') + ' )', this.type, output);\r\n        } else {\r\n            console.warn('THREE.SpecularMIPLevelNode is not compatible with ' + builder.shader + ' shader.');\r\n            return builder.format('0.0', this.type, output);\r\n        }\r\n    };\r\n    SpecularMIPLevelNode.prototype.copy = function (source) {\r\n        TempNode.prototype.copy.call(this, source);\r\n        this.texture = source.texture;\r\n        this.roughness = source.roughness;\r\n        return this;\r\n    };\r\n    SpecularMIPLevelNode.prototype.toJSON = function (meta) {\r\n        var data = this.getJSONNode(meta);\r\n        if (!data) {\r\n            data = this.createJSONNode(meta);\r\n            data.texture = this.texture;\r\n            data.roughness = this.roughness;\r\n        }\r\n        return data;\r\n    };\r\n    return SpecularMIPLevelNode;\r\n});"]}
{"version":3,"sources":["shaders/DigitalGlitch.js"],"names":["define","threex","DigitalGlitch","uniforms","tDiffuse","value","tDisp","byp","amount","angle","seed","seed_x","seed_y","distortion_x","distortion_y","col_s","vertexShader","join","fragmentShader","shaders"],"mappings":";;;;;;;AAAAA,QACI,aACF,SAAUC,GACR,aACA,IAAIC,GACAC,UACIC,UAAcC,MAAO,MACrBC,OAAWD,MAAO,MAClBE,KAASF,MAAO,GAChBG,QAAYH,MAAO,KACnBI,OAAWJ,MAAO,KAClBK,MAAUL,MAAO,KACjBM,QAAYN,MAAO,KACnBO,QAAYP,MAAO,KACnBQ,cAAkBR,MAAO,IACzBS,cAAkBT,MAAO,IACzBU,OAAWV,MAAO,MAEtBW,cACI,oBACA,gBACA,cACA,8EACA,KACFC,KAAK,MACPC,gBACI,mBACA,8BACA,2BACA,wBACA,uBACA,sBACA,wBACA,wBACA,8BACA,8BACA,uBACA,oBACA,uBACA,sEACA,IACA,gBACA,gBACA,oBACA,8CACA,8CACA,oDACA,kEACA,uBACA,2CACA,UACA,eACA,8BACA,UACA,QACA,kEACA,uBACA,4BACA,UACA,eACA,2CACA,UACA,QACA,sCACA,sCACA,4DACA,iDACA,yCACA,iDACA,qDACA,6EACA,yCACA,MACA,WACA,8CACA,MACA,KACFD,KAAK,OAEX,OAAQhB,EAAOkB,QAAQjB,cAAgBA","file":"../../shaders/DigitalGlitch.js","sourcesContent":["define([\r\n    \"../threex\"\r\n],function (threex) {\r\n    'use strict';\r\n    var DigitalGlitch = {\r\n        uniforms: {\r\n            'tDiffuse': { value: null },\r\n            'tDisp': { value: null },\r\n            'byp': { value: 0 },\r\n            'amount': { value: 0.08 },\r\n            'angle': { value: 0.02 },\r\n            'seed': { value: 0.02 },\r\n            'seed_x': { value: 0.02 },\r\n            'seed_y': { value: 0.02 },\r\n            'distortion_x': { value: 0.5 },\r\n            'distortion_y': { value: 0.6 },\r\n            'col_s': { value: 0.05 }\r\n        },\r\n        vertexShader: [\r\n            'varying vec2 vUv;',\r\n            'void main() {',\r\n            '\\tvUv = uv;',\r\n            '\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\r\n            '}'\r\n        ].join('\\n'),\r\n        fragmentShader: [\r\n            'uniform int byp;',\r\n            'uniform sampler2D tDiffuse;',\r\n            'uniform sampler2D tDisp;',\r\n            'uniform float amount;',\r\n            'uniform float angle;',\r\n            'uniform float seed;',\r\n            'uniform float seed_x;',\r\n            'uniform float seed_y;',\r\n            'uniform float distortion_x;',\r\n            'uniform float distortion_y;',\r\n            'uniform float col_s;',\r\n            'varying vec2 vUv;',\r\n            'float rand(vec2 co){',\r\n            '\\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);',\r\n            '}',\r\n            'void main() {',\r\n            '\\tif(byp<1) {',\r\n            '\\t\\tvec2 p = vUv;',\r\n            '\\t\\tfloat xs = floor(gl_FragCoord.x / 0.5);',\r\n            '\\t\\tfloat ys = floor(gl_FragCoord.y / 0.5);',\r\n            '\\t\\tvec4 normal = texture2D (tDisp, p*seed*seed);',\r\n            '\\t\\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {',\r\n            '\\t\\t\\tif(seed_x>0.){',\r\n            '\\t\\t\\t\\tp.y = 1. - (p.y + distortion_y);',\r\n            '\\t\\t\\t}',\r\n            '\\t\\t\\telse {',\r\n            '\\t\\t\\t\\tp.y = distortion_y;',\r\n            '\\t\\t\\t}',\r\n            '\\t\\t}',\r\n            '\\t\\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {',\r\n            '\\t\\t\\tif(seed_y>0.){',\r\n            '\\t\\t\\t\\tp.x=distortion_x;',\r\n            '\\t\\t\\t}',\r\n            '\\t\\t\\telse {',\r\n            '\\t\\t\\t\\tp.x = 1. - (p.x + distortion_x);',\r\n            '\\t\\t\\t}',\r\n            '\\t\\t}',\r\n            '\\t\\tp.x+=normal.x*seed_x*(seed/5.);',\r\n            '\\t\\tp.y+=normal.y*seed_y*(seed/5.);',\r\n            '\\t\\tvec2 offset = amount * vec2( cos(angle), sin(angle));',\r\n            '\\t\\tvec4 cr = texture2D(tDiffuse, p + offset);',\r\n            '\\t\\tvec4 cga = texture2D(tDiffuse, p);',\r\n            '\\t\\tvec4 cb = texture2D(tDiffuse, p - offset);',\r\n            '\\t\\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);',\r\n            '\\t\\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);',\r\n            '\\t\\tgl_FragColor = gl_FragColor+ snow;',\r\n            '\\t}',\r\n            '\\telse {',\r\n            '\\t\\tgl_FragColor=texture2D (tDiffuse, vUv);',\r\n            '\\t}',\r\n            '}'\r\n        ].join('\\n')\r\n    };\r\n    return  threex.shaders.DigitalGlitch = DigitalGlitch ;\r\n});"]}
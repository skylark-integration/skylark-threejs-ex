{"version":3,"sources":["shaders/ToonShader.js"],"names":["define","THREE","threex","ToonShader1","uniforms","uDirLightPos","value","Vector3","uDirLightColor","Color","uAmbientLightColor","uBaseColor","vertexShader","join","fragmentShader","ToonShader2","uLineColor1","uLineColor2","uLineColor3","uLineColor4","ToonShaderHatching","ToonShaderDotted","shaders","ToonShader"],"mappings":";;;;;;;AAAAA,QACI,kBACA,aACD,SACCC,EACAC,GAEA,aACA,IAAIC,GACAC,UACIC,cAAkBC,MAAO,IAAIL,EAAMM,SACnCC,gBAAoBF,MAAO,IAAIL,EAAMQ,MAAM,WAC3CC,oBAAwBJ,MAAO,IAAIL,EAAMQ,MAAM,SAC/CE,YAAgBL,MAAO,IAAIL,EAAMQ,MAAM,YAE3CG,cACI,wBACA,yBACA,gBACA,8DACA,+DACA,kHACA,kDACA,iDACA,6DACA,iDACA,KACFC,KAAK,MACPC,gBACI,2BACA,6BACA,+BACA,mCACA,wBACA,yBACA,gBACA,4FACA,2FACA,qFACA,+CACA,mEACA,8DACA,uCACA,8BACA,gEACA,aACA,0FACA,IACA,KACFD,KAAK,OAEPE,GACAX,UACIC,cAAkBC,MAAO,IAAIL,EAAMM,SACnCC,gBAAoBF,MAAO,IAAIL,EAAMQ,MAAM,WAC3CC,oBAAwBJ,MAAO,IAAIL,EAAMQ,MAAM,SAC/CE,YAAgBL,MAAO,IAAIL,EAAMQ,MAAM,WACvCO,aAAiBV,MAAO,IAAIL,EAAMQ,MAAM,UACxCQ,aAAiBX,MAAO,IAAIL,EAAMQ,MAAM,IACxCS,aAAiBZ,MAAO,IAAIL,EAAMQ,MAAM,IACxCU,aAAiBb,MAAO,IAAIL,EAAMQ,MAAM,KAE5CG,cACI,wBACA,gBACA,8EACA,kDACA,KACFC,KAAK,MACPC,gBACI,2BACA,4BACA,4BACA,4BACA,4BACA,6BACA,+BACA,mCACA,wBACA,gBACA,kFACA,wEACA,4CACA,wEACA,gDACA,MACA,yEACA,gDACA,MACA,KACFD,KAAK,OAEPO,GACAhB,UACIC,cAAkBC,MAAO,IAAIL,EAAMM,SACnCC,gBAAoBF,MAAO,IAAIL,EAAMQ,MAAM,WAC3CC,oBAAwBJ,MAAO,IAAIL,EAAMQ,MAAM,SAC/CE,YAAgBL,MAAO,IAAIL,EAAMQ,MAAM,WACvCO,aAAiBV,MAAO,IAAIL,EAAMQ,MAAM,IACxCQ,aAAiBX,MAAO,IAAIL,EAAMQ,MAAM,IACxCS,aAAiBZ,MAAO,IAAIL,EAAMQ,MAAM,IACxCU,aAAiBb,MAAO,IAAIL,EAAMQ,MAAM,KAE5CG,cACI,wBACA,gBACA,8EACA,kDACA,KACFC,KAAK,MACPC,gBACI,2BACA,4BACA,4BACA,4BACA,4BACA,6BACA,+BACA,mCACA,wBACA,gBACA,0FACA,2FACA,4CACA,2CACA,gEACA,iDACA,QACA,MACA,2CACA,+DACA,iDACA,QACA,MACA,2CACA,qEACA,iDACA,QACA,MACA,6CACA,qEACA,iDACA,MACA,MACA,KACFD,KAAK,OAEPQ,GACAjB,UACIC,cAAkBC,MAAO,IAAIL,EAAMM,SACnCC,gBAAoBF,MAAO,IAAIL,EAAMQ,MAAM,WAC3CC,oBAAwBJ,MAAO,IAAIL,EAAMQ,MAAM,SAC/CE,YAAgBL,MAAO,IAAIL,EAAMQ,MAAM,WACvCO,aAAiBV,MAAO,IAAIL,EAAMQ,MAAM,KAE5CG,cACI,wBACA,gBACA,8EACA,kDACA,KACFC,KAAK,MACPC,gBACI,2BACA,4BACA,4BACA,4BACA,4BACA,6BACA,+BACA,mCACA,wBACA,gBACA,wFACA,yFACA,0CACA,yCACA,gFACA,iDACA,QACA,MACA,2CACA,4FACA,iDACA,QACA,MACA,KACFD,KAAK,OAEX,OAAOX,EAAOoB,QAAQC,YAClBpB,YAAAA,EACAY,YAAAA,EACAK,mBAAAA,EACAC,iBAAAA","file":"../../shaders/ToonShader.js","sourcesContent":["define([\n    \"skylark-threejs\",\n    \"../threex\"\n], function (\n    THREE,\n    threex\n) {\n    'use strict';\n    var ToonShader1 = {\n        uniforms: {\n            'uDirLightPos': { value: new THREE.Vector3() },\n            'uDirLightColor': { value: new THREE.Color(15658734) },\n            'uAmbientLightColor': { value: new THREE.Color(328965) },\n            'uBaseColor': { value: new THREE.Color(16777215) }\n        },\n        vertexShader: [\n            'varying vec3 vNormal;',\n            'varying vec3 vRefract;',\n            'void main() {',\n            '\\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );',\n            '\\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',\n            '\\tvec3 worldNormal = normalize ( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );',\n            '\\tvNormal = normalize( normalMatrix * normal );',\n            '\\tvec3 I = worldPosition.xyz - cameraPosition;',\n            '\\tvRefract = refract( normalize( I ), worldNormal, 1.02 );',\n            '\\tgl_Position = projectionMatrix * mvPosition;',\n            '}'\n        ].join('\\n'),\n        fragmentShader: [\n            'uniform vec3 uBaseColor;',\n            'uniform vec3 uDirLightPos;',\n            'uniform vec3 uDirLightColor;',\n            'uniform vec3 uAmbientLightColor;',\n            'varying vec3 vNormal;',\n            'varying vec3 vRefract;',\n            'void main() {',\n            '\\tfloat directionalLightWeighting = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);',\n            '\\tvec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;',\n            '\\tfloat intensity = smoothstep( - 0.5, 1.0, pow( length(lightWeighting), 20.0 ) );',\n            '\\tintensity += length(lightWeighting) * 0.2;',\n            '\\tfloat cameraWeighting = dot( normalize( vNormal ), vRefract );',\n            '\\tintensity += pow( 1.0 - length( cameraWeighting ), 6.0 );',\n            '\\tintensity = intensity * 0.2 + 0.3;',\n            '\\tif ( intensity < 0.50 ) {',\n            '\\t\\tgl_FragColor = vec4( 2.0 * intensity * uBaseColor, 1.0 );',\n            '\\t} else {',\n            '\\t\\tgl_FragColor = vec4( 1.0 - 2.0 * ( 1.0 - intensity ) * ( 1.0 - uBaseColor ), 1.0 );',\n            '}',\n            '}'\n        ].join('\\n')\n    };\n    var ToonShader2 = {\n        uniforms: {\n            'uDirLightPos': { value: new THREE.Vector3() },\n            'uDirLightColor': { value: new THREE.Color(15658734) },\n            'uAmbientLightColor': { value: new THREE.Color(328965) },\n            'uBaseColor': { value: new THREE.Color(15658734) },\n            'uLineColor1': { value: new THREE.Color(8421504) },\n            'uLineColor2': { value: new THREE.Color(0) },\n            'uLineColor3': { value: new THREE.Color(0) },\n            'uLineColor4': { value: new THREE.Color(0) }\n        },\n        vertexShader: [\n            'varying vec3 vNormal;',\n            'void main() {',\n            '\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n            '\\tvNormal = normalize( normalMatrix * normal );',\n            '}'\n        ].join('\\n'),\n        fragmentShader: [\n            'uniform vec3 uBaseColor;',\n            'uniform vec3 uLineColor1;',\n            'uniform vec3 uLineColor2;',\n            'uniform vec3 uLineColor3;',\n            'uniform vec3 uLineColor4;',\n            'uniform vec3 uDirLightPos;',\n            'uniform vec3 uDirLightColor;',\n            'uniform vec3 uAmbientLightColor;',\n            'varying vec3 vNormal;',\n            'void main() {',\n            '\\tfloat camera = max( dot( normalize( vNormal ), vec3( 0.0, 0.0, 1.0 ) ), 0.4);',\n            '\\tfloat light = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);',\n            '\\tgl_FragColor = vec4( uBaseColor, 1.0 );',\n            '\\tif ( length(uAmbientLightColor + uDirLightColor * light) < 1.00 ) {',\n            '\\t\\tgl_FragColor *= vec4( uLineColor1, 1.0 );',\n            '\\t}',\n            '\\tif ( length(uAmbientLightColor + uDirLightColor * camera) < 0.50 ) {',\n            '\\t\\tgl_FragColor *= vec4( uLineColor2, 1.0 );',\n            '\\t}',\n            '}'\n        ].join('\\n')\n    };\n    var ToonShaderHatching = {\n        uniforms: {\n            'uDirLightPos': { value: new THREE.Vector3() },\n            'uDirLightColor': { value: new THREE.Color(15658734) },\n            'uAmbientLightColor': { value: new THREE.Color(328965) },\n            'uBaseColor': { value: new THREE.Color(16777215) },\n            'uLineColor1': { value: new THREE.Color(0) },\n            'uLineColor2': { value: new THREE.Color(0) },\n            'uLineColor3': { value: new THREE.Color(0) },\n            'uLineColor4': { value: new THREE.Color(0) }\n        },\n        vertexShader: [\n            'varying vec3 vNormal;',\n            'void main() {',\n            '\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n            '\\tvNormal = normalize( normalMatrix * normal );',\n            '}'\n        ].join('\\n'),\n        fragmentShader: [\n            'uniform vec3 uBaseColor;',\n            'uniform vec3 uLineColor1;',\n            'uniform vec3 uLineColor2;',\n            'uniform vec3 uLineColor3;',\n            'uniform vec3 uLineColor4;',\n            'uniform vec3 uDirLightPos;',\n            'uniform vec3 uDirLightColor;',\n            'uniform vec3 uAmbientLightColor;',\n            'varying vec3 vNormal;',\n            'void main() {',\n            '\\tfloat directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);',\n            '\\tvec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;',\n            '\\tgl_FragColor = vec4( uBaseColor, 1.0 );',\n            '\\tif ( length(lightWeighting) < 1.00 ) {',\n            '\\t\\tif ( mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {',\n            '\\t\\t\\tgl_FragColor = vec4( uLineColor1, 1.0 );',\n            '\\t\\t}',\n            '\\t}',\n            '\\tif ( length(lightWeighting) < 0.75 ) {',\n            '\\t\\tif (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {',\n            '\\t\\t\\tgl_FragColor = vec4( uLineColor2, 1.0 );',\n            '\\t\\t}',\n            '\\t}',\n            '\\tif ( length(lightWeighting) < 0.50 ) {',\n            '\\t\\tif (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {',\n            '\\t\\t\\tgl_FragColor = vec4( uLineColor3, 1.0 );',\n            '\\t\\t}',\n            '\\t}',\n            '\\tif ( length(lightWeighting) < 0.3465 ) {',\n            '\\t\\tif (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {',\n            '\\t\\t\\tgl_FragColor = vec4( uLineColor4, 1.0 );',\n            '\\t}',\n            '\\t}',\n            '}'\n        ].join('\\n')\n    };\n    var ToonShaderDotted = {\n        uniforms: {\n            'uDirLightPos': { value: new THREE.Vector3() },\n            'uDirLightColor': { value: new THREE.Color(15658734) },\n            'uAmbientLightColor': { value: new THREE.Color(328965) },\n            'uBaseColor': { value: new THREE.Color(16777215) },\n            'uLineColor1': { value: new THREE.Color(0) }\n        },\n        vertexShader: [\n            'varying vec3 vNormal;',\n            'void main() {',\n            '\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n            '\\tvNormal = normalize( normalMatrix * normal );',\n            '}'\n        ].join('\\n'),\n        fragmentShader: [\n            'uniform vec3 uBaseColor;',\n            'uniform vec3 uLineColor1;',\n            'uniform vec3 uLineColor2;',\n            'uniform vec3 uLineColor3;',\n            'uniform vec3 uLineColor4;',\n            'uniform vec3 uDirLightPos;',\n            'uniform vec3 uDirLightColor;',\n            'uniform vec3 uAmbientLightColor;',\n            'varying vec3 vNormal;',\n            'void main() {',\n            'float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);',\n            'vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;',\n            'gl_FragColor = vec4( uBaseColor, 1.0 );',\n            'if ( length(lightWeighting) < 1.00 ) {',\n            '\\t\\tif ( ( mod(gl_FragCoord.x, 4.001) + mod(gl_FragCoord.y, 4.0) ) > 6.00 ) {',\n            '\\t\\t\\tgl_FragColor = vec4( uLineColor1, 1.0 );',\n            '\\t\\t}',\n            '\\t}',\n            '\\tif ( length(lightWeighting) < 0.50 ) {',\n            '\\t\\tif ( ( mod(gl_FragCoord.x + 2.0, 4.001) + mod(gl_FragCoord.y + 2.0, 4.0) ) > 6.00 ) {',\n            '\\t\\t\\tgl_FragColor = vec4( uLineColor1, 1.0 );',\n            '\\t\\t}',\n            '\\t}',\n            '}'\n        ].join('\\n')\n    };\n    return threex.shaders.ToonShader = {\n        ToonShader1,\n        ToonShader2,\n        ToonShaderHatching,\n        ToonShaderDotted\n    };\n});"]}
{"version":3,"sources":["postprocessing/TexturePass.js"],"names":["define","THREE","threex","Pass","CopyShader","TexturePass","map","opacity","call","this","undefined","console","error","shader","uniforms","UniformsUtils","clone","material","ShaderMaterial","vertexShader","fragmentShader","depthTest","depthWrite","needsSwap","fsQuad","FullScreenQuad","prototype","Object","assign","create","constructor","render","renderer","writeBuffer","readBuffer","oldAutoClear","autoClear","value","transparent","setRenderTarget","renderToScreen","clear","postprocessing"],"mappings":";;;;;;;AAAAA,QACI,kBACA,YACA,yBACA,yBACD,SACCC,EACAC,EACAC,EACAC,GAEA,aACA,IAAIC,EAAc,SAAUC,EAAKC,GAC7BJ,EAAKK,KAAKC,WACSC,IAAfN,GACAO,QAAQC,MAAM,oCAClB,IAAIC,EAAST,EACbK,KAAKH,IAAMA,EACXG,KAAKF,aAAsBG,IAAZH,EAAwBA,EAAU,EACjDE,KAAKK,SAAWb,EAAMc,cAAcC,MAAMH,EAAOC,UACjDL,KAAKQ,SAAW,IAAIhB,EAAMiB,gBACtBJ,SAAUL,KAAKK,SACfK,aAAcN,EAAOM,aACrBC,eAAgBP,EAAOO,eACvBC,WAAW,EACXC,YAAY,IAEhBb,KAAKc,WAAY,EACjBd,KAAKe,OAAS,IAAIrB,EAAKsB,eAAe,OAkB1C,OAhBApB,EAAYqB,UAAYC,OAAOC,OAAOD,OAAOE,OAAO1B,EAAKuB,YACrDI,YAAazB,EACb0B,OAAQ,SAAUC,EAAUC,EAAaC,GACrC,IAAIC,EAAeH,EAASI,UAC5BJ,EAASI,WAAY,EACrB3B,KAAKe,OAAOP,SAAWR,KAAKQ,SAC5BR,KAAKK,SAAkB,QAAEuB,MAAQ5B,KAAKF,QACtCE,KAAKK,SAAmB,SAAEuB,MAAQ5B,KAAKH,IACvCG,KAAKQ,SAASqB,YAAc7B,KAAKF,QAAU,EAC3CyB,EAASO,gBAAgB9B,KAAK+B,eAAiB,KAAON,GAClDzB,KAAKgC,OACLT,EAASS,QACbhC,KAAKe,OAAOO,OAAOC,GACnBA,EAASI,UAAYD,KAGtBjC,EAAOwC,eAAerC,YAAcA","file":"../../postprocessing/TexturePass.js","sourcesContent":["define([\r\n    \"skylark-threejs\",\r\n    \"../threex\",\r\n    '../postprocessing/Pass',\r\n    '../shaders/CopyShader'\r\n], function (\r\n    THREE, \r\n    threex,\r\n    Pass, \r\n    CopyShader\r\n) {\r\n    'use strict';\r\n    var TexturePass = function (map, opacity) {\r\n        Pass.call(this);\r\n        if (CopyShader === undefined)\r\n            console.error('TexturePass relies on CopyShader');\r\n        var shader = CopyShader;\r\n        this.map = map;\r\n        this.opacity = opacity !== undefined ? opacity : 1;\r\n        this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);\r\n        this.material = new THREE.ShaderMaterial({\r\n            uniforms: this.uniforms,\r\n            vertexShader: shader.vertexShader,\r\n            fragmentShader: shader.fragmentShader,\r\n            depthTest: false,\r\n            depthWrite: false\r\n        });\r\n        this.needsSwap = false;\r\n        this.fsQuad = new Pass.FullScreenQuad(null);\r\n    };\r\n    TexturePass.prototype = Object.assign(Object.create(Pass.prototype), {\r\n        constructor: TexturePass,\r\n        render: function (renderer, writeBuffer, readBuffer) {\r\n            var oldAutoClear = renderer.autoClear;\r\n            renderer.autoClear = false;\r\n            this.fsQuad.material = this.material;\r\n            this.uniforms['opacity'].value = this.opacity;\r\n            this.uniforms['tDiffuse'].value = this.map;\r\n            this.material.transparent = this.opacity < 1;\r\n            renderer.setRenderTarget(this.renderToScreen ? null : readBuffer);\r\n            if (this.clear)\r\n                renderer.clear();\r\n            this.fsQuad.render(renderer);\r\n            renderer.autoClear = oldAutoClear;\r\n        }\r\n    });\r\n    return threex.postprocessing.TexturePass = TexturePass;\r\n});"]}
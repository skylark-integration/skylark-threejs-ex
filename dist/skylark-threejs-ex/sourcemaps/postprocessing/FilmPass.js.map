{"version":3,"sources":["postprocessing/FilmPass.js"],"names":["define","THREE","threex","Pass","FilmShader","FilmPass","noiseIntensity","scanlinesIntensity","scanlinesCount","grayscale","call","this","undefined","console","error","shader","uniforms","UniformsUtils","clone","material","ShaderMaterial","vertexShader","fragmentShader","value","nIntensity","sIntensity","sCount","fsQuad","FullScreenQuad","prototype","Object","assign","create","constructor","render","renderer","writeBuffer","readBuffer","deltaTime","texture","renderToScreen","setRenderTarget","clear","postprocessing"],"mappings":";;;;;;;AAAAA,QACI,kBACA,YACA,yBACA,yBACD,SACCC,EACAC,EACAC,EACAC,GAEA,aACA,IAAIC,EAAW,SAAUC,EAAgBC,EAAoBC,EAAgBC,GACzEN,EAAKO,KAAKC,WACSC,IAAfR,GACAS,QAAQC,MAAM,iCAClB,IAAIC,EAASX,EACbO,KAAKK,SAAWf,EAAMgB,cAAcC,MAAMH,EAAOC,UACjDL,KAAKQ,SAAW,IAAIlB,EAAMmB,gBACtBJ,SAAUL,KAAKK,SACfK,aAAcN,EAAOM,aACrBC,eAAgBP,EAAOO,sBAETV,IAAdH,IACAE,KAAKK,SAASP,UAAUc,MAAQd,QACbG,IAAnBN,IACAK,KAAKK,SAASQ,WAAWD,MAAQjB,QACVM,IAAvBL,IACAI,KAAKK,SAASS,WAAWF,MAAQhB,QACdK,IAAnBJ,IACAG,KAAKK,SAASU,OAAOH,MAAQf,GACjCG,KAAKgB,OAAS,IAAIxB,EAAKyB,eAAejB,KAAKQ,WAmB/C,OAjBAd,EAASwB,UAAYC,OAAOC,OAAOD,OAAOE,OAAO7B,EAAK0B,YAClDI,YAAa5B,EACb6B,OAAQ,SAAUC,EAAUC,EAAaC,EAAYC,GACjD3B,KAAKK,SAAmB,SAAEO,MAAQc,EAAWE,QAC7C5B,KAAKK,SAAe,KAAEO,OAASe,EAC3B3B,KAAK6B,gBACLL,EAASM,gBAAgB,MACzB9B,KAAKgB,OAAOO,OAAOC,KAEnBA,EAASM,gBAAgBL,GACrBzB,KAAK+B,OACLP,EAASO,QACb/B,KAAKgB,OAAOO,OAAOC,OAKxBjC,EAAOyC,eAAetC,SAAWA","file":"../../postprocessing/FilmPass.js","sourcesContent":["define([\r\n    \"skylark-threejs\",\r\n    \"../threex\",\r\n    '../postprocessing/Pass',\r\n    '../shaders/FilmShader'\r\n], function (\r\n    THREE, \r\n    threex,\r\n    Pass, \r\n    FilmShader\r\n) {\r\n    'use strict';\r\n    var FilmPass = function (noiseIntensity, scanlinesIntensity, scanlinesCount, grayscale) {\r\n        Pass.call(this);\r\n        if (FilmShader === undefined)\r\n            console.error('FilmPass relies on FilmShader');\r\n        var shader = FilmShader;\r\n        this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);\r\n        this.material = new THREE.ShaderMaterial({\r\n            uniforms: this.uniforms,\r\n            vertexShader: shader.vertexShader,\r\n            fragmentShader: shader.fragmentShader\r\n        });\r\n        if (grayscale !== undefined)\r\n            this.uniforms.grayscale.value = grayscale;\r\n        if (noiseIntensity !== undefined)\r\n            this.uniforms.nIntensity.value = noiseIntensity;\r\n        if (scanlinesIntensity !== undefined)\r\n            this.uniforms.sIntensity.value = scanlinesIntensity;\r\n        if (scanlinesCount !== undefined)\r\n            this.uniforms.sCount.value = scanlinesCount;\r\n        this.fsQuad = new Pass.FullScreenQuad(this.material);\r\n    };\r\n    FilmPass.prototype = Object.assign(Object.create(Pass.prototype), {\r\n        constructor: FilmPass,\r\n        render: function (renderer, writeBuffer, readBuffer, deltaTime) {\r\n            this.uniforms['tDiffuse'].value = readBuffer.texture;\r\n            this.uniforms['time'].value += deltaTime;\r\n            if (this.renderToScreen) {\r\n                renderer.setRenderTarget(null);\r\n                this.fsQuad.render(renderer);\r\n            } else {\r\n                renderer.setRenderTarget(writeBuffer);\r\n                if (this.clear)\r\n                    renderer.clear();\r\n                this.fsQuad.render(renderer);\r\n            }\r\n        }\r\n    });\r\n\r\n    return threex.postprocessing.FilmPass = FilmPass;\r\n});"]}
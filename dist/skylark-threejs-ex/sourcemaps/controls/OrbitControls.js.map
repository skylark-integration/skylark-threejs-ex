{"version":3,"sources":["controls/OrbitControls.js"],"names":["define","THREE","threex","OrbitControls","object","domElement","offset","quat","quatInverse","lastPosition","lastQuaternion","undefined","console","warn","document","error","this","enabled","target","Vector3","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","MOUSE","ROTATE","MIDDLE","DOLLY","PAN","touches","ONE","TOUCH","TWO","DOLLY_PAN","target0","clone","position0","position","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","scope","copy","reset","updateProjectionMatrix","dispatchEvent","changeEvent","update","state","STATE","NONE","Quaternion","setFromUnitVectors","up","inverse","sub","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","max","min","makeSafe","radius","scale","addScaledVector","panOffset","add","setFromSpherical","lookAt","multiplyScalar","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseMove","onMouseUp","onKeyDown","type","startEvent","endEvent","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","Spherical","rotateStart","Vector2","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","angle","rotateUp","v","panLeft","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","length","tan","fov","clientHeight","matrix","isOrthographicCamera","right","left","clientWidth","top","bottom","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","event","clientX","clientY","handleMouseDownPan","handleTouchStartRotate","pageX","pageY","x","y","handleTouchStartPan","handleTouchStartDolly","dx","dy","sqrt","handleTouchMoveRotate","subVectors","handleTouchMovePan","handleTouchMoveDolly","mouseAction","preventDefault","focus","window","button","handleMouseDownDolly","ctrlKey","metaKey","shiftKey","addEventListener","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","stopPropagation","handleMouseWheel","needsUpdate","keyCode","handleKeyDown","handleTouchStartDollyPan","DOLLY_ROTATE","handleTouchStartDollyRotate","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","tabIndex","prototype","Object","create","EventDispatcher","constructor","controls"],"mappings":"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","file":"../../controls/OrbitControls.js","sourcesContent":["define([\r\n    \"skylark-threejs\",\r\n    \"../threex\"\r\n], function (\r\n    THREE,\r\n    threex\r\n) {\r\n    'use strict';\r\n    var OrbitControls = function (object, domElement) {\r\n        if (domElement === undefined)\r\n            console.warn('THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.');\r\n        if (domElement === document)\r\n            console.error('THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.');\r\n        this.object = object;\r\n        this.domElement = domElement;\r\n        this.enabled = true;\r\n        this.target = new THREE.Vector3();\r\n        this.minDistance = 0;\r\n        this.maxDistance = Infinity;\r\n        this.minZoom = 0;\r\n        this.maxZoom = Infinity;\r\n        this.minPolarAngle = 0;\r\n        this.maxPolarAngle = Math.PI;\r\n        this.minAzimuthAngle = -Infinity;\r\n        this.maxAzimuthAngle = Infinity;\r\n        this.enableDamping = false;\r\n        this.dampingFactor = 0.05;\r\n        this.enableZoom = true;\r\n        this.zoomSpeed = 1;\r\n        this.enableRotate = true;\r\n        this.rotateSpeed = 1;\r\n        this.enablePan = true;\r\n        this.panSpeed = 1;\r\n        this.screenSpacePanning = false;\r\n        this.keyPanSpeed = 7;\r\n        this.autoRotate = false;\r\n        this.autoRotateSpeed = 2;\r\n        this.enableKeys = true;\r\n        this.keys = {\r\n            LEFT: 37,\r\n            UP: 38,\r\n            RIGHT: 39,\r\n            BOTTOM: 40\r\n        };\r\n        this.mouseButtons = {\r\n            LEFT: THREE.MOUSE.ROTATE,\r\n            MIDDLE: THREE.MOUSE.DOLLY,\r\n            RIGHT: THREE.MOUSE.PAN\r\n        };\r\n        this.touches = {\r\n            ONE: THREE.TOUCH.ROTATE,\r\n            TWO: THREE.TOUCH.DOLLY_PAN\r\n        };\r\n        this.target0 = this.target.clone();\r\n        this.position0 = this.object.position.clone();\r\n        this.zoom0 = this.object.zoom;\r\n        this.getPolarAngle = function () {\r\n            return spherical.phi;\r\n        };\r\n        this.getAzimuthalAngle = function () {\r\n            return spherical.theta;\r\n        };\r\n        this.saveState = function () {\r\n            scope.target0.copy(scope.target);\r\n            scope.position0.copy(scope.object.position);\r\n            scope.zoom0 = scope.object.zoom;\r\n        };\r\n        this.reset = function () {\r\n            scope.target.copy(scope.target0);\r\n            scope.object.position.copy(scope.position0);\r\n            scope.object.zoom = scope.zoom0;\r\n            scope.object.updateProjectionMatrix();\r\n            scope.dispatchEvent(changeEvent);\r\n            scope.update();\r\n            state = STATE.NONE;\r\n        };\r\n        this.update = function () {\r\n            var offset = new THREE.Vector3();\r\n            var quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));\r\n            var quatInverse = quat.clone().inverse();\r\n            var lastPosition = new THREE.Vector3();\r\n            var lastQuaternion = new THREE.Quaternion();\r\n            return function update() {\r\n                var position = scope.object.position;\r\n                offset.copy(position).sub(scope.target);\r\n                offset.applyQuaternion(quat);\r\n                spherical.setFromVector3(offset);\r\n                if (scope.autoRotate && state === STATE.NONE) {\r\n                    rotateLeft(getAutoRotationAngle());\r\n                }\r\n                if (scope.enableDamping) {\r\n                    spherical.theta += sphericalDelta.theta * scope.dampingFactor;\r\n                    spherical.phi += sphericalDelta.phi * scope.dampingFactor;\r\n                } else {\r\n                    spherical.theta += sphericalDelta.theta;\r\n                    spherical.phi += sphericalDelta.phi;\r\n                }\r\n                spherical.theta = Math.max(scope.minAzimuthAngle, Math.min(scope.maxAzimuthAngle, spherical.theta));\r\n                spherical.phi = Math.max(scope.minPolarAngle, Math.min(scope.maxPolarAngle, spherical.phi));\r\n                spherical.makeSafe();\r\n                spherical.radius *= scale;\r\n                spherical.radius = Math.max(scope.minDistance, Math.min(scope.maxDistance, spherical.radius));\r\n                if (scope.enableDamping === true) {\r\n                    scope.target.addScaledVector(panOffset, scope.dampingFactor);\r\n                } else {\r\n                    scope.target.add(panOffset);\r\n                }\r\n                offset.setFromSpherical(spherical);\r\n                offset.applyQuaternion(quatInverse);\r\n                position.copy(scope.target).add(offset);\r\n                scope.object.lookAt(scope.target);\r\n                if (scope.enableDamping === true) {\r\n                    sphericalDelta.theta *= 1 - scope.dampingFactor;\r\n                    sphericalDelta.phi *= 1 - scope.dampingFactor;\r\n                    panOffset.multiplyScalar(1 - scope.dampingFactor);\r\n                } else {\r\n                    sphericalDelta.set(0, 0, 0);\r\n                    panOffset.set(0, 0, 0);\r\n                }\r\n                scale = 1;\r\n                if (zoomChanged || lastPosition.distanceToSquared(scope.object.position) > EPS || 8 * (1 - lastQuaternion.dot(scope.object.quaternion)) > EPS) {\r\n                    scope.dispatchEvent(changeEvent);\r\n                    lastPosition.copy(scope.object.position);\r\n                    lastQuaternion.copy(scope.object.quaternion);\r\n                    zoomChanged = false;\r\n                    return true;\r\n                }\r\n                return false;\r\n            };\r\n        }();\r\n        this.dispose = function () {\r\n            scope.domElement.removeEventListener('contextmenu', onContextMenu, false);\r\n            scope.domElement.removeEventListener('mousedown', onMouseDown, false);\r\n            scope.domElement.removeEventListener('wheel', onMouseWheel, false);\r\n            scope.domElement.removeEventListener('touchstart', onTouchStart, false);\r\n            scope.domElement.removeEventListener('touchend', onTouchEnd, false);\r\n            scope.domElement.removeEventListener('touchmove', onTouchMove, false);\r\n            document.removeEventListener('mousemove', onMouseMove, false);\r\n            document.removeEventListener('mouseup', onMouseUp, false);\r\n            scope.domElement.removeEventListener('keydown', onKeyDown, false);\r\n        };\r\n        var scope = this;\r\n        var changeEvent = { type: 'change' };\r\n        var startEvent = { type: 'start' };\r\n        var endEvent = { type: 'end' };\r\n        var STATE = {\r\n            NONE: -1,\r\n            ROTATE: 0,\r\n            DOLLY: 1,\r\n            PAN: 2,\r\n            TOUCH_ROTATE: 3,\r\n            TOUCH_PAN: 4,\r\n            TOUCH_DOLLY_PAN: 5,\r\n            TOUCH_DOLLY_ROTATE: 6\r\n        };\r\n        var state = STATE.NONE;\r\n        var EPS = 0.000001;\r\n        var spherical = new THREE.Spherical();\r\n        var sphericalDelta = new THREE.Spherical();\r\n        var scale = 1;\r\n        var panOffset = new THREE.Vector3();\r\n        var zoomChanged = false;\r\n        var rotateStart = new THREE.Vector2();\r\n        var rotateEnd = new THREE.Vector2();\r\n        var rotateDelta = new THREE.Vector2();\r\n        var panStart = new THREE.Vector2();\r\n        var panEnd = new THREE.Vector2();\r\n        var panDelta = new THREE.Vector2();\r\n        var dollyStart = new THREE.Vector2();\r\n        var dollyEnd = new THREE.Vector2();\r\n        var dollyDelta = new THREE.Vector2();\r\n        function getAutoRotationAngle() {\r\n            return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\r\n        }\r\n        function getZoomScale() {\r\n            return Math.pow(0.95, scope.zoomSpeed);\r\n        }\r\n        function rotateLeft(angle) {\r\n            sphericalDelta.theta -= angle;\r\n        }\r\n        function rotateUp(angle) {\r\n            sphericalDelta.phi -= angle;\r\n        }\r\n        var panLeft = function () {\r\n            var v = new THREE.Vector3();\r\n            return function panLeft(distance, objectMatrix) {\r\n                v.setFromMatrixColumn(objectMatrix, 0);\r\n                v.multiplyScalar(-distance);\r\n                panOffset.add(v);\r\n            };\r\n        }();\r\n        var panUp = function () {\r\n            var v = new THREE.Vector3();\r\n            return function panUp(distance, objectMatrix) {\r\n                if (scope.screenSpacePanning === true) {\r\n                    v.setFromMatrixColumn(objectMatrix, 1);\r\n                } else {\r\n                    v.setFromMatrixColumn(objectMatrix, 0);\r\n                    v.crossVectors(scope.object.up, v);\r\n                }\r\n                v.multiplyScalar(distance);\r\n                panOffset.add(v);\r\n            };\r\n        }();\r\n        var pan = function () {\r\n            var offset = new THREE.Vector3();\r\n            return function pan(deltaX, deltaY) {\r\n                var element = scope.domElement;\r\n                if (scope.object.isPerspectiveCamera) {\r\n                    var position = scope.object.position;\r\n                    offset.copy(position).sub(scope.target);\r\n                    var targetDistance = offset.length();\r\n                    targetDistance *= Math.tan(scope.object.fov / 2 * Math.PI / 180);\r\n                    panLeft(2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix);\r\n                    panUp(2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix);\r\n                } else if (scope.object.isOrthographicCamera) {\r\n                    panLeft(deltaX * (scope.object.right - scope.object.left) / scope.object.zoom / element.clientWidth, scope.object.matrix);\r\n                    panUp(deltaY * (scope.object.top - scope.object.bottom) / scope.object.zoom / element.clientHeight, scope.object.matrix);\r\n                } else {\r\n                    console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.');\r\n                    scope.enablePan = false;\r\n                }\r\n            };\r\n        }();\r\n        function dollyOut(dollyScale) {\r\n            if (scope.object.isPerspectiveCamera) {\r\n                scale /= dollyScale;\r\n            } else if (scope.object.isOrthographicCamera) {\r\n                scope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom * dollyScale));\r\n                scope.object.updateProjectionMatrix();\r\n                zoomChanged = true;\r\n            } else {\r\n                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\r\n                scope.enableZoom = false;\r\n            }\r\n        }\r\n        function dollyIn(dollyScale) {\r\n            if (scope.object.isPerspectiveCamera) {\r\n                scale *= dollyScale;\r\n            } else if (scope.object.isOrthographicCamera) {\r\n                scope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom / dollyScale));\r\n                scope.object.updateProjectionMatrix();\r\n                zoomChanged = true;\r\n            } else {\r\n                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\r\n                scope.enableZoom = false;\r\n            }\r\n        }\r\n        function handleMouseDownRotate(event) {\r\n            rotateStart.set(event.clientX, event.clientY);\r\n        }\r\n        function handleMouseDownDolly(event) {\r\n            dollyStart.set(event.clientX, event.clientY);\r\n        }\r\n        function handleMouseDownPan(event) {\r\n            panStart.set(event.clientX, event.clientY);\r\n        }\r\n        function handleMouseMoveRotate(event) {\r\n            rotateEnd.set(event.clientX, event.clientY);\r\n            rotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed);\r\n            var element = scope.domElement;\r\n            rotateLeft(2 * Math.PI * rotateDelta.x / element.clientHeight);\r\n            rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight);\r\n            rotateStart.copy(rotateEnd);\r\n            scope.update();\r\n        }\r\n        function handleMouseMoveDolly(event) {\r\n            dollyEnd.set(event.clientX, event.clientY);\r\n            dollyDelta.subVectors(dollyEnd, dollyStart);\r\n            if (dollyDelta.y > 0) {\r\n                dollyOut(getZoomScale());\r\n            } else if (dollyDelta.y < 0) {\r\n                dollyIn(getZoomScale());\r\n            }\r\n            dollyStart.copy(dollyEnd);\r\n            scope.update();\r\n        }\r\n        function handleMouseMovePan(event) {\r\n            panEnd.set(event.clientX, event.clientY);\r\n            panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);\r\n            pan(panDelta.x, panDelta.y);\r\n            panStart.copy(panEnd);\r\n            scope.update();\r\n        }\r\n        function handleMouseUp() {\r\n        }\r\n        function handleMouseWheel(event) {\r\n            if (event.deltaY < 0) {\r\n                dollyIn(getZoomScale());\r\n            } else if (event.deltaY > 0) {\r\n                dollyOut(getZoomScale());\r\n            }\r\n            scope.update();\r\n        }\r\n        function handleKeyDown(event) {\r\n            var needsUpdate = false;\r\n            switch (event.keyCode) {\r\n            case scope.keys.UP:\r\n                pan(0, scope.keyPanSpeed);\r\n                needsUpdate = true;\r\n                break;\r\n            case scope.keys.BOTTOM:\r\n                pan(0, -scope.keyPanSpeed);\r\n                needsUpdate = true;\r\n                break;\r\n            case scope.keys.LEFT:\r\n                pan(scope.keyPanSpeed, 0);\r\n                needsUpdate = true;\r\n                break;\r\n            case scope.keys.RIGHT:\r\n                pan(-scope.keyPanSpeed, 0);\r\n                needsUpdate = true;\r\n                break;\r\n            }\r\n            if (needsUpdate) {\r\n                event.preventDefault();\r\n                scope.update();\r\n            }\r\n        }\r\n        function handleTouchStartRotate(event) {\r\n            if (event.touches.length == 1) {\r\n                rotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\r\n            } else {\r\n                var x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);\r\n                var y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);\r\n                rotateStart.set(x, y);\r\n            }\r\n        }\r\n        function handleTouchStartPan(event) {\r\n            if (event.touches.length == 1) {\r\n                panStart.set(event.touches[0].pageX, event.touches[0].pageY);\r\n            } else {\r\n                var x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);\r\n                var y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);\r\n                panStart.set(x, y);\r\n            }\r\n        }\r\n        function handleTouchStartDolly(event) {\r\n            var dx = event.touches[0].pageX - event.touches[1].pageX;\r\n            var dy = event.touches[0].pageY - event.touches[1].pageY;\r\n            var distance = Math.sqrt(dx * dx + dy * dy);\r\n            dollyStart.set(0, distance);\r\n        }\r\n        function handleTouchStartDollyPan(event) {\r\n            if (scope.enableZoom)\r\n                handleTouchStartDolly(event);\r\n            if (scope.enablePan)\r\n                handleTouchStartPan(event);\r\n        }\r\n        function handleTouchStartDollyRotate(event) {\r\n            if (scope.enableZoom)\r\n                handleTouchStartDolly(event);\r\n            if (scope.enableRotate)\r\n                handleTouchStartRotate(event);\r\n        }\r\n        function handleTouchMoveRotate(event) {\r\n            if (event.touches.length == 1) {\r\n                rotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\r\n            } else {\r\n                var x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);\r\n                var y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);\r\n                rotateEnd.set(x, y);\r\n            }\r\n            rotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed);\r\n            var element = scope.domElement;\r\n            rotateLeft(2 * Math.PI * rotateDelta.x / element.clientHeight);\r\n            rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight);\r\n            rotateStart.copy(rotateEnd);\r\n        }\r\n        function handleTouchMovePan(event) {\r\n            if (event.touches.length == 1) {\r\n                panEnd.set(event.touches[0].pageX, event.touches[0].pageY);\r\n            } else {\r\n                var x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);\r\n                var y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);\r\n                panEnd.set(x, y);\r\n            }\r\n            panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);\r\n            pan(panDelta.x, panDelta.y);\r\n            panStart.copy(panEnd);\r\n        }\r\n        function handleTouchMoveDolly(event) {\r\n            var dx = event.touches[0].pageX - event.touches[1].pageX;\r\n            var dy = event.touches[0].pageY - event.touches[1].pageY;\r\n            var distance = Math.sqrt(dx * dx + dy * dy);\r\n            dollyEnd.set(0, distance);\r\n            dollyDelta.set(0, Math.pow(dollyEnd.y / dollyStart.y, scope.zoomSpeed));\r\n            dollyOut(dollyDelta.y);\r\n            dollyStart.copy(dollyEnd);\r\n        }\r\n        function handleTouchMoveDollyPan(event) {\r\n            if (scope.enableZoom)\r\n                handleTouchMoveDolly(event);\r\n            if (scope.enablePan)\r\n                handleTouchMovePan(event);\r\n        }\r\n        function handleTouchMoveDollyRotate(event) {\r\n            if (scope.enableZoom)\r\n                handleTouchMoveDolly(event);\r\n            if (scope.enableRotate)\r\n                handleTouchMoveRotate(event);\r\n        }\r\n        function handleTouchEnd() {\r\n        }\r\n        function onMouseDown(event) {\r\n            if (scope.enabled === false)\r\n                return;\r\n            event.preventDefault();\r\n            scope.domElement.focus ? scope.domElement.focus() : window.focus();\r\n            var mouseAction;\r\n            switch (event.button) {\r\n            case 0:\r\n                mouseAction = scope.mouseButtons.LEFT;\r\n                break;\r\n            case 1:\r\n                mouseAction = scope.mouseButtons.MIDDLE;\r\n                break;\r\n            case 2:\r\n                mouseAction = scope.mouseButtons.RIGHT;\r\n                break;\r\n            default:\r\n                mouseAction = -1;\r\n            }\r\n            switch (mouseAction) {\r\n            case THREE.MOUSE.DOLLY:\r\n                if (scope.enableZoom === false)\r\n                    return;\r\n                handleMouseDownDolly(event);\r\n                state = STATE.DOLLY;\r\n                break;\r\n            case THREE.MOUSE.ROTATE:\r\n                if (event.ctrlKey || event.metaKey || event.shiftKey) {\r\n                    if (scope.enablePan === false)\r\n                        return;\r\n                    handleMouseDownPan(event);\r\n                    state = STATE.PAN;\r\n                } else {\r\n                    if (scope.enableRotate === false)\r\n                        return;\r\n                    handleMouseDownRotate(event);\r\n                    state = STATE.ROTATE;\r\n                }\r\n                break;\r\n            case THREE.MOUSE.PAN:\r\n                if (event.ctrlKey || event.metaKey || event.shiftKey) {\r\n                    if (scope.enableRotate === false)\r\n                        return;\r\n                    handleMouseDownRotate(event);\r\n                    state = STATE.ROTATE;\r\n                } else {\r\n                    if (scope.enablePan === false)\r\n                        return;\r\n                    handleMouseDownPan(event);\r\n                    state = STATE.PAN;\r\n                }\r\n                break;\r\n            default:\r\n                state = STATE.NONE;\r\n            }\r\n            if (state !== STATE.NONE) {\r\n                document.addEventListener('mousemove', onMouseMove, false);\r\n                document.addEventListener('mouseup', onMouseUp, false);\r\n                scope.dispatchEvent(startEvent);\r\n            }\r\n        }\r\n        function onMouseMove(event) {\r\n            if (scope.enabled === false)\r\n                return;\r\n            event.preventDefault();\r\n            switch (state) {\r\n            case STATE.ROTATE:\r\n                if (scope.enableRotate === false)\r\n                    return;\r\n                handleMouseMoveRotate(event);\r\n                break;\r\n            case STATE.DOLLY:\r\n                if (scope.enableZoom === false)\r\n                    return;\r\n                handleMouseMoveDolly(event);\r\n                break;\r\n            case STATE.PAN:\r\n                if (scope.enablePan === false)\r\n                    return;\r\n                handleMouseMovePan(event);\r\n                break;\r\n            }\r\n        }\r\n        function onMouseUp(event) {\r\n            if (scope.enabled === false)\r\n                return;\r\n            handleMouseUp(event);\r\n            document.removeEventListener('mousemove', onMouseMove, false);\r\n            document.removeEventListener('mouseup', onMouseUp, false);\r\n            scope.dispatchEvent(endEvent);\r\n            state = STATE.NONE;\r\n        }\r\n        function onMouseWheel(event) {\r\n            if (scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE && state !== STATE.ROTATE)\r\n                return;\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            scope.dispatchEvent(startEvent);\r\n            handleMouseWheel(event);\r\n            scope.dispatchEvent(endEvent);\r\n        }\r\n        function onKeyDown(event) {\r\n            if (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false)\r\n                return;\r\n            handleKeyDown(event);\r\n        }\r\n        function onTouchStart(event) {\r\n            if (scope.enabled === false)\r\n                return;\r\n            event.preventDefault();\r\n            switch (event.touches.length) {\r\n            case 1:\r\n                switch (scope.touches.ONE) {\r\n                case THREE.TOUCH.ROTATE:\r\n                    if (scope.enableRotate === false)\r\n                        return;\r\n                    handleTouchStartRotate(event);\r\n                    state = STATE.TOUCH_ROTATE;\r\n                    break;\r\n                case THREE.TOUCH.PAN:\r\n                    if (scope.enablePan === false)\r\n                        return;\r\n                    handleTouchStartPan(event);\r\n                    state = STATE.TOUCH_PAN;\r\n                    break;\r\n                default:\r\n                    state = STATE.NONE;\r\n                }\r\n                break;\r\n            case 2:\r\n                switch (scope.touches.TWO) {\r\n                case THREE.TOUCH.DOLLY_PAN:\r\n                    if (scope.enableZoom === false && scope.enablePan === false)\r\n                        return;\r\n                    handleTouchStartDollyPan(event);\r\n                    state = STATE.TOUCH_DOLLY_PAN;\r\n                    break;\r\n                case THREE.TOUCH.DOLLY_ROTATE:\r\n                    if (scope.enableZoom === false && scope.enableRotate === false)\r\n                        return;\r\n                    handleTouchStartDollyRotate(event);\r\n                    state = STATE.TOUCH_DOLLY_ROTATE;\r\n                    break;\r\n                default:\r\n                    state = STATE.NONE;\r\n                }\r\n                break;\r\n            default:\r\n                state = STATE.NONE;\r\n            }\r\n            if (state !== STATE.NONE) {\r\n                scope.dispatchEvent(startEvent);\r\n            }\r\n        }\r\n        function onTouchMove(event) {\r\n            if (scope.enabled === false)\r\n                return;\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            switch (state) {\r\n            case STATE.TOUCH_ROTATE:\r\n                if (scope.enableRotate === false)\r\n                    return;\r\n                handleTouchMoveRotate(event);\r\n                scope.update();\r\n                break;\r\n            case STATE.TOUCH_PAN:\r\n                if (scope.enablePan === false)\r\n                    return;\r\n                handleTouchMovePan(event);\r\n                scope.update();\r\n                break;\r\n            case STATE.TOUCH_DOLLY_PAN:\r\n                if (scope.enableZoom === false && scope.enablePan === false)\r\n                    return;\r\n                handleTouchMoveDollyPan(event);\r\n                scope.update();\r\n                break;\r\n            case STATE.TOUCH_DOLLY_ROTATE:\r\n                if (scope.enableZoom === false && scope.enableRotate === false)\r\n                    return;\r\n                handleTouchMoveDollyRotate(event);\r\n                scope.update();\r\n                break;\r\n            default:\r\n                state = STATE.NONE;\r\n            }\r\n        }\r\n        function onTouchEnd(event) {\r\n            if (scope.enabled === false)\r\n                return;\r\n            handleTouchEnd(event);\r\n            scope.dispatchEvent(endEvent);\r\n            state = STATE.NONE;\r\n        }\r\n        function onContextMenu(event) {\r\n            if (scope.enabled === false)\r\n                return;\r\n            event.preventDefault();\r\n        }\r\n        scope.domElement.addEventListener('contextmenu', onContextMenu, false);\r\n        scope.domElement.addEventListener('mousedown', onMouseDown, false);\r\n        scope.domElement.addEventListener('wheel', onMouseWheel, false);\r\n        scope.domElement.addEventListener('touchstart', onTouchStart, false);\r\n        scope.domElement.addEventListener('touchend', onTouchEnd, false);\r\n        scope.domElement.addEventListener('touchmove', onTouchMove, false);\r\n        scope.domElement.addEventListener('keydown', onKeyDown, false);\r\n        if (scope.domElement.tabIndex === -1) {\r\n            scope.domElement.tabIndex = 0;\r\n        }\r\n        this.update();\r\n    };\r\n    OrbitControls.prototype = Object.create(THREE.EventDispatcher.prototype);\r\n    OrbitControls.prototype.constructor = OrbitControls;\r\n\r\n    \r\n    return   threex.controls.OrbitControls = OrbitControls;\r\n});"]}
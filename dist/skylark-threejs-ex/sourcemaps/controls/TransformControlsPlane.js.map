{"version":3,"sources":["controls/TransformControlsPlane.js"],"names":["define","THREE","threex","TransformControlsPlane","Mesh","call","this","PlaneBufferGeometry","MeshBasicMaterial","visible","wireframe","side","DoubleSide","transparent","opacity","type","unitX","Vector3","unitY","unitZ","tempVector","dirVector","alignVector","tempMatrix","Matrix4","identityQuaternion","Quaternion","updateMatrixWorld","space","position","copy","worldPosition","mode","set","applyQuaternion","worldQuaternion","axis","eye","cross","length","quaternion","cameraQuaternion","lookAt","setFromRotationMatrix","Object3D","prototype","Object","assign","create","constructor","isTransformControlsPlane","controls"],"mappings":";;;;;;;AAAAA,QACI,kBACA,aACD,SACCC,EACAC,GAEA,aAEA,IAAIC,EAAyB,WAEzBF,EAAMG,KAAKC,KAAKC,KAAM,IAAIL,EAAMM,oBAAoB,IAAQ,IAAQ,EAAG,GAAI,IAAIN,EAAMO,mBACjFC,SAAS,EACTC,WAAW,EACXC,KAAMV,EAAMW,WACZC,aAAa,EACbC,QAAS,MAEbR,KAAKS,KAAO,yBACZ,IAAIC,EAAQ,IAAIf,EAAMgB,QAAQ,EAAG,EAAG,GAChCC,EAAQ,IAAIjB,EAAMgB,QAAQ,EAAG,EAAG,GAChCE,EAAQ,IAAIlB,EAAMgB,QAAQ,EAAG,EAAG,GAChCG,EAAa,IAAInB,EAAMgB,QACvBI,EAAY,IAAIpB,EAAMgB,QACtBK,EAAc,IAAIrB,EAAMgB,QACxBM,EAAa,IAAItB,EAAMuB,QACvBC,EAAqB,IAAIxB,EAAMyB,WACnCpB,KAAKqB,kBAAoB,WACrB,IAAIC,EAAQtB,KAAKsB,MAQjB,OAPAtB,KAAKuB,SAASC,KAAKxB,KAAKyB,eACN,UAAdzB,KAAK0B,OACLJ,EAAQ,SACZZ,EAAMiB,IAAI,EAAG,EAAG,GAAGC,gBAA0B,UAAVN,EAAoBtB,KAAK6B,gBAAkBV,GAC9EP,EAAMe,IAAI,EAAG,EAAG,GAAGC,gBAA0B,UAAVN,EAAoBtB,KAAK6B,gBAAkBV,GAC9EN,EAAMc,IAAI,EAAG,EAAG,GAAGC,gBAA0B,UAAVN,EAAoBtB,KAAK6B,gBAAkBV,GAC9EH,EAAYQ,KAAKZ,GACTZ,KAAK0B,MACb,IAAK,YACL,IAAK,QACD,OAAQ1B,KAAK8B,MACb,IAAK,IACDd,EAAYQ,KAAKxB,KAAK+B,KAAKC,MAAMtB,GACjCK,EAAUS,KAAKd,GAAOsB,MAAMhB,GAC5B,MACJ,IAAK,IACDA,EAAYQ,KAAKxB,KAAK+B,KAAKC,MAAMpB,GACjCG,EAAUS,KAAKZ,GAAOoB,MAAMhB,GAC5B,MACJ,IAAK,IACDA,EAAYQ,KAAKxB,KAAK+B,KAAKC,MAAMnB,GACjCE,EAAUS,KAAKX,GAAOmB,MAAMhB,GAC5B,MACJ,IAAK,KACDD,EAAUS,KAAKX,GACf,MACJ,IAAK,KACDE,EAAUS,KAAKd,GACf,MACJ,IAAK,KACDM,EAAYQ,KAAKX,GACjBE,EAAUS,KAAKZ,GACf,MACJ,IAAK,MACL,IAAK,IACDG,EAAUY,IAAI,EAAG,EAAG,GAGxB,MACJ,IAAK,SACL,QACIZ,EAAUY,IAAI,EAAG,EAAG,GAEG,IAAvBZ,EAAUkB,SACVjC,KAAKkC,WAAWV,KAAKxB,KAAKmC,mBAE1BlB,EAAWmB,OAAOtB,EAAWa,IAAI,EAAG,EAAG,GAAIZ,EAAWC,GACtDhB,KAAKkC,WAAWG,sBAAsBpB,IAE1CtB,EAAM2C,SAASC,UAAUlB,kBAAkBtB,KAAKC,QAQxD,OALAH,EAAuB0C,UAAYC,OAAOC,OAAOD,OAAOE,OAAO/C,EAAMG,KAAKyC,YACtEI,YAAa9C,EACb+C,0BAA0B,IAGtBhD,EAAOiD,SAAShD,uBAAyBA","file":"../../controls/TransformControlsPlane.js","sourcesContent":["define([\n    \"skylark-threejs\",\n    \"../threex\"\n], function (\n    THREE,\n    threex\n) {\n    'use strict';\n\n    var TransformControlsPlane = function () {\n        'use strict';\n        THREE.Mesh.call(this, new THREE.PlaneBufferGeometry(100000, 100000, 2, 2), new THREE.MeshBasicMaterial({\n            visible: false,\n            wireframe: true,\n            side: THREE.DoubleSide,\n            transparent: true,\n            opacity: 0.1\n        }));\n        this.type = 'TransformControlsPlane';\n        var unitX = new THREE.Vector3(1, 0, 0);\n        var unitY = new THREE.Vector3(0, 1, 0);\n        var unitZ = new THREE.Vector3(0, 0, 1);\n        var tempVector = new THREE.Vector3();\n        var dirVector = new THREE.Vector3();\n        var alignVector = new THREE.Vector3();\n        var tempMatrix = new THREE.Matrix4();\n        var identityQuaternion = new THREE.Quaternion();\n        this.updateMatrixWorld = function () {\n            var space = this.space;\n            this.position.copy(this.worldPosition);\n            if (this.mode === 'scale')\n                space = 'local';\n            unitX.set(1, 0, 0).applyQuaternion(space === 'local' ? this.worldQuaternion : identityQuaternion);\n            unitY.set(0, 1, 0).applyQuaternion(space === 'local' ? this.worldQuaternion : identityQuaternion);\n            unitZ.set(0, 0, 1).applyQuaternion(space === 'local' ? this.worldQuaternion : identityQuaternion);\n            alignVector.copy(unitY);\n            switch (this.mode) {\n            case 'translate':\n            case 'scale':\n                switch (this.axis) {\n                case 'X':\n                    alignVector.copy(this.eye).cross(unitX);\n                    dirVector.copy(unitX).cross(alignVector);\n                    break;\n                case 'Y':\n                    alignVector.copy(this.eye).cross(unitY);\n                    dirVector.copy(unitY).cross(alignVector);\n                    break;\n                case 'Z':\n                    alignVector.copy(this.eye).cross(unitZ);\n                    dirVector.copy(unitZ).cross(alignVector);\n                    break;\n                case 'XY':\n                    dirVector.copy(unitZ);\n                    break;\n                case 'YZ':\n                    dirVector.copy(unitX);\n                    break;\n                case 'XZ':\n                    alignVector.copy(unitZ);\n                    dirVector.copy(unitY);\n                    break;\n                case 'XYZ':\n                case 'E':\n                    dirVector.set(0, 0, 0);\n                    break;\n                }\n                break;\n            case 'rotate':\n            default:\n                dirVector.set(0, 0, 0);\n            }\n            if (dirVector.length() === 0) {\n                this.quaternion.copy(this.cameraQuaternion);\n            } else {\n                tempMatrix.lookAt(tempVector.set(0, 0, 0), dirVector, alignVector);\n                this.quaternion.setFromRotationMatrix(tempMatrix);\n            }\n            THREE.Object3D.prototype.updateMatrixWorld.call(this);\n        };\n    };\n    TransformControlsPlane.prototype = Object.assign(Object.create(THREE.Mesh.prototype), {\n        constructor: TransformControlsPlane,\n        isTransformControlsPlane: true\n    });\n    \n    return  threex.controls.TransformControlsPlane = TransformControlsPlane;\n});"]}
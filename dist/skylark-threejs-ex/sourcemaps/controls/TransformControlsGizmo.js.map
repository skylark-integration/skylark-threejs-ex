{"version":3,"sources":["controls/TransformControlsGizmo.js"],"names":["define","THREE","threex","TransformControlsGizmo","Object3D","call","this","type","gizmoMaterial","MeshBasicMaterial","depthTest","depthWrite","transparent","side","DoubleSide","fog","gizmoLineMaterial","LineBasicMaterial","linewidth","matInvisible","clone","opacity","matHelper","matRed","color","set","matGreen","matBlue","matWhiteTransparent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","CylinderBufferGeometry","scaleHandleGeometry","BoxBufferGeometry","lineGeometry","BufferGeometry","setAttribute","Float32BufferAttribute","geometry","CircleGeometry","radius","arc","vertices","i","push","Math","cos","PI","sin","gizmoTranslate","X","Mesh","Line","Y","Z","XYZ","OctahedronBufferGeometry","XY","PlaneBufferGeometry","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","TorusBufferGeometry","SphereBufferGeometry","gizmoScale","XYZX","XYZY","XYZZ","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","name","length","object","position","rotation","scale","tag","updateMatrix","tempGeometry","applyMatrix4","matrix","renderOrder","Infinity","add","tempVector","Vector3","tempEuler","Euler","alignVector","zeroVector","lookAtMatrix","Matrix4","tempQuaternion","Quaternion","tempQuaternion2","identityQuaternion","unitX","unitY","unitZ","picker","helper","visible","updateMatrixWorld","space","mode","quaternion","worldQuaternion","handles","concat","children","handle","copy","worldPosition","eyeDistance","distanceTo","cameraPosition","multiplyScalar","size","abs","applyQuaternion","dot","eye","search","x","y","z","inverse","setFromRotationMatrix","lookAt","setFromAxisAngle","atan2","multiplyQuaternions","indexOf","showX","showY","showZ","material","_opacity","_color","enabled","axis","lerp","Color","split","some","worldPositionStart","setFromEuler","multiply","rotationAxis","dragging","worldQuaternionStart","sub","prototype","Object","assign","create","constructor","isTransformControlsGizmo","controls"],"mappings":"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","file":"../../controls/TransformControlsGizmo.js","sourcesContent":["define([\r\n    \"skylark-threejs\",\r\n    \"../threex\"\r\n], function (\r\n    THREE,\r\n    threex\r\n) {\r\n    'use strict';\r\n    var TransformControlsGizmo = function () {\r\n        'use strict';\r\n        THREE.Object3D.call(this);\r\n        this.type = 'TransformControlsGizmo';\r\n        var gizmoMaterial = new THREE.MeshBasicMaterial({\r\n            depthTest: false,\r\n            depthWrite: false,\r\n            transparent: true,\r\n            side: THREE.DoubleSide,\r\n            fog: false\r\n        });\r\n        var gizmoLineMaterial = new THREE.LineBasicMaterial({\r\n            depthTest: false,\r\n            depthWrite: false,\r\n            transparent: true,\r\n            linewidth: 1,\r\n            fog: false\r\n        });\r\n        var matInvisible = gizmoMaterial.clone();\r\n        matInvisible.opacity = 0.15;\r\n        var matHelper = gizmoMaterial.clone();\r\n        matHelper.opacity = 0.33;\r\n        var matRed = gizmoMaterial.clone();\r\n        matRed.color.set(16711680);\r\n        var matGreen = gizmoMaterial.clone();\r\n        matGreen.color.set(65280);\r\n        var matBlue = gizmoMaterial.clone();\r\n        matBlue.color.set(255);\r\n        var matWhiteTransparent = gizmoMaterial.clone();\r\n        matWhiteTransparent.opacity = 0.25;\r\n        var matYellowTransparent = matWhiteTransparent.clone();\r\n        matYellowTransparent.color.set(16776960);\r\n        var matCyanTransparent = matWhiteTransparent.clone();\r\n        matCyanTransparent.color.set(65535);\r\n        var matMagentaTransparent = matWhiteTransparent.clone();\r\n        matMagentaTransparent.color.set(16711935);\r\n        var matYellow = gizmoMaterial.clone();\r\n        matYellow.color.set(16776960);\r\n        var matLineRed = gizmoLineMaterial.clone();\r\n        matLineRed.color.set(16711680);\r\n        var matLineGreen = gizmoLineMaterial.clone();\r\n        matLineGreen.color.set(65280);\r\n        var matLineBlue = gizmoLineMaterial.clone();\r\n        matLineBlue.color.set(255);\r\n        var matLineCyan = gizmoLineMaterial.clone();\r\n        matLineCyan.color.set(65535);\r\n        var matLineMagenta = gizmoLineMaterial.clone();\r\n        matLineMagenta.color.set(16711935);\r\n        var matLineYellow = gizmoLineMaterial.clone();\r\n        matLineYellow.color.set(16776960);\r\n        var matLineGray = gizmoLineMaterial.clone();\r\n        matLineGray.color.set(7895160);\r\n        var matLineYellowTransparent = matLineYellow.clone();\r\n        matLineYellowTransparent.opacity = 0.25;\r\n        var arrowGeometry = new THREE.CylinderBufferGeometry(0, 0.05, 0.2, 12, 1, false);\r\n        var scaleHandleGeometry = new THREE.BoxBufferGeometry(0.125, 0.125, 0.125);\r\n        var lineGeometry = new THREE.BufferGeometry();\r\n        lineGeometry.setAttribute('position', new THREE.Float32BufferAttribute([\r\n            0,\r\n            0,\r\n            0,\r\n            1,\r\n            0,\r\n            0\r\n        ], 3));\r\n        var CircleGeometry = function (radius, arc) {\r\n            var geometry = new THREE.BufferGeometry();\r\n            var vertices = [];\r\n            for (var i = 0; i <= 64 * arc; ++i) {\r\n                vertices.push(0, Math.cos(i / 32 * Math.PI) * radius, Math.sin(i / 32 * Math.PI) * radius);\r\n            }\r\n            geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));\r\n            return geometry;\r\n        };\r\n        var TranslateHelperGeometry = function () {\r\n            var geometry = new THREE.BufferGeometry();\r\n            geometry.setAttribute('position', new THREE.Float32BufferAttribute([\r\n                0,\r\n                0,\r\n                0,\r\n                1,\r\n                1,\r\n                1\r\n            ], 3));\r\n            return geometry;\r\n        };\r\n        var gizmoTranslate = {\r\n            X: [\r\n                [\r\n                    new THREE.Mesh(arrowGeometry, matRed),\r\n                    [\r\n                        1,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        -Math.PI / 2\r\n                    ],\r\n                    null,\r\n                    'fwd'\r\n                ],\r\n                [\r\n                    new THREE.Mesh(arrowGeometry, matRed),\r\n                    [\r\n                        1,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ],\r\n                    null,\r\n                    'bwd'\r\n                ],\r\n                [new THREE.Line(lineGeometry, matLineRed)]\r\n            ],\r\n            Y: [\r\n                [\r\n                    new THREE.Mesh(arrowGeometry, matGreen),\r\n                    [\r\n                        0,\r\n                        1,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    null,\r\n                    'fwd'\r\n                ],\r\n                [\r\n                    new THREE.Mesh(arrowGeometry, matGreen),\r\n                    [\r\n                        0,\r\n                        1,\r\n                        0\r\n                    ],\r\n                    [\r\n                        Math.PI,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    'bwd'\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineGreen),\r\n                    null,\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ]\r\n                ]\r\n            ],\r\n            Z: [\r\n                [\r\n                    new THREE.Mesh(arrowGeometry, matBlue),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        1\r\n                    ],\r\n                    [\r\n                        Math.PI / 2,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    'fwd'\r\n                ],\r\n                [\r\n                    new THREE.Mesh(arrowGeometry, matBlue),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        1\r\n                    ],\r\n                    [\r\n                        -Math.PI / 2,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    'bwd'\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineBlue),\r\n                    null,\r\n                    [\r\n                        0,\r\n                        -Math.PI / 2,\r\n                        0\r\n                    ]\r\n                ]\r\n            ],\r\n            XYZ: [[\r\n                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.1, 0), matWhiteTransparent.clone()),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0\r\n                    ]\r\n                ]],\r\n            XY: [\r\n                [\r\n                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.295, 0.295), matYellowTransparent.clone()),\r\n                    [\r\n                        0.15,\r\n                        0.15,\r\n                        0\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineYellow),\r\n                    [\r\n                        0.18,\r\n                        0.3,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineYellow),\r\n                    [\r\n                        0.3,\r\n                        0.18,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ],\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            YZ: [\r\n                [\r\n                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.295, 0.295), matCyanTransparent.clone()),\r\n                    [\r\n                        0,\r\n                        0.15,\r\n                        0.15\r\n                    ],\r\n                    [\r\n                        0,\r\n                        Math.PI / 2,\r\n                        0\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineCyan),\r\n                    [\r\n                        0,\r\n                        0.18,\r\n                        0.3\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ],\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineCyan),\r\n                    [\r\n                        0,\r\n                        0.3,\r\n                        0.18\r\n                    ],\r\n                    [\r\n                        0,\r\n                        -Math.PI / 2,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            XZ: [\r\n                [\r\n                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.295, 0.295), matMagentaTransparent.clone()),\r\n                    [\r\n                        0.15,\r\n                        0,\r\n                        0.15\r\n                    ],\r\n                    [\r\n                        -Math.PI / 2,\r\n                        0,\r\n                        0\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineMagenta),\r\n                    [\r\n                        0.18,\r\n                        0,\r\n                        0.3\r\n                    ],\r\n                    null,\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineMagenta),\r\n                    [\r\n                        0.3,\r\n                        0,\r\n                        0.18\r\n                    ],\r\n                    [\r\n                        0,\r\n                        -Math.PI / 2,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ]\r\n        };\r\n        var pickerTranslate = {\r\n            X: [[\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 1, 4, 1, false), matInvisible),\r\n                    [\r\n                        0.6,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        -Math.PI / 2\r\n                    ]\r\n                ]],\r\n            Y: [[\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 1, 4, 1, false), matInvisible),\r\n                    [\r\n                        0,\r\n                        0.6,\r\n                        0\r\n                    ]\r\n                ]],\r\n            Z: [[\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 1, 4, 1, false), matInvisible),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0.6\r\n                    ],\r\n                    [\r\n                        Math.PI / 2,\r\n                        0,\r\n                        0\r\n                    ]\r\n                ]],\r\n            XYZ: [[new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.2, 0), matInvisible)]],\r\n            XY: [[\r\n                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.4, 0.4), matInvisible),\r\n                    [\r\n                        0.2,\r\n                        0.2,\r\n                        0\r\n                    ]\r\n                ]],\r\n            YZ: [[\r\n                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.4, 0.4), matInvisible),\r\n                    [\r\n                        0,\r\n                        0.2,\r\n                        0.2\r\n                    ],\r\n                    [\r\n                        0,\r\n                        Math.PI / 2,\r\n                        0\r\n                    ]\r\n                ]],\r\n            XZ: [[\r\n                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.4, 0.4), matInvisible),\r\n                    [\r\n                        0.2,\r\n                        0,\r\n                        0.2\r\n                    ],\r\n                    [\r\n                        -Math.PI / 2,\r\n                        0,\r\n                        0\r\n                    ]\r\n                ]]\r\n        };\r\n        var helperTranslate = {\r\n            START: [[\r\n                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.01, 2), matHelper),\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    'helper'\r\n                ]],\r\n            END: [[\r\n                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.01, 2), matHelper),\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    'helper'\r\n                ]],\r\n            DELTA: [[\r\n                    new THREE.Line(TranslateHelperGeometry(), matHelper),\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    'helper'\r\n                ]],\r\n            X: [[\r\n                    new THREE.Line(lineGeometry, matHelper.clone()),\r\n                    [\r\n                        -1000,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    [\r\n                        1000000,\r\n                        1,\r\n                        1\r\n                    ],\r\n                    'helper'\r\n                ]],\r\n            Y: [[\r\n                    new THREE.Line(lineGeometry, matHelper.clone()),\r\n                    [\r\n                        0,\r\n                        -1000,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ],\r\n                    [\r\n                        1000000,\r\n                        1,\r\n                        1\r\n                    ],\r\n                    'helper'\r\n                ]],\r\n            Z: [[\r\n                    new THREE.Line(lineGeometry, matHelper.clone()),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        -1000\r\n                    ],\r\n                    [\r\n                        0,\r\n                        -Math.PI / 2,\r\n                        0\r\n                    ],\r\n                    [\r\n                        1000000,\r\n                        1,\r\n                        1\r\n                    ],\r\n                    'helper'\r\n                ]]\r\n        };\r\n        var gizmoRotate = {\r\n            X: [\r\n                [new THREE.Line(CircleGeometry(1, 0.5), matLineRed)],\r\n                [\r\n                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.04, 0), matRed),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0.99\r\n                    ],\r\n                    null,\r\n                    [\r\n                        1,\r\n                        3,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            Y: [\r\n                [\r\n                    new THREE.Line(CircleGeometry(1, 0.5), matLineGreen),\r\n                    null,\r\n                    [\r\n                        0,\r\n                        0,\r\n                        -Math.PI / 2\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.04, 0), matGreen),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0.99\r\n                    ],\r\n                    null,\r\n                    [\r\n                        3,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            Z: [\r\n                [\r\n                    new THREE.Line(CircleGeometry(1, 0.5), matLineBlue),\r\n                    null,\r\n                    [\r\n                        0,\r\n                        Math.PI / 2,\r\n                        0\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.04, 0), matBlue),\r\n                    [\r\n                        0.99,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    [\r\n                        1,\r\n                        3,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            E: [\r\n                [\r\n                    new THREE.Line(CircleGeometry(1.25, 1), matLineYellowTransparent),\r\n                    null,\r\n                    [\r\n                        0,\r\n                        Math.PI / 2,\r\n                        0\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),\r\n                    [\r\n                        1.17,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        -Math.PI / 2\r\n                    ],\r\n                    [\r\n                        1,\r\n                        1,\r\n                        0.001\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),\r\n                    [\r\n                        -1.17,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ],\r\n                    [\r\n                        1,\r\n                        1,\r\n                        0.001\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),\r\n                    [\r\n                        0,\r\n                        -1.17,\r\n                        0\r\n                    ],\r\n                    [\r\n                        Math.PI,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        1,\r\n                        1,\r\n                        0.001\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),\r\n                    [\r\n                        0,\r\n                        1.17,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        1,\r\n                        1,\r\n                        0.001\r\n                    ]\r\n                ]\r\n            ],\r\n            XYZE: [[\r\n                    new THREE.Line(CircleGeometry(1, 1), matLineGray),\r\n                    null,\r\n                    [\r\n                        0,\r\n                        Math.PI / 2,\r\n                        0\r\n                    ]\r\n                ]]\r\n        };\r\n        var helperRotate = {\r\n            AXIS: [[\r\n                    new THREE.Line(lineGeometry, matHelper.clone()),\r\n                    [\r\n                        -1000,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    [\r\n                        1000000,\r\n                        1,\r\n                        1\r\n                    ],\r\n                    'helper'\r\n                ]]\r\n        };\r\n        var pickerRotate = {\r\n            X: [[\r\n                    new THREE.Mesh(new THREE.TorusBufferGeometry(1, 0.1, 4, 24), matInvisible),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        -Math.PI / 2,\r\n                        -Math.PI / 2\r\n                    ]\r\n                ]],\r\n            Y: [[\r\n                    new THREE.Mesh(new THREE.TorusBufferGeometry(1, 0.1, 4, 24), matInvisible),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        Math.PI / 2,\r\n                        0,\r\n                        0\r\n                    ]\r\n                ]],\r\n            Z: [[\r\n                    new THREE.Mesh(new THREE.TorusBufferGeometry(1, 0.1, 4, 24), matInvisible),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        -Math.PI / 2\r\n                    ]\r\n                ]],\r\n            E: [[new THREE.Mesh(new THREE.TorusBufferGeometry(1.25, 0.1, 2, 24), matInvisible)]],\r\n            XYZE: [[new THREE.Mesh(new THREE.SphereBufferGeometry(0.7, 10, 8), matInvisible)]]\r\n        };\r\n        var gizmoScale = {\r\n            X: [\r\n                [\r\n                    new THREE.Mesh(scaleHandleGeometry, matRed),\r\n                    [\r\n                        0.8,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        -Math.PI / 2\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineRed),\r\n                    null,\r\n                    null,\r\n                    [\r\n                        0.8,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            Y: [\r\n                [\r\n                    new THREE.Mesh(scaleHandleGeometry, matGreen),\r\n                    [\r\n                        0,\r\n                        0.8,\r\n                        0\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineGreen),\r\n                    null,\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ],\r\n                    [\r\n                        0.8,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            Z: [\r\n                [\r\n                    new THREE.Mesh(scaleHandleGeometry, matBlue),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0.8\r\n                    ],\r\n                    [\r\n                        Math.PI / 2,\r\n                        0,\r\n                        0\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineBlue),\r\n                    null,\r\n                    [\r\n                        0,\r\n                        -Math.PI / 2,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0.8,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            XY: [\r\n                [\r\n                    new THREE.Mesh(scaleHandleGeometry, matYellowTransparent),\r\n                    [\r\n                        0.85,\r\n                        0.85,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    [\r\n                        2,\r\n                        2,\r\n                        0.2\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineYellow),\r\n                    [\r\n                        0.855,\r\n                        0.98,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineYellow),\r\n                    [\r\n                        0.98,\r\n                        0.855,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ],\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            YZ: [\r\n                [\r\n                    new THREE.Mesh(scaleHandleGeometry, matCyanTransparent),\r\n                    [\r\n                        0,\r\n                        0.85,\r\n                        0.85\r\n                    ],\r\n                    null,\r\n                    [\r\n                        0.2,\r\n                        2,\r\n                        2\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineCyan),\r\n                    [\r\n                        0,\r\n                        0.855,\r\n                        0.98\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ],\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineCyan),\r\n                    [\r\n                        0,\r\n                        0.98,\r\n                        0.855\r\n                    ],\r\n                    [\r\n                        0,\r\n                        -Math.PI / 2,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            XZ: [\r\n                [\r\n                    new THREE.Mesh(scaleHandleGeometry, matMagentaTransparent),\r\n                    [\r\n                        0.85,\r\n                        0,\r\n                        0.85\r\n                    ],\r\n                    null,\r\n                    [\r\n                        2,\r\n                        0.2,\r\n                        2\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineMagenta),\r\n                    [\r\n                        0.855,\r\n                        0,\r\n                        0.98\r\n                    ],\r\n                    null,\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ],\r\n                [\r\n                    new THREE.Line(lineGeometry, matLineMagenta),\r\n                    [\r\n                        0.98,\r\n                        0,\r\n                        0.855\r\n                    ],\r\n                    [\r\n                        0,\r\n                        -Math.PI / 2,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0.125,\r\n                        1,\r\n                        1\r\n                    ]\r\n                ]\r\n            ],\r\n            XYZX: [[\r\n                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()),\r\n                    [\r\n                        1.1,\r\n                        0,\r\n                        0\r\n                    ]\r\n                ]],\r\n            XYZY: [[\r\n                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()),\r\n                    [\r\n                        0,\r\n                        1.1,\r\n                        0\r\n                    ]\r\n                ]],\r\n            XYZZ: [[\r\n                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        1.1\r\n                    ]\r\n                ]]\r\n        };\r\n        var pickerScale = {\r\n            X: [[\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible),\r\n                    [\r\n                        0.5,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        -Math.PI / 2\r\n                    ]\r\n                ]],\r\n            Y: [[\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible),\r\n                    [\r\n                        0,\r\n                        0.5,\r\n                        0\r\n                    ]\r\n                ]],\r\n            Z: [[\r\n                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        0.5\r\n                    ],\r\n                    [\r\n                        Math.PI / 2,\r\n                        0,\r\n                        0\r\n                    ]\r\n                ]],\r\n            XY: [[\r\n                    new THREE.Mesh(scaleHandleGeometry, matInvisible),\r\n                    [\r\n                        0.85,\r\n                        0.85,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    [\r\n                        3,\r\n                        3,\r\n                        0.2\r\n                    ]\r\n                ]],\r\n            YZ: [[\r\n                    new THREE.Mesh(scaleHandleGeometry, matInvisible),\r\n                    [\r\n                        0,\r\n                        0.85,\r\n                        0.85\r\n                    ],\r\n                    null,\r\n                    [\r\n                        0.2,\r\n                        3,\r\n                        3\r\n                    ]\r\n                ]],\r\n            XZ: [[\r\n                    new THREE.Mesh(scaleHandleGeometry, matInvisible),\r\n                    [\r\n                        0.85,\r\n                        0,\r\n                        0.85\r\n                    ],\r\n                    null,\r\n                    [\r\n                        3,\r\n                        0.2,\r\n                        3\r\n                    ]\r\n                ]],\r\n            XYZX: [[\r\n                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.2, 0.2, 0.2), matInvisible),\r\n                    [\r\n                        1.1,\r\n                        0,\r\n                        0\r\n                    ]\r\n                ]],\r\n            XYZY: [[\r\n                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.2, 0.2, 0.2), matInvisible),\r\n                    [\r\n                        0,\r\n                        1.1,\r\n                        0\r\n                    ]\r\n                ]],\r\n            XYZZ: [[\r\n                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.2, 0.2, 0.2), matInvisible),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        1.1\r\n                    ]\r\n                ]]\r\n        };\r\n        var helperScale = {\r\n            X: [[\r\n                    new THREE.Line(lineGeometry, matHelper.clone()),\r\n                    [\r\n                        -1000,\r\n                        0,\r\n                        0\r\n                    ],\r\n                    null,\r\n                    [\r\n                        1000000,\r\n                        1,\r\n                        1\r\n                    ],\r\n                    'helper'\r\n                ]],\r\n            Y: [[\r\n                    new THREE.Line(lineGeometry, matHelper.clone()),\r\n                    [\r\n                        0,\r\n                        -1000,\r\n                        0\r\n                    ],\r\n                    [\r\n                        0,\r\n                        0,\r\n                        Math.PI / 2\r\n                    ],\r\n                    [\r\n                        1000000,\r\n                        1,\r\n                        1\r\n                    ],\r\n                    'helper'\r\n                ]],\r\n            Z: [[\r\n                    new THREE.Line(lineGeometry, matHelper.clone()),\r\n                    [\r\n                        0,\r\n                        0,\r\n                        -1000\r\n                    ],\r\n                    [\r\n                        0,\r\n                        -Math.PI / 2,\r\n                        0\r\n                    ],\r\n                    [\r\n                        1000000,\r\n                        1,\r\n                        1\r\n                    ],\r\n                    'helper'\r\n                ]]\r\n        };\r\n        var setupGizmo = function (gizmoMap) {\r\n            var gizmo = new THREE.Object3D();\r\n            for (var name in gizmoMap) {\r\n                for (var i = gizmoMap[name].length; i--;) {\r\n                    var object = gizmoMap[name][i][0].clone();\r\n                    var position = gizmoMap[name][i][1];\r\n                    var rotation = gizmoMap[name][i][2];\r\n                    var scale = gizmoMap[name][i][3];\r\n                    var tag = gizmoMap[name][i][4];\r\n                    object.name = name;\r\n                    object.tag = tag;\r\n                    if (position) {\r\n                        object.position.set(position[0], position[1], position[2]);\r\n                    }\r\n                    if (rotation) {\r\n                        object.rotation.set(rotation[0], rotation[1], rotation[2]);\r\n                    }\r\n                    if (scale) {\r\n                        object.scale.set(scale[0], scale[1], scale[2]);\r\n                    }\r\n                    object.updateMatrix();\r\n                    var tempGeometry = object.geometry.clone();\r\n                    tempGeometry.applyMatrix4(object.matrix);\r\n                    object.geometry = tempGeometry;\r\n                    object.renderOrder = Infinity;\r\n                    object.position.set(0, 0, 0);\r\n                    object.rotation.set(0, 0, 0);\r\n                    object.scale.set(1, 1, 1);\r\n                    gizmo.add(object);\r\n                }\r\n            }\r\n            return gizmo;\r\n        };\r\n        var tempVector = new THREE.Vector3(0, 0, 0);\r\n        var tempEuler = new THREE.Euler();\r\n        var alignVector = new THREE.Vector3(0, 1, 0);\r\n        var zeroVector = new THREE.Vector3(0, 0, 0);\r\n        var lookAtMatrix = new THREE.Matrix4();\r\n        var tempQuaternion = new THREE.Quaternion();\r\n        var tempQuaternion2 = new THREE.Quaternion();\r\n        var identityQuaternion = new THREE.Quaternion();\r\n        var unitX = new THREE.Vector3(1, 0, 0);\r\n        var unitY = new THREE.Vector3(0, 1, 0);\r\n        var unitZ = new THREE.Vector3(0, 0, 1);\r\n        this.gizmo = {};\r\n        this.picker = {};\r\n        this.helper = {};\r\n        this.add(this.gizmo['translate'] = setupGizmo(gizmoTranslate));\r\n        this.add(this.gizmo['rotate'] = setupGizmo(gizmoRotate));\r\n        this.add(this.gizmo['scale'] = setupGizmo(gizmoScale));\r\n        this.add(this.picker['translate'] = setupGizmo(pickerTranslate));\r\n        this.add(this.picker['rotate'] = setupGizmo(pickerRotate));\r\n        this.add(this.picker['scale'] = setupGizmo(pickerScale));\r\n        this.add(this.helper['translate'] = setupGizmo(helperTranslate));\r\n        this.add(this.helper['rotate'] = setupGizmo(helperRotate));\r\n        this.add(this.helper['scale'] = setupGizmo(helperScale));\r\n        this.picker['translate'].visible = false;\r\n        this.picker['rotate'].visible = false;\r\n        this.picker['scale'].visible = false;\r\n        this.updateMatrixWorld = function () {\r\n            var space = this.space;\r\n            if (this.mode === 'scale')\r\n                space = 'local';\r\n            var quaternion = space === 'local' ? this.worldQuaternion : identityQuaternion;\r\n            this.gizmo['translate'].visible = this.mode === 'translate';\r\n            this.gizmo['rotate'].visible = this.mode === 'rotate';\r\n            this.gizmo['scale'].visible = this.mode === 'scale';\r\n            this.helper['translate'].visible = this.mode === 'translate';\r\n            this.helper['rotate'].visible = this.mode === 'rotate';\r\n            this.helper['scale'].visible = this.mode === 'scale';\r\n            var handles = [];\r\n            handles = handles.concat(this.picker[this.mode].children);\r\n            handles = handles.concat(this.gizmo[this.mode].children);\r\n            handles = handles.concat(this.helper[this.mode].children);\r\n            for (var i = 0; i < handles.length; i++) {\r\n                var handle = handles[i];\r\n                handle.visible = true;\r\n                handle.rotation.set(0, 0, 0);\r\n                handle.position.copy(this.worldPosition);\r\n                var eyeDistance = this.worldPosition.distanceTo(this.cameraPosition);\r\n                handle.scale.set(1, 1, 1).multiplyScalar(eyeDistance * this.size / 7);\r\n                if (handle.tag === 'helper') {\r\n                    handle.visible = false;\r\n                    if (handle.name === 'AXIS') {\r\n                        handle.position.copy(this.worldPositionStart);\r\n                        handle.visible = !!this.axis;\r\n                        if (this.axis === 'X') {\r\n                            tempQuaternion.setFromEuler(tempEuler.set(0, 0, 0));\r\n                            handle.quaternion.copy(quaternion).multiply(tempQuaternion);\r\n                            if (Math.abs(alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\r\n                                handle.visible = false;\r\n                            }\r\n                        }\r\n                        if (this.axis === 'Y') {\r\n                            tempQuaternion.setFromEuler(tempEuler.set(0, 0, Math.PI / 2));\r\n                            handle.quaternion.copy(quaternion).multiply(tempQuaternion);\r\n                            if (Math.abs(alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\r\n                                handle.visible = false;\r\n                            }\r\n                        }\r\n                        if (this.axis === 'Z') {\r\n                            tempQuaternion.setFromEuler(tempEuler.set(0, Math.PI / 2, 0));\r\n                            handle.quaternion.copy(quaternion).multiply(tempQuaternion);\r\n                            if (Math.abs(alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\r\n                                handle.visible = false;\r\n                            }\r\n                        }\r\n                        if (this.axis === 'XYZE') {\r\n                            tempQuaternion.setFromEuler(tempEuler.set(0, Math.PI / 2, 0));\r\n                            alignVector.copy(this.rotationAxis);\r\n                            handle.quaternion.setFromRotationMatrix(lookAtMatrix.lookAt(zeroVector, alignVector, unitY));\r\n                            handle.quaternion.multiply(tempQuaternion);\r\n                            handle.visible = this.dragging;\r\n                        }\r\n                        if (this.axis === 'E') {\r\n                            handle.visible = false;\r\n                        }\r\n                    } else if (handle.name === 'START') {\r\n                        handle.position.copy(this.worldPositionStart);\r\n                        handle.visible = this.dragging;\r\n                    } else if (handle.name === 'END') {\r\n                        handle.position.copy(this.worldPosition);\r\n                        handle.visible = this.dragging;\r\n                    } else if (handle.name === 'DELTA') {\r\n                        handle.position.copy(this.worldPositionStart);\r\n                        handle.quaternion.copy(this.worldQuaternionStart);\r\n                        tempVector.set(1e-10, 1e-10, 1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1);\r\n                        tempVector.applyQuaternion(this.worldQuaternionStart.clone().inverse());\r\n                        handle.scale.copy(tempVector);\r\n                        handle.visible = this.dragging;\r\n                    } else {\r\n                        handle.quaternion.copy(quaternion);\r\n                        if (this.dragging) {\r\n                            handle.position.copy(this.worldPositionStart);\r\n                        } else {\r\n                            handle.position.copy(this.worldPosition);\r\n                        }\r\n                        if (this.axis) {\r\n                            handle.visible = this.axis.search(handle.name) !== -1;\r\n                        }\r\n                    }\r\n                    continue;\r\n                }\r\n                handle.quaternion.copy(quaternion);\r\n                if (this.mode === 'translate' || this.mode === 'scale') {\r\n                    var AXIS_HIDE_TRESHOLD = 0.99;\r\n                    var PLANE_HIDE_TRESHOLD = 0.2;\r\n                    var AXIS_FLIP_TRESHOLD = 0;\r\n                    if (handle.name === 'X' || handle.name === 'XYZX') {\r\n                        if (Math.abs(alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\r\n                            handle.scale.set(1e-10, 1e-10, 1e-10);\r\n                            handle.visible = false;\r\n                        }\r\n                    }\r\n                    if (handle.name === 'Y' || handle.name === 'XYZY') {\r\n                        if (Math.abs(alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\r\n                            handle.scale.set(1e-10, 1e-10, 1e-10);\r\n                            handle.visible = false;\r\n                        }\r\n                    }\r\n                    if (handle.name === 'Z' || handle.name === 'XYZZ') {\r\n                        if (Math.abs(alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\r\n                            handle.scale.set(1e-10, 1e-10, 1e-10);\r\n                            handle.visible = false;\r\n                        }\r\n                    }\r\n                    if (handle.name === 'XY') {\r\n                        if (Math.abs(alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\r\n                            handle.scale.set(1e-10, 1e-10, 1e-10);\r\n                            handle.visible = false;\r\n                        }\r\n                    }\r\n                    if (handle.name === 'YZ') {\r\n                        if (Math.abs(alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\r\n                            handle.scale.set(1e-10, 1e-10, 1e-10);\r\n                            handle.visible = false;\r\n                        }\r\n                    }\r\n                    if (handle.name === 'XZ') {\r\n                        if (Math.abs(alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\r\n                            handle.scale.set(1e-10, 1e-10, 1e-10);\r\n                            handle.visible = false;\r\n                        }\r\n                    }\r\n                    if (handle.name.search('X') !== -1) {\r\n                        if (alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\r\n                            if (handle.tag === 'fwd') {\r\n                                handle.visible = false;\r\n                            } else {\r\n                                handle.scale.x *= -1;\r\n                            }\r\n                        } else if (handle.tag === 'bwd') {\r\n                            handle.visible = false;\r\n                        }\r\n                    }\r\n                    if (handle.name.search('Y') !== -1) {\r\n                        if (alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\r\n                            if (handle.tag === 'fwd') {\r\n                                handle.visible = false;\r\n                            } else {\r\n                                handle.scale.y *= -1;\r\n                            }\r\n                        } else if (handle.tag === 'bwd') {\r\n                            handle.visible = false;\r\n                        }\r\n                    }\r\n                    if (handle.name.search('Z') !== -1) {\r\n                        if (alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\r\n                            if (handle.tag === 'fwd') {\r\n                                handle.visible = false;\r\n                            } else {\r\n                                handle.scale.z *= -1;\r\n                            }\r\n                        } else if (handle.tag === 'bwd') {\r\n                            handle.visible = false;\r\n                        }\r\n                    }\r\n                } else if (this.mode === 'rotate') {\r\n                    tempQuaternion2.copy(quaternion);\r\n                    alignVector.copy(this.eye).applyQuaternion(tempQuaternion.copy(quaternion).inverse());\r\n                    if (handle.name.search('E') !== -1) {\r\n                        handle.quaternion.setFromRotationMatrix(lookAtMatrix.lookAt(this.eye, zeroVector, unitY));\r\n                    }\r\n                    if (handle.name === 'X') {\r\n                        tempQuaternion.setFromAxisAngle(unitX, Math.atan2(-alignVector.y, alignVector.z));\r\n                        tempQuaternion.multiplyQuaternions(tempQuaternion2, tempQuaternion);\r\n                        handle.quaternion.copy(tempQuaternion);\r\n                    }\r\n                    if (handle.name === 'Y') {\r\n                        tempQuaternion.setFromAxisAngle(unitY, Math.atan2(alignVector.x, alignVector.z));\r\n                        tempQuaternion.multiplyQuaternions(tempQuaternion2, tempQuaternion);\r\n                        handle.quaternion.copy(tempQuaternion);\r\n                    }\r\n                    if (handle.name === 'Z') {\r\n                        tempQuaternion.setFromAxisAngle(unitZ, Math.atan2(alignVector.y, alignVector.x));\r\n                        tempQuaternion.multiplyQuaternions(tempQuaternion2, tempQuaternion);\r\n                        handle.quaternion.copy(tempQuaternion);\r\n                    }\r\n                }\r\n                handle.visible = handle.visible && (handle.name.indexOf('X') === -1 || this.showX);\r\n                handle.visible = handle.visible && (handle.name.indexOf('Y') === -1 || this.showY);\r\n                handle.visible = handle.visible && (handle.name.indexOf('Z') === -1 || this.showZ);\r\n                handle.visible = handle.visible && (handle.name.indexOf('E') === -1 || this.showX && this.showY && this.showZ);\r\n                handle.material._opacity = handle.material._opacity || handle.material.opacity;\r\n                handle.material._color = handle.material._color || handle.material.color.clone();\r\n                handle.material.color.copy(handle.material._color);\r\n                handle.material.opacity = handle.material._opacity;\r\n                if (!this.enabled) {\r\n                    handle.material.opacity *= 0.5;\r\n                    handle.material.color.lerp(new THREE.Color(1, 1, 1), 0.5);\r\n                } else if (this.axis) {\r\n                    if (handle.name === this.axis) {\r\n                        handle.material.opacity = 1;\r\n                        handle.material.color.lerp(new THREE.Color(1, 1, 1), 0.5);\r\n                    } else if (this.axis.split('').some(function (THREE) {\r\n                            return handle.name === THREE;\r\n                        })) {\r\n                        handle.material.opacity = 1;\r\n                        handle.material.color.lerp(new THREE.Color(1, 1, 1), 0.5);\r\n                    } else {\r\n                        handle.material.opacity *= 0.25;\r\n                        handle.material.color.lerp(new THREE.Color(1, 1, 1), 0.5);\r\n                    }\r\n                }\r\n            }\r\n            THREE.Object3D.prototype.updateMatrixWorld.call(this);\r\n        };\r\n    };\r\n    TransformControlsGizmo.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {\r\n        constructor: TransformControlsGizmo,\r\n        isTransformControlsGizmo: true\r\n    });\r\n \r\n    return  threex.controls.TransformControlsGizmo = TransformControlsGizmo;\r\n});"]}
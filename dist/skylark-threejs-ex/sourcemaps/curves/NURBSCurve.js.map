{"version":3,"sources":["curves/NURBSCurve.js"],"names":["define","THREE","threex","NURBSUtils","NURBSCurve","degree","knots","controlPoints","startKnot","endKnot","Curve","call","this","length","i","point","Vector4","x","y","z","w","prototype","Object","create","constructor","getPoint","t","u","hpoint","calcBSplinePoint","divideScalar","Vector3","getTangent","tangent","calcNURBSDerivatives","clone","normalize","curves"],"mappings":";;;;;;;AAAAA,QACI,kBACA,YACA,gBACD,SACCC,EACAC,EACAC,GAEA,aACA,IAAIC,EAAa,SAAUC,EAAQC,EAAOC,EAAeC,EAAWC,GAChER,EAAMS,MAAMC,KAAKC,MACjBA,KAAKP,OAASA,EACdO,KAAKN,MAAQA,EACbM,KAAKL,iBACLK,KAAKJ,UAAYA,GAAa,EAC9BI,KAAKH,QAAUA,GAAWG,KAAKN,MAAMO,OAAS,EAC9C,IAAK,IAAIC,EAAI,EAAGA,EAAIP,EAAcM,SAAUC,EAAG,CAC3C,IAAIC,EAAQR,EAAcO,GAC1BF,KAAKL,cAAcO,GAAK,IAAIb,EAAMe,QAAQD,EAAME,EAAGF,EAAMG,EAAGH,EAAMI,EAAGJ,EAAMK,KAqBnF,OAlBAhB,EAAWiB,UAAYC,OAAOC,OAAOtB,EAAMS,MAAMW,YAC5BG,YAAcpB,EACnCA,EAAWiB,UAAUI,SAAW,SAAUC,GACtC,IAAIC,EAAIf,KAAKN,MAAMM,KAAKJ,WAAakB,GAAKd,KAAKN,MAAMM,KAAKH,SAAWG,KAAKN,MAAMM,KAAKJ,YACjFoB,EAASzB,EAAW0B,iBAAiBjB,KAAKP,OAAQO,KAAKN,MAAOM,KAAKL,cAAeoB,GAItF,OAHgB,GAAZC,EAAOR,GACPQ,EAAOE,aAAaF,EAAOR,GAExB,IAAInB,EAAM8B,QAAQH,EAAOX,EAAGW,EAAOV,EAAGU,EAAOT,IAExDf,EAAWiB,UAAUW,WAAa,SAAUN,GACxC,IAAIC,EAAIf,KAAKN,MAAM,GAAKoB,GAAKd,KAAKN,MAAMM,KAAKN,MAAMO,OAAS,GAAKD,KAAKN,MAAM,IAExE2B,EADO9B,EAAW+B,qBAAqBtB,KAAKP,OAAQO,KAAKN,MAAOM,KAAKL,cAAeoB,EAAG,GACxE,GAAGQ,QAEtB,OADAF,EAAQG,YACDH,GAGJ/B,EAAOmC,OAAOjC,WAAaA","file":"../../curves/NURBSCurve.js","sourcesContent":["define([\r\n    \"skylark-threejs\",\r\n    \"../threex\",\r\n    './NURBSUtils'\r\n], function (\r\n    THREE,\r\n    threex,\r\n    NURBSUtils\r\n) {\r\n    'use strict';\r\n    var NURBSCurve = function (degree, knots, controlPoints, startKnot, endKnot) {\r\n        THREE.Curve.call(this);\r\n        this.degree = degree;\r\n        this.knots = knots;\r\n        this.controlPoints = [];\r\n        this.startKnot = startKnot || 0;\r\n        this.endKnot = endKnot || this.knots.length - 1;\r\n        for (var i = 0; i < controlPoints.length; ++i) {\r\n            var point = controlPoints[i];\r\n            this.controlPoints[i] = new THREE.Vector4(point.x, point.y, point.z, point.w);\r\n        }\r\n    };\r\n    NURBSCurve.prototype = Object.create(THREE.Curve.prototype);\r\n    NURBSCurve.prototype.constructor = NURBSCurve;\r\n    NURBSCurve.prototype.getPoint = function (t) {\r\n        var u = this.knots[this.startKnot] + t * (this.knots[this.endKnot] - this.knots[this.startKnot]);\r\n        var hpoint = NURBSUtils.calcBSplinePoint(this.degree, this.knots, this.controlPoints, u);\r\n        if (hpoint.w != 1) {\r\n            hpoint.divideScalar(hpoint.w);\r\n        }\r\n        return new THREE.Vector3(hpoint.x, hpoint.y, hpoint.z);\r\n    };\r\n    NURBSCurve.prototype.getTangent = function (t) {\r\n        var u = this.knots[0] + t * (this.knots[this.knots.length - 1] - this.knots[0]);\r\n        var ders = NURBSUtils.calcNURBSDerivatives(this.degree, this.knots, this.controlPoints, u, 1);\r\n        var tangent = ders[1].clone();\r\n        tangent.normalize();\r\n        return tangent;\r\n    };\r\n    \r\n    return threex.curves.NURBSCurve = NURBSCurve;\r\n});"]}
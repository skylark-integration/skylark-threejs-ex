/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs","./SSAARenderPass"],function(e,t){"use strict";var r=function(e,r,a,s){void 0===t&&console.error("TAARenderPass relies on SSAARenderPass"),t.call(this,e,r,a,s),this.sampleLevel=0,this.accumulate=!1};return r.JitterVectors=t.JitterVectors,r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,render:function(a,s,i,h){if(!this.accumulate)return t.prototype.render.call(this,a,s,i,h),void(this.accumulateIndex=-1);var n=r.JitterVectors[5];this.sampleRenderTarget||(this.sampleRenderTarget=new e.WebGLRenderTarget(i.width,i.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),this.holdRenderTarget||(this.holdRenderTarget=new e.WebGLRenderTarget(i.width,i.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),this.accumulate&&-1===this.accumulateIndex&&(t.prototype.render.call(this,a,this.holdRenderTarget,i,h),this.accumulateIndex=0);var c=a.autoClear;a.autoClear=!1;var l=1/n.length;if(this.accumulateIndex>=0&&this.accumulateIndex<n.length){this.copyUniforms.opacity.value=l,this.copyUniforms.tDiffuse.value=s.texture;for(var d=Math.pow(2,this.sampleLevel),u=0;u<d;u++){var o=n[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(i.width,i.height,.0625*o[0],.0625*o[1],i.width,i.height),a.setRenderTarget(s),a.clear(),a.render(this.scene,this.camera),a.setRenderTarget(this.sampleRenderTarget),0===this.accumulateIndex&&a.clear(),this.fsQuad.render(a),this.accumulateIndex++,this.accumulateIndex>=n.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}var m=this.accumulateIndex*l;m>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,a.setRenderTarget(s),a.clear(),this.fsQuad.render(a)),m<1&&(this.copyUniforms.opacity.value=1-m,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,a.setRenderTarget(s),0===m&&a.clear(),this.fsQuad.render(a)),a.autoClear=c}}),r});
//# sourceMappingURL=../sourcemaps/postprocessing/TAARenderPass.js.map

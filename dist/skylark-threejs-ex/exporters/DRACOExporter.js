/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs","../threex"],function(e,r){"use strict";var t=function(){};return t.prototype={constructor:t,parse:function(r,o){if(void 0===DracoEncoderModule)throw new Error("THREE.DRACOExporter: required the draco_decoder to work.");void 0===o&&(o={decodeSpeed:5,encodeSpeed:5,encoderMethod:t.MESH_EDGEBREAKER_ENCODING,quantization:[16,8,8,8,8],exportUvs:!0,exportNormals:!0,exportColor:!1});var n=DracoEncoderModule(),i=new n.Encoder,a=new n.MeshBuilder,d=new n.Mesh;if(!0===r.isGeometry){var u=new e.BufferGeometry;u.fromGeometry(r),r=u}if(!0!==r.isBufferGeometry)throw new Error("THREE.DRACOExporter.parse(geometry, options): geometry is not a THREE.Geometry or BufferGeometry instance.");var E=r.getAttribute("position");if(a.AddFloatAttributeToMesh(d,n.POSITION,E.count,E.itemSize,E.array),null!==(c=r.getIndex()))a.AddFacesToMesh(d,c.count,c.array);else{for(var c=new(E.count>65535?Uint32Array:Uint16Array)(E.count),s=0;s<c.length;s++)c[s]=s;a.AddFacesToMesh(d,E.count,c)}if(!0===o.exportNormals){var A=r.getAttribute("normal");void 0!==A&&a.AddFloatAttributeToMesh(d,n.NORMAL,A.count,A.itemSize,A.array)}if(!0===o.exportUvs){var f=r.getAttribute("uv");void 0!==f&&a.AddFloatAttributeToMesh(d,n.TEX_COORD,f.count,f.itemSize,f.array)}if(!0===o.exportColor){var y=r.getAttribute("color");void 0!==y&&a.AddFloatAttributeToMesh(d,n.COLOR,y.count,y.itemSize,y.array)}var O=new n.DracoInt8Array;if(i.SetSpeedOptions(o.encodeSpeed||5,o.decodeSpeed||5),void 0!==o.encoderMethod&&i.SetEncodingMethod(o.encoderMethod),void 0!==o.quantization)for(s=0;s<5;s++)void 0!==o.quantization[s]&&i.SetAttributeQuantization(s,o.quantization[s]);var p=i.EncodeMeshToDracoBuffer(d,O);if(n.destroy(d),0===p)throw new Error("THREE.DRACOExporter: Draco encoding failed.");var v=new Int8Array(new ArrayBuffer(p));for(s=0;s<p;s++)v[s]=O.GetValue(s);return n.destroy(O),n.destroy(i),n.destroy(a),v}},t.MESH_EDGEBREAKER_ENCODING=1,t.MESH_SEQUENTIAL_ENCODING=0,t.POINT_CLOUD=0,t.TRIANGULAR_MESH=1,t.INVALID=-1,t.POSITION=0,t.NORMAL=1,t.COLOR=2,t.TEX_COORD=3,t.GENERIC=4,r.exporters.DRACOExporter=t});
//# sourceMappingURL=../sourcemaps/exporters/DRACOExporter.js.map

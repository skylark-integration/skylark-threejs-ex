/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["./TempNode","./NodeLib"],function(t,e){"use strict";var s=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,i=/[a-z_0-9]+/gi;function o(e,s,i,o,n){this.isMethod=void 0===n,this.isInterface=!1,t.call(this,n),this.parse(e,s,i,o)}return o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype.nodeType="Function",o.prototype.useKeywords=!0,o.prototype.getShared=function(){return!this.isMethod},o.prototype.getType=function(t){return t.getTypeByFormat(this.type)},o.prototype.getInputByName=function(t){for(var e=this.inputs.length;e--;)if(this.inputs[e].name===t)return this.inputs[e]},o.prototype.getIncludeByName=function(t){for(var e=this.includes.length;e--;)if(this.includes[e].name===t)return this.includes[e]},o.prototype.generate=function(t,s){for(var o=0,n=this.src,r=0;r<this.includes.length;r++)t.include(this.includes[r],this);for(var h in this.extensions)t.extensions[h]=!0;for(var u=[];d=i.exec(this.src);)u.push(d);for(r=0;r<u.length;r++){var d,c=(d=u[r])[0],p=!this.isMethod||!this.getInputByName(c),y=c;if(this.keywords[c]||this.useKeywords&&p&&e.containsKeyword(c)){var a=this.keywords[c];if(!a){var f=e.getKeywordData(c);f.cache&&(a=t.keywords[c]),a=a||e.getKeyword(c,t),f.cache&&(t.keywords[c]=a)}y=a.build(t)}c!==y&&(n=n.substring(0,d.index+o)+y+n.substring(d.index+c.length+o),o+=y.length-c.length),void 0===this.getIncludeByName(y)&&e.contains(y)&&t.include(e.get(y))}return"source"===s?n:this.isMethod?(this.isInterface||t.include(this,!1,n),this.name):t.format("( "+n+" )",this.getType(t),s)},o.prototype.parse=function(t,e,o,n){if(this.src=t||"",this.includes=e||[],this.extensions=o||{},this.keywords=n||{},this.isMethod){var r=this.src.match(s);if(this.inputs=[],r&&4==r.length){this.type=r[1],this.name=r[2];var h=r[3].match(i);if(h)for(var u=0;u<h.length;){var d,c,p=h[u++];"in"===p||"out"===p||"inout"===p?d=h[u++]:(d=p,p=""),c=h[u++],this.inputs.push({name:c,type:d,qualifier:p})}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}},o.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.isMethod=e.isMethod,this.useKeywords=e.useKeywords,this.parse(e.src,e.includes,e.extensions,e.keywords),void 0!==e.type&&(this.type=e.type),this},o.prototype.toJSON=function(t){var e=this.getJSONNode(t);if(!e){for(var s in(e=this.createJSONNode(t)).src=this.src,e.isMethod=this.isMethod,e.useKeywords=this.useKeywords,this.isMethod||(e.type=this.type),e.extensions=JSON.parse(JSON.stringify(this.extensions)),e.keywords={},this.keywords)e.keywords[s]=this.keywords[s].toJSON(t).uuid;if(this.includes.length){e.includes=[];for(var i=0;i<this.includes.length;i++)e.includes.push(this.includes[i].toJSON(t).uuid)}}return e},o});
//# sourceMappingURL=../../sourcemaps/nodes/core/FunctionNode.js.map

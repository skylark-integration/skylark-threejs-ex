/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs"],function(e){return e.CSS3DObject=function(t){e.Object3D.call(this),this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)})})},e.CSS3DObject.prototype=Object.create(e.Object3D.prototype),e.CSS3DObject.prototype.constructor=e.CSS3DObject,e.CSS3DSprite=function(t){e.CSS3DObject.call(this,t)},e.CSS3DSprite.prototype=Object.create(e.CSS3DObject.prototype),e.CSS3DSprite.prototype.constructor=e.CSS3DSprite,e.CSS3DRenderer=function(){var t,r,n,a,o=this,i=new e.Matrix4,s={camera:{fov:0,style:""},objects:new WeakMap},l=document.createElement("div");l.style.overflow="hidden",this.domElement=l;var c=document.createElement("div");c.style.WebkitTransformStyle="preserve-3d",c.style.transformStyle="preserve-3d",c.style.pointerEvents="none",l.appendChild(c);var p=/Trident/i.test(navigator.userAgent);function d(e){return Math.abs(e)<1e-10?0:e}function m(e){var t=e.elements;return"matrix3d("+d(t[0])+","+d(-t[1])+","+d(t[2])+","+d(t[3])+","+d(t[4])+","+d(-t[5])+","+d(t[6])+","+d(t[7])+","+d(t[8])+","+d(-t[9])+","+d(t[10])+","+d(t[11])+","+d(t[12])+","+d(-t[13])+","+d(t[14])+","+d(t[15])+")"}function u(e,t){var r=e.elements,o="matrix3d("+d(r[0])+","+d(r[1])+","+d(r[2])+","+d(r[3])+","+d(-r[4])+","+d(-r[5])+","+d(-r[6])+","+d(-r[7])+","+d(r[8])+","+d(r[9])+","+d(r[10])+","+d(r[11])+","+d(r[12])+","+d(r[13])+","+d(r[14])+","+d(r[15])+")";return p?"translate(-50%,-50%)translate("+n+"px,"+a+"px)"+t+o:"translate(-50%,-50%)"+o}this.getSize=function(){return{width:t,height:r}},this.setSize=function(e,o){n=(t=e)/2,a=(r=o)/2,l.style.width=e+"px",l.style.height=o+"px",c.style.width=e+"px",c.style.height=o+"px"};var S,f,v=(S=new e.Vector3,f=new e.Vector3,function(e,t){return S.setFromMatrixPosition(e.matrixWorld),f.setFromMatrixPosition(t.matrixWorld),S.distanceToSquared(f)});function h(t){for(var r=function(t){var r=[];return t.traverse(function(t){t instanceof e.CSS3DObject&&r.push(t)}),r}(t).sort(function(e,t){return s.objects.get(e).distanceToCameraSquared-s.objects.get(t).distanceToCameraSquared}),n=r.length,a=0,o=r.length;a<o;a++)r[a].element.style.zIndex=n-a}this.render=function(t,r){var S=r.projectionMatrix.elements[5]*a;if(s.camera.fov!==S&&(r.isPerspectiveCamera?(l.style.WebkitPerspective=S+"px",l.style.perspective=S+"px"):(l.style.WebkitPerspective="",l.style.perspective=""),s.camera.fov=S),!0===t.autoUpdate&&t.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),r.isOrthographicCamera)var f=-(r.right+r.left)/2,y=(r.top+r.bottom)/2;var x=r.isOrthographicCamera?"scale("+S+")translate("+d(f)+"px,"+d(y)+"px)"+m(r.matrixWorldInverse):"translateZ("+S+"px)"+m(r.matrixWorldInverse),b=x+"translate("+n+"px,"+a+"px)";s.camera.style===b||p||(c.style.WebkitTransform=b,c.style.transform=b,s.camera.style=b),function t(r,n,a,l){if(r instanceof e.CSS3DObject){var d;r.onBeforeRender(o,n,a),r instanceof e.CSS3DSprite?(i.copy(a.matrixWorldInverse),i.transpose(),i.copyPosition(r.matrixWorld),i.scale(r.scale),i.elements[3]=0,i.elements[7]=0,i.elements[11]=0,i.elements[15]=1,d=u(i,l)):d=u(r.matrixWorld,l);var m=r.element,S=s.objects.get(r);if(void 0===S||S.style!==d){m.style.WebkitTransform=d,m.style.transform=d;var f={style:d};p&&(f.distanceToCameraSquared=v(a,r)),s.objects.set(r,f)}m.parentNode!==c&&c.appendChild(m),r.onAfterRender(o,n,a)}for(var h=0,y=r.children.length;h<y;h++)t(r.children[h],n,a,l)}(t,t,r,x),p&&h(t)}},e.CSS3DRenderer});
//# sourceMappingURL=../sourcemaps/renderers/CSS3DRenderer.js.map

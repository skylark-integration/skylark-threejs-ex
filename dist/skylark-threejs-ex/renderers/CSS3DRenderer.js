/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs","../threex"],function(e,t){"use strict";var r=function(t){e.Object3D.call(this),this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)})})};r.prototype=Object.create(e.Object3D.prototype),r.prototype.constructor=r;var n=function(e){r.call(this,e)};n.prototype=Object.create(r.prototype),n.prototype.constructor=n;var a=function(){var t,a,s,o,i=this,l=new e.Matrix4,c={camera:{fov:0,style:""},objects:new WeakMap},p=document.createElement("div");p.style.overflow="hidden",this.domElement=p;var d=document.createElement("div");d.style.WebkitTransformStyle="preserve-3d",d.style.transformStyle="preserve-3d",d.style.pointerEvents="none",p.appendChild(d);var m=/Trident/i.test(navigator.userAgent);function u(e){return Math.abs(e)<1e-10?0:e}function v(e){var t=e.elements;return"matrix3d("+u(t[0])+","+u(-t[1])+","+u(t[2])+","+u(t[3])+","+u(t[4])+","+u(-t[5])+","+u(t[6])+","+u(t[7])+","+u(t[8])+","+u(-t[9])+","+u(t[10])+","+u(t[11])+","+u(t[12])+","+u(-t[13])+","+u(t[14])+","+u(t[15])+")"}function f(e,t){var r=e.elements,n="matrix3d("+u(r[0])+","+u(r[1])+","+u(r[2])+","+u(r[3])+","+u(-r[4])+","+u(-r[5])+","+u(-r[6])+","+u(-r[7])+","+u(r[8])+","+u(r[9])+","+u(r[10])+","+u(r[11])+","+u(r[12])+","+u(r[13])+","+u(r[14])+","+u(r[15])+")";return m?"translate(-50%,-50%)translate("+s+"px,"+o+"px)"+t+n:"translate(-50%,-50%)"+n}this.getSize=function(){return{width:t,height:a}},this.setSize=function(e,r){s=(t=e)/2,o=(a=r)/2,p.style.width=e+"px",p.style.height=r+"px",d.style.width=e+"px",d.style.height=r+"px"};var h,y,x=(h=new e.Vector3,y=new e.Vector3,function(e,t){return h.setFromMatrixPosition(e.matrixWorld),y.setFromMatrixPosition(t.matrixWorld),h.distanceToSquared(y)});function b(e){for(var t=function(e){var t=[];return e.traverse(function(e){e instanceof r&&t.push(e)}),t}(e).sort(function(e,t){return c.objects.get(e).distanceToCameraSquared-c.objects.get(t).distanceToCameraSquared}),n=t.length,a=0,s=t.length;a<s;a++)t[a].element.style.zIndex=n-a}this.render=function(e,t){var a=t.projectionMatrix.elements[5]*o;if(c.camera.fov!==a&&(t.isPerspectiveCamera?(p.style.WebkitPerspective=a+"px",p.style.perspective=a+"px"):(p.style.WebkitPerspective="",p.style.perspective=""),c.camera.fov=a),!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),t.isOrthographicCamera)var h=-(t.right+t.left)/2,y=(t.top+t.bottom)/2;var g=t.isOrthographicCamera?"scale("+a+")translate("+u(h)+"px,"+u(y)+"px)"+v(t.matrixWorldInverse):"translateZ("+a+"px)"+v(t.matrixWorldInverse),S=g+"translate("+s+"px,"+o+"px)";c.camera.style===S||m||(d.style.WebkitTransform=S,d.style.transform=S,c.camera.style=S),function e(t,a,s,o){if(t instanceof r){var p;t.onBeforeRender(i,a,s),t instanceof n?(l.copy(s.matrixWorldInverse),l.transpose(),l.copyPosition(t.matrixWorld),l.scale(t.scale),l.elements[3]=0,l.elements[7]=0,l.elements[11]=0,l.elements[15]=1,p=f(l,o)):p=f(t.matrixWorld,o);var u=t.element,v=c.objects.get(t);if(void 0===v||v.style!==p){u.style.WebkitTransform=p,u.style.transform=p;var h={style:p};m&&(h.distanceToCameraSquared=x(s,t)),c.objects.set(t,h)}u.parentNode!==d&&d.appendChild(u),t.onAfterRender(i,a,s)}for(var y=0,b=t.children.length;y<b;y++)e(t.children[y],a,s,o)}(e,e,t,g),m&&b(e)}};return a.CSS3DObject=r,a.CSS3DSprite=n,t.renderers.CSS3DRenderer=a});
//# sourceMappingURL=../sourcemaps/renderers/CSS3DRenderer.js.map

/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs","../shaders/UnpackDepthRGBAShader"],function(e){return e.ShadowMapViewer=function(i){var t,n=this,h=void 0!==i.name&&""!==i.name,r=10,a=10,o=256,s=256,d=new e.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,1,10);d.position.set(0,0,2);var w,p,l=new e.Scene,u=e.UnpackDepthRGBAShader,f=e.UniformsUtils.clone(u.uniforms),c=new e.ShaderMaterial({uniforms:f,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}),g=new e.PlaneBufferGeometry(o,s),m=new e.Mesh(g,c);if(l.add(m),h){var x=(w=document.createElement("canvas")).getContext("2d");x.font="Bold 20px Arial";var S=x.measureText(i.name).width;w.width=S,w.height=25,x.font="Bold 20px Arial",x.fillStyle="rgba( 255, 0, 0, 1 )",x.fillText(i.name,0,20);var v=new e.Texture(w);v.magFilter=e.LinearFilter,v.minFilter=e.LinearFilter,v.needsUpdate=!0;var y=new e.MeshBasicMaterial({map:v,side:e.DoubleSide});y.transparent=!0;var M=new e.PlaneBufferGeometry(w.width,w.height);p=new e.Mesh(M,y),l.add(p)}this.enabled=!0,this.size={width:o,height:s,set:function(e,i){this.width=e,this.height=i,m.scale.set(this.width/o,this.height/s,1),n.position.set(n.position.x,n.position.y)}},this.position={x:r,y:a,set:function(e,i){this.x=e,this.y=i;var t=n.size.width,r=n.size.height;m.position.set(-window.innerWidth/2+t/2+this.x,window.innerHeight/2-r/2-this.y,0),h&&p.position.set(m.position.x,m.position.y-n.size.height/2+w.height/2,0)}},this.render=function(e){this.enabled&&(f.tDiffuse.value=i.shadow.map.texture,t=e.autoClear,e.autoClear=!1,e.clearDepth(),e.render(l,d),e.autoClear=t)},this.updateForWindowResize=function(){this.enabled&&(d.left=window.innerWidth/-2,d.right=window.innerWidth/2,d.top=window.innerHeight/2,d.bottom=window.innerHeight/-2,d.updateProjectionMatrix(),this.update())},this.update=function(){this.position.set(this.position.x,this.position.y),this.size.set(this.size.width,this.size.height)},this.update()},e.ShadowMapViewer.prototype.constructor=e.ShadowMapViewer,e.ShadowMapViewer});
//# sourceMappingURL=../sourcemaps/utils/ShadowMapViewer.js.map

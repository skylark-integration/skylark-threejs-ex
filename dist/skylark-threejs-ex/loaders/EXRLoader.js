/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs"],function(e,r){return e.EXRLoader=function(r){e.DataTextureLoader.call(this,r),this.type=e.FloatType},e.EXRLoader.prototype=Object.assign(Object.create(e.DataTextureLoader.prototype),{constructor:e.EXRLoader,parse:function(r){const a=65536,n=a>>3,t=14,i=65537,o=1<<t,l=o-1,f=59,s=63,u=2+s-f,c=8,v=4,h=4,p=2,w=1,d=0,y=1,g=0,m=1,S=2,b=Math.pow(2.7182818,2.2);const A={l:0,c:0,lc:0};function U(e,r,a,n,t){for(;a<e;)r=r<<8|J(n,t),a+=8;a-=e,A.l=r>>a&(1<<e)-1,A.c=r,A.lc=a}const M=new Array(59);function E(e,r,a,n,t,o,l){for(var c=a,v=0,h=0;t<=o;t++){if(c.value-a.value>n)return!1;U(6,v,h,e,c);var p=A.l;if(v=A.c,h=A.lc,l[t]=p,p==s){if(c.value-a.value>n)throw"Something wrong with hufUnpackEncTable";U(8,v,h,e,c);var w=A.l+u;if(v=A.c,h=A.lc,t+w>o+1)throw"Something wrong with hufUnpackEncTable";for(;w--;)l[t++]=0;t--}else if(p>=f){if(t+(w=p-f+2)>o+1)throw"Something wrong with hufUnpackEncTable";for(;w--;)l[t++]=0;t--}}!function(e){for(var r=0;r<=58;++r)M[r]=0;for(r=0;r<i;++r)M[e[r]]+=1;var a=0;for(r=58;r>0;--r){var n=a+M[r]>>1;M[r]=a,a=n}for(r=0;r<i;++r){var t=e[r];t>0&&(e[r]=t|M[t]++<<6)}}(l)}function I(e){return 63&e}function O(e){return e>>6}const C={c:0,lc:0};function R(e,r,a,n){e=e<<8|J(a,n),r+=8,C.c=e,C.lc=r}const x={c:0,lc:0};function z(e,r,a,n,t,i,o,l,f,s){if(e==r){n<8&&(R(a,n,t,o),a=C.c,n=C.lc);var u=a>>(n-=8);u=new Uint8Array([u])[0];if(f.value+u>s)return!1;for(var c=l[f.value-1];u-- >0;)l[f.value++]=c}else{if(!(f.value<s))return!1;l[f.value++]=e}x.c=a,x.lc=n}function P(e){var r=function(e){return 65535&e}(e);return r>32767?r-65536:r}const T={a:0,b:0};function N(e,r){var a=P(e),n=P(r),t=a+(1&n)+(n>>1),i=t,o=t-n;T.a=i,T.b=o}function L(e,r,a,n,t,i){for(var o,l=a>t?t:a,f=1;f<=l;)f<<=1;for(o=f>>=1,f>>=1;f>=1;){for(var s,u,c,v,h=0,p=h+i*(t-o),w=i*f,d=i*o,y=n*f,g=n*o;h<=p;h+=d){for(var m=h,S=h+n*(a-o);m<=S;m+=g){var b=m+y,A=(U=m+w)+y;N(e[m+r],e[U+r]),s=T.a,c=T.b,N(e[b+r],e[A+r]),u=T.a,v=T.b,N(s,u),e[m+r]=T.a,e[b+r]=T.b,N(c,v),e[U+r]=T.a,e[A+r]=T.b}if(a&f){var U=m+w;N(e[m+r],e[U+r]),s=T.a,e[U+r]=T.b,e[m+r]=s}}if(t&f)for(m=h,S=h+n*(a-o);m<=S;m+=g){b=m+y;N(e[m+r],e[b+r]),s=T.a,e[b+r]=T.b,e[m+r]=s}o=f,f>>=1}return h}function D(e,r,a,n,f,s){var u=a.value,c=q(r,a),v=q(r,a);a.value+=4;var h=q(r,a);if(a.value+=4,c<0||c>=i||v<0||v>=i)throw"Something wrong with HUF_ENCSIZE";var p=new Array(i),w=new Array(o);if(function(e){for(var r=0;r<o;r++)e[r]={},e[r].len=0,e[r].lit=0,e[r].p=null}(w),E(e,0,a,n-(a.value-u),c,v,p),h>8*(n-(a.value-u)))throw"Something wrong with hufUncompress";!function(e,r,a,n){for(;r<=a;r++){var i=O(e[r]),o=I(e[r]);if(i>>o)throw"Invalid table entry";if(o>t){if((u=n[i>>o-t]).len)throw"Invalid table entry";if(u.lit++,u.p){var l=u.p;u.p=new Array(u.lit);for(var f=0;f<u.lit-1;++f)u.p[f]=l[f]}else u.p=new Array(1);u.p[u.lit-1]=r}else if(o){var s=0;for(f=1<<t-o;f>0;f--){var u;if((u=n[(i<<t-o)+s]).len||u.p)throw"Invalid table entry";u.len=o,u.lit=r,s++}}}}(p,c,v,w),function(e,r,a,n,i,o,f,s,u,c){for(var v=0,h=0,p=s,w=Math.trunc(i.value+(o+7)/8);i.value<w;)for(R(v,h,a,i),v=C.c,h=C.lc;h>=t;)if((m=r[v>>h-t&l]).len)h-=m.len,z(m.lit,f,v,h,a,0,i,u,c,p),v=x.c,h=x.lc;else{if(!m.p)throw"hufDecode issues";var d;for(d=0;d<m.lit;d++){for(var y=I(e[m.p[d]]);h<y&&i.value<w;)R(v,h,a,i),v=C.c,h=C.lc;if(h>=y&&O(e[m.p[d]])==(v>>h-y&(1<<y)-1)){h-=y,z(m.p[d],f,v,h,a,0,i,u,c,p),v=x.c,h=x.lc;break}}if(d==m.lit)throw"hufDecode issues"}var g=8-o&7;for(v>>=g,h-=g;h>0;){var m;if(!(m=r[v<<t-h&l]).len)throw"hufDecode issues";h-=m.len,z(m.lit,f,v,h,a,0,i,u,c,p),v=x.c,h=x.lc}}(p,w,e,0,a,h,v,s,f,{value:0})}function k(e){for(var r=1;r<e.length;r++){var a=e[r-1]+e[r]-128;e[r]=a}}function F(e,r){for(var a=0,n=Math.floor((e.length+1)/2),t=0,i=e.length-1;!(t>i||(r[t++]=e[a++],t>i));)r[t++]=e[n++]}function _(e){for(var r=e.byteLength,a=new Array,n=0,t=new DataView(e);r>0;){var i=t.getInt8(n++);if(i<0){r-=(l=-i)+1;for(var o=0;o<l;o++)a.push(t.getUint8(n++))}else{var l=i;r-=2;var f=t.getUint8(n++);for(o=0;o<l+1;o++)a.push(f)}}return a}function X(e,r,a){for(var n,t=1;t<64;)65280==(n=r[e.value])?t=64:n>>8==255?t+=255&n:(a[t]=n,t++),e.value++}function Z(e){const r=.5*Math.cos(.7853975),a=.5*Math.cos(.196349375),n=.5*Math.cos(.39269875),t=.5*Math.cos(3*3.14159/16),i=.5*Math.cos(.981746875),o=.5*Math.cos(3*3.14159/8),l=.5*Math.cos(1.374445625);for(var f=new Array(4),s=new Array(4),u=new Array(4),c=new Array(4),v=0;v<8;++v){var h=8*v;f[0]=n*e[h+2],f[1]=o*e[h+2],f[2]=n*e[h+6],f[3]=o*e[h+6],s[0]=a*e[h+1]+t*e[h+3]+i*e[h+5]+l*e[h+7],s[1]=t*e[h+1]-l*e[h+3]-a*e[h+5]-i*e[h+7],s[2]=i*e[h+1]-a*e[h+3]+l*e[h+5]+t*e[h+7],s[3]=l*e[h+1]-i*e[h+3]+t*e[h+5]-a*e[h+7],u[0]=r*(e[h+0]+e[h+4]),u[3]=r*(e[h+0]-e[h+4]),u[1]=f[0]+f[3],u[2]=f[1]-f[2],c[0]=u[0]+u[1],c[1]=u[3]+u[2],c[2]=u[3]-u[2],c[3]=u[0]-u[1],e[h+0]=c[0]+s[0],e[h+1]=c[1]+s[1],e[h+2]=c[2]+s[2],e[h+3]=c[3]+s[3],e[h+4]=c[3]-s[3],e[h+5]=c[2]-s[2],e[h+6]=c[1]-s[1],e[h+7]=c[0]-s[0]}for(var p=0;p<8;++p)f[0]=n*e[16+p],f[1]=o*e[16+p],f[2]=n*e[48+p],f[3]=o*e[48+p],s[0]=a*e[8+p]+t*e[24+p]+i*e[40+p]+l*e[56+p],s[1]=t*e[8+p]-l*e[24+p]-a*e[40+p]-i*e[56+p],s[2]=i*e[8+p]-a*e[24+p]+l*e[40+p]+t*e[56+p],s[3]=l*e[8+p]-i*e[24+p]+t*e[40+p]-a*e[56+p],u[0]=r*(e[p]+e[32+p]),u[3]=r*(e[p]-e[32+p]),u[1]=f[0]+f[3],u[2]=f[1]-f[2],c[0]=u[0]+u[1],c[1]=u[3]+u[2],c[2]=u[3]-u[2],c[3]=u[0]-u[1],e[0+p]=c[0]+s[0],e[8+p]=c[1]+s[1],e[16+p]=c[2]+s[2],e[24+p]=c[3]+s[3],e[32+p]=c[3]-s[3],e[40+p]=c[2]-s[2],e[48+p]=c[1]-s[1],e[56+p]=c[0]-s[0]}function V(e){for(var r=0;r<64;++r){var a=e[0][r],n=e[1][r],t=e[2][r];e[0][r]=a+1.5747*t,e[1][r]=a-.1873*n-.4682*t,e[2][r]=a+1.8556*n}}function W(e,r,a){for(var n=0;n<64;++n)r[a+n]=ne(B(e[n]))}function B(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(b,Math.abs(e)-1)}function H(e){var r=e.array.slice(e.offset.value,e.offset.value+e.size);"undefined"==typeof Zlib&&console.error("THREE.EXRLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var a=new Zlib.Inflate(r,{resize:!0,verify:!0}),n=new Uint8Array(a.decompress().buffer),t=new Uint8Array(n.length);return k(n),F(n,t),new DataView(t.buffer)}function Y(e){var r=e.viewer,a={value:e.offset.value},n=new Uint8Array(e.width*e.lines*(fe.channels.length*e.type*p)),t={version:Q(r,a),unknownUncompressedSize:Q(r,a),unknownCompressedSize:Q(r,a),acCompressedSize:Q(r,a),dcCompressedSize:Q(r,a),rleCompressedSize:Q(r,a),rleUncompressedSize:Q(r,a),rleRawSize:Q(r,a),totalAcUncompressedCount:Q(r,a),totalDcUncompressedCount:Q(r,a),acCompression:Q(r,a)};if(t.version<2)throw"EXRLoader.parse: "+fe.compression+" version "+t.version+" is unsupported";for(var i=new Array,o=te(r,a)-p;o>0;){var l=j(r.buffer,a),f=K(r,a),s=f>>2&3,u=new Int8Array([(f>>4)-1])[0],c=K(r,a);i.push({name:l,index:u,type:c,compression:s}),o-=l.length+3}for(var v=fe.channels,h=new Array(e.channels),w=0;w<e.channels;++w){var b=h[w]={},A=v[w];b.name=A.name,b.compression=g,b.decoded=!1,b.type=A.pixelType,b.pLinear=A.pLinear,b.width=e.width,b.height=e.lines}for(var U={idx:new Array(3)},M=0;M<e.channels;++M)for(b=h[M],w=0;w<i.length;++w){var E=i[w];b.name==E.name&&(b.compression=E.compression,E.index>=0&&(U.idx[E.index]=M),b.offset=M)}if(t.acCompressedSize>0)switch(t.acCompression){case d:var I=new Uint16Array(t.totalAcUncompressedCount);D(e.array,r,a,t.acCompressedSize,I,t.totalAcUncompressedCount);break;case y:var O=e.array.slice(a.value,a.value+t.totalAcUncompressedCount),C=new Zlib.Inflate(O,{resize:!0,verify:!0});I=new Uint16Array(C.decompress().buffer);a.value+=t.totalAcUncompressedCount}if(t.dcCompressedSize>0){var R={array:e.array,offset:a,size:t.dcCompressedSize},x=new Uint16Array(H(R).buffer);a.value+=t.dcCompressedSize}if(t.rleRawSize>0){O=e.array.slice(a.value,a.value+t.rleCompressedSize);var z=_((C=new Zlib.Inflate(O,{resize:!0,verify:!0})).decompress().buffer);a.value+=t.rleCompressedSize}var P=0,T=new Array(h.length);for(w=0;w<T.length;++w)T[w]=new Array;for(var N=0;N<e.lines;++N)for(var L=0;L<h.length;++L)T[L].push(P),P+=h[L].width*e.type*p;!function(e,r,a,n,t,i){var o=new DataView(i.buffer),l=a[e.idx[0]].width,f=a[e.idx[0]].height,s=Math.floor(l/8),u=Math.ceil(l/8),c=Math.ceil(f/8),v=l-8*(u-1),h=f-8*(c-1),w={value:0},d=new Array(3),y=new Array(3),g=new Array(3),m=new Array(3),S=new Array(3);for(let a=0;a<3;++a)S[a]=r[e.idx[a]],d[a]=a<1?0:d[a-1]+u*c,y[a]=new Float32Array(64),g[a]=new Uint16Array(64),m[a]=new Uint16Array(64*u);for(let r=0;r<c;++r){var b=8;r==c-1&&(b=h);var A=8;for(let e=0;e<u;++e){e==u-1&&(A=v);for(let e=0;e<3;++e)g[e].fill(0),g[e][0]=t[d[e]++],X(w,n,g[e]),U=g[e],(M=y[e])[0]=ee(U[0]),M[1]=ee(U[1]),M[2]=ee(U[5]),M[3]=ee(U[6]),M[4]=ee(U[14]),M[5]=ee(U[15]),M[6]=ee(U[27]),M[7]=ee(U[28]),M[8]=ee(U[2]),M[9]=ee(U[4]),M[10]=ee(U[7]),M[11]=ee(U[13]),M[12]=ee(U[16]),M[13]=ee(U[26]),M[14]=ee(U[29]),M[15]=ee(U[42]),M[16]=ee(U[3]),M[17]=ee(U[8]),M[18]=ee(U[12]),M[19]=ee(U[17]),M[20]=ee(U[25]),M[21]=ee(U[30]),M[22]=ee(U[41]),M[23]=ee(U[43]),M[24]=ee(U[9]),M[25]=ee(U[11]),M[26]=ee(U[18]),M[27]=ee(U[24]),M[28]=ee(U[31]),M[29]=ee(U[40]),M[30]=ee(U[44]),M[31]=ee(U[53]),M[32]=ee(U[10]),M[33]=ee(U[19]),M[34]=ee(U[23]),M[35]=ee(U[32]),M[36]=ee(U[39]),M[37]=ee(U[45]),M[38]=ee(U[52]),M[39]=ee(U[54]),M[40]=ee(U[20]),M[41]=ee(U[22]),M[42]=ee(U[33]),M[43]=ee(U[38]),M[44]=ee(U[46]),M[45]=ee(U[51]),M[46]=ee(U[55]),M[47]=ee(U[60]),M[48]=ee(U[21]),M[49]=ee(U[34]),M[50]=ee(U[37]),M[51]=ee(U[47]),M[52]=ee(U[50]),M[53]=ee(U[56]),M[54]=ee(U[59]),M[55]=ee(U[61]),M[56]=ee(U[35]),M[57]=ee(U[36]),M[58]=ee(U[48]),M[59]=ee(U[49]),M[60]=ee(U[57]),M[61]=ee(U[58]),M[62]=ee(U[62]),M[63]=ee(U[63]),Z(y[e]);V(y);for(let r=0;r<3;++r)W(y[r],m[r],64*e)}let i=0;for(let n=0;n<3;++n){let t=a[e.idx[n]].type;for(let e=8*r;e<8*r+b;++e){i=S[n][e];for(let r=0;r<s;++r){let a=64*r+8*(7&e);o.setUint16(i+0*p*t,m[n][a+0],!0),o.setUint16(i+1*p*t,m[n][a+1],!0),o.setUint16(i+2*p*t,m[n][a+2],!0),o.setUint16(i+3*p*t,m[n][a+3],!0),o.setUint16(i+4*p*t,m[n][a+4],!0),o.setUint16(i+5*p*t,m[n][a+5],!0),o.setUint16(i+6*p*t,m[n][a+6],!0),o.setUint16(i+7*p*t,m[n][a+7],!0),i+=8*p*t}}if(s!=u)for(let e=8*r;e<8*r+b;++e){let r=S[n][e]+8*s*p*t,a=64*s+8*(7&e);for(let e=0;e<A;++e)o.setUint16(r+e*p*t,m[n][a+e],!0)}}}var U,M;for(var E=new Uint16Array(l),I=(o=new DataView(i.buffer),0);I<3;++I){a[e.idx[I]].decoded=!0;var O=a[e.idx[I]].type;if(2==a[I].type)for(var C=0;C<f;++C){let e=S[I][C];for(var R=0;R<l;++R)E[R]=o.getUint16(e+R*p*O,!0);for(R=0;R<l;++R)o.setFloat32(e+R*p*O,ee(E[R]),!0)}}}(U,T,h,I,x,n);for(w=0;w<h.length;++w){if(!(b=h[w]).decoded)switch(b.compression){case S:var k=0,F=0;for(N=0;N<e.lines;++N){for(var B=T[w][k],Y=0;Y<b.width;++Y){for(var G=0;G<p*b.type;++G)n[B++]=z[F+G*b.width*b.height];F++}k++}break;case m:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(n.buffer)}function j(e,r){for(var a=new Uint8Array(e),n=0;0!=a[r.value+n];)n+=1;var t=(new TextDecoder).decode(a.slice(r.value,r.value+n));return r.value=r.value+n+1,t}function G(e,r){var a=e.getUint32(0,!0);return r.value=r.value+c,a}function q(e,r){var a=e.getUint32(r.value,!0);return r.value=r.value+h,a}function J(e,r){var a=e[r.value];return r.value=r.value+w,a}function K(e,r){var a=e.getUint8(r.value);return r.value=r.value+w,a}function Q(e,r){var a=Number(e.getBigInt64(r.value,!0));return r.value+=c,a}function $(e,r){var a=e.getFloat32(r.value,!0);return r.value+=v,a}function ee(e){var r=(31744&e)>>10,a=1023&e;return(e>>15?-1:1)*(r?31===r?a?NaN:1/0:Math.pow(2,r-15)*(1+a/1024):a/1024*6103515625e-14)}var re,ae,ne=(re=new Float32Array(1),ae=new Int32Array(re.buffer),function(e){re[0]=e;var r=ae[0],a=r>>16&32768,n=r>>12&2047,t=r>>23&255;return t<103?a:t>142?(a|=31744,a|=(255==t?0:1)&&8388607&r):t<113?a|=((n|=2048)>>114-t)+(n>>113-t&1):(a|=t-112<<10|n>>1,a+=1&n)});function te(e,r){var a=e.getUint16(r.value,!0);return r.value+=p,a}function ie(e,r,a,n,t){if("string"===n||"stringvector"===n||"iccProfile"===n)return function(e,r,a){var n=(new TextDecoder).decode(new Uint8Array(e).slice(r.value,r.value+a));return r.value=r.value+a,n}(r,a,t);if("chlist"===n)return function(e,r,a,n){for(var t=a.value,i=[];a.value<t+n-1;){var o=j(r,a),l=q(e,a),f=K(e,a);a.value+=3;var s=q(e,a),u=q(e,a);i.push({name:o,pixelType:l,pLinear:f,xSampling:s,ySampling:u})}return a.value+=1,i}(e,r,a,t);if("chromaticities"===n)return function(e,r){return{redX:$(e,r),redY:$(e,r),greenX:$(e,r),greenY:$(e,r),blueX:$(e,r),blueY:$(e,r),whiteX:$(e,r),whiteY:$(e,r)}}(e,a);if("compression"===n)return function(e,r){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][K(e,r)]}(e,a);if("box2i"===n)return function(e,r){return{xMin:q(e,r),yMin:q(e,r),xMax:q(e,r),yMax:q(e,r)}}(e,a);if("lineOrder"===n)return function(e,r){return["INCREASING_Y"][K(e,r)]}(e,a);if("float"===n)return $(e,a);if("v2f"===n)return function(e,r){return[$(e,r),$(e,r)]}(e,a);if("int"===n)return q(e,a);throw"Cannot parse value for unsupported type: "+n}var oe=new DataView(r),le=new Uint8Array(r),fe={};oe.getUint32(0,!0),oe.getUint8(4,!0),oe.getUint8(5,!0);for(var se={value:8},ue=!0;ue;){var ce=j(r,se);if(0==ce)ue=!1;else{var ve=ie(oe,r,se,j(r,se),q(oe,se));fe[ce]=ve}}var he,pe,we,de,ye=fe.dataWindow.yMax+1;switch(fe.compression){case"NO_COMPRESSION":pe=1,he=function(e){return new DataView(e.array.buffer,e.offset.value,e.size)};break;case"RLE_COMPRESSION":pe=1,he=function(e){var r=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),a=new Uint8Array(_(r)),n=new Uint8Array(a.length);return k(a),F(a,n),new DataView(n.buffer)};break;case"ZIPS_COMPRESSION":pe=1,he=H;break;case"ZIP_COMPRESSION":pe=16,he=H;break;case"PIZ_COMPRESSION":pe=32,he=function(e){for(var r=e.viewer,t={value:e.offset.value},i=e.width*pe*(fe.channels.length*e.type),o=new Uint16Array(i),l=new Uint8Array(n),f=0,s=new Array(e.channels),u=0;u<e.channels;u++)s[u]={},s[u].start=f,s[u].end=s[u].start,s[u].nx=e.width,s[u].ny=e.lines,s[u].size=e.type,f+=s[u].nx*s[u].ny*s[u].size;var c=te(r,t),v=te(r,t);if(v>=n)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(c<=v)for(u=0;u<v-c+1;u++)l[u+c]=K(r,t);var h=new Uint16Array(a);!function(e,r){for(var n=0,t=0;t<a;++t)(0==t||e[t>>3]&1<<(7&t))&&(r[n++]=t);for(;n<a;)r[n++]=0}(l,h);var w=q(r,t);for(D(e.array,r,t,w,o,f),u=0;u<e.channels;++u)for(var d=s[u],y=0;y<s[u].size;++y)L(o,d.start+y,d.nx,d.size,d.ny,d.nx*d.size);!function(e,r,a){for(var n=0;n<a;++n)r[n]=e[r[n]]}(h,o,f);for(var g=0,m=new Uint8Array(o.buffer.byteLength),S=0;S<e.lines;S++)for(var b=0;b<e.channels;b++){var A=(d=s[b]).nx*d.size,U=new Uint8Array(o.buffer,d.end*p,A*p);m.set(U,g),g+=A*p,d.end+=A}return new DataView(m.buffer)};break;case"DWAA_COMPRESSION":pe=32,he=Y;break;case"DWAB_COMPRESSION":pe=256,he=Y;break;default:throw"EXRLoader.parse: "+fe.compression+" is unsupported"}var ge=fe.channels[0].pixelType;if(1===ge)switch(this.type){case e.FloatType:de=function(e,r){return ee(te(e,r))},we=p;break;case e.HalfFloatType:de=te,we=p}else{if(2!==ge)throw"EXRLoader.parse: unsupported pixelType "+ge+" for "+fe.compression+".";switch(this.type){case e.FloatType:de=$,we=v;break;case e.HalfFloatType:throw"EXRLoader.parse: unsupported HalfFloatType texture for FloatType image file."}}for(var me=ye/pe,Se=0;Se<me;Se++)G(oe,se);var be=fe.dataWindow.xMax-fe.dataWindow.xMin+1,Ae=fe.dataWindow.yMax-fe.dataWindow.yMin+1,Ue=be*Ae*4;switch(this.type){case e.FloatType:var Me=new Float32Array(Ue);fe.channels.length<4&&Me.fill(1,0,Ue);break;case e.HalfFloatType:Me=new Uint16Array(Ue);fe.channels.length<4&&Me.fill(15360,0,Ue);break;default:console.error("THREE.EXRLoader: unsupported type: ",this.type)}for(var Ee,Ie,Oe={R:0,G:1,B:2,A:3},Ce={size:0,width:be,lines:pe,offset:se,array:le,viewer:oe,type:ge,channels:fe.channels.length},Re={value:0},xe=0;xe<Ae/pe;xe++){Ee=q(oe,se),Ue=q(oe,se),Ce.lines=Ee+pe>Ae?Ae-Ee:pe,Ce.offset=se,Ce.size=Ue,Ie=he(Ce),se.value+=Ue;for(var ze=0;ze<pe;ze++){var Pe=ze+xe*pe;if(Pe>=Ae)break;for(var Te=0;Te<fe.channels.length;Te++)for(var Ne=Oe[fe.channels[Te].name],Le=0;Le<be;Le++){var De=ze*(fe.channels.length*be)+Te*be+Le;Re.value=De*we;var ke=de(Ie,Re);Me[4*be*(Ae-1-Pe)+4*Le+Ne]=ke}}}return{header:fe,width:be,height:Ae,data:Me,format:e.RGBAFormat,type:this.type}},setDataType:function(e){return this.type=e,this},load:function(r,a,n,t){return e.DataTextureLoader.prototype.load.call(this,r,function(r,n){switch(r.type){case e.FloatType:case e.HalfFloatType:r.encoding=e.LinearEncoding,r.minFilter=e.LinearFilter,r.magFilter=e.LinearFilter,r.generateMipmaps=!1,r.flipY=!1}a&&a(r,n)},n,t)}}),e.EXRLoader});
//# sourceMappingURL=../sourcemaps/loaders/EXRLoader.js.map

/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs","../threex"],function(r,e){"use strict";var a=function(e){r.CompressedTextureLoader.call(this,e)};return a.prototype=Object.assign(Object.create(r.CompressedTextureLoader.prototype),{constructor:a,parse:function(e,a){var t={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function o(r){return r.charCodeAt(0)+(r.charCodeAt(1)<<8)+(r.charCodeAt(2)<<16)+(r.charCodeAt(3)<<24)}function n(r,e,a,t){for(var o=a*t*4,n=new Uint8Array(r,e,o),i=new Uint8Array(o),m=0,s=0,u=0;u<t;u++)for(var p=0;p<a;p++){var c=n[s],h=n[++s],d=n[++s],f=n[++s];s++,i[m]=d,i[++m]=h,i[++m]=c,i[++m]=f,m++}return i}var i,m=o("DXT1"),s=o("DXT3"),u=o("DXT5"),p=o("ETC1"),c=new Int32Array(e,0,31);if(542327876!==c[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),t;if(4&!c[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),t;var h,d=c[21],f=!1;switch(d){case m:i=8,t.format=r.RGB_S3TC_DXT1_Format;break;case s:i=16,t.format=r.RGBA_S3TC_DXT3_Format;break;case u:i=16,t.format=r.RGBA_S3TC_DXT5_Format;break;case p:i=8,t.format=r.RGB_ETC1_Format;break;default:if(!(32===c[22]&&16711680&c[23]&&65280&c[24]&&255&c[25]&&4278190080&c[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",(h=d,String.fromCharCode(255&h,h>>8&255,h>>16&255,h>>24&255))),t;f=!0,i=64,t.format=r.RGBAFormat}t.mipmapCount=1,131072&c[2]&&!1!==a&&(t.mipmapCount=Math.max(1,c[7]));var C=c[28];if(t.isCubemap=!!(512&C),t.isCubemap&&(!(1024&C)||!(2048&C)||!(4096&C)||!(8192&C)||!(16384&C)||!(32768&C)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),t;t.width=c[4],t.height=c[3];for(var D=c[1]+4,T=t.isCubemap?6:1,l=0;l<T;l++)for(var v=t.width,b=t.height,A=0;A<t.mipmapCount;A++){if(f)var _=(E=n(e,D,v,b)).length;else{_=Math.max(4,v)/4*Math.max(4,b)/4*i;var E=new Uint8Array(e,D,_)}var S={data:E,width:v,height:b};t.mipmaps.push(S),D+=_,v=Math.max(v>>1,1),b=Math.max(b>>1,1)}return t}}),e.loaders.DDSLoader=a});
//# sourceMappingURL=../sourcemaps/loaders/DDSLoader.js.map

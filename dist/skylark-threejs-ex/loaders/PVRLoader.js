/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs","../threex"],function(r,a){"use strict";var e=function(a){r.CompressedTextureLoader.call(this,a)};return e.prototype=Object.assign(Object.create(r.CompressedTextureLoader.prototype),{constructor:e,parse:function(r,a){var t=new Uint32Array(r,0,13),o={buffer:r,header:t,loadMipmaps:a};return 55727696===t[0]?e._parseV3(o):559044176===t[11]?e._parseV2(o):void console.error("THREE.PVRLoader: Unknown PVR format.")}}),e._parseV3=function(a){var t,o,m=a.header,n=m[12],p=m[2],s=m[6],i=m[7],u=m[10],P=m[11];switch(p){case 0:t=2,o=r.RGB_PVRTC_2BPPV1_Format;break;case 1:t=2,o=r.RGBA_PVRTC_2BPPV1_Format;break;case 2:t=4,o=r.RGB_PVRTC_4BPPV1_Format;break;case 3:t=4,o=r.RGBA_PVRTC_4BPPV1_Format;break;default:console.error("THREE.PVRLoader: Unsupported PVR format:",p)}return a.dataPtr=52+n,a.bpp=t,a.format=o,a.width=i,a.height=s,a.numSurfaces=u,a.numMipmaps=P,a.isCubemap=6===u,e._extract(a)},e._parseV2=function(a){var t,o,m=a.header,n=m[0],p=m[1],s=m[2],i=m[3],u=m[4],P=m[10],_=m[12],c=255&u,d=P>0;return 25===c?(o=d?r.RGBA_PVRTC_4BPPV1_Format:r.RGB_PVRTC_4BPPV1_Format,t=4):24===c?(o=d?r.RGBA_PVRTC_2BPPV1_Format:r.RGB_PVRTC_2BPPV1_Format,t=2):console.error("THREE.PVRLoader: Unknown PVR format:",c),a.dataPtr=n,a.bpp=t,a.format=o,a.width=s,a.height=p,a.numSurfaces=_,a.numMipmaps=i+1,a.isCubemap=6===_,e._extract(a)},e._extract=function(r){var a,e={mipmaps:[],width:r.width,height:r.height,format:r.format,mipmapCount:r.numMipmaps,isCubemap:r.isCubemap},t=r.buffer,o=r.dataPtr,m=r.bpp,n=r.numSurfaces,p=0,s=0,i=0,u=0,P=0;2===m?(s=8,i=4):(s=4,i=4),a=s*i*m/8,e.mipmaps.length=r.numMipmaps*n;for(var _=0;_<r.numMipmaps;){var c=r.width>>_,d=r.height>>_;P=d/i,(u=c/s)<2&&(u=2),P<2&&(P=2),p=u*P*a;for(var V=0;V<n;V++){var h={data:new Uint8Array(t,o,p),width:c,height:d};e.mipmaps[V*r.numMipmaps+_]=h,o+=p}_++}return e},a.loaders.PVRLoader=e});
//# sourceMappingURL=../sourcemaps/loaders/PVRLoader.js.map

/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs","../threex"],function(t,e){"use strict";var r=function(e){t.Loader.call(this,e)};return r.prototype=Object.assign(Object.create(t.Loader.prototype),{constructor:r,load:function(e,r,n,o){var a=this,i=new t.FileLoader(a.manager);i.setPath(a.path),i.setResponseType("arraybuffer"),i.load(e,function(t){try{r(a.parse(t))}catch(t){o&&o(t)}},n,o)},parse:function(e){function r(t,e,r){for(var n=0,o=t.length;n<o;n++)if(t[n]!==e.getUint8(r+n,!1))return!1;return!0}var n,o=function(t){if("string"==typeof t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=255&t.charCodeAt(r);return e.buffer||e}return t}(e);return function(t){var e;if(84+50*(e=new DataView(t)).getUint32(80,!0)===e.byteLength)return!0;for(var n=[115,111,108,105,100],o=0;o<5;o++)if(r(n,e,o))return!1;return!0}(o)?function(e){for(var r,n,o,a,i,f,u,l,s=new DataView(e),c=s.getUint32(80,!0),g=!1,p=0;p<70;p++)1129270351==s.getUint32(p,!1)&&82==s.getUint8(p+4)&&61==s.getUint8(p+5)&&(g=!0,a=new Float32Array(3*c*3),i=s.getUint8(p+6)/255,f=s.getUint8(p+7)/255,u=s.getUint8(p+8)/255,l=s.getUint8(p+9)/255);for(var h=new t.BufferGeometry,d=new Float32Array(3*c*3),w=new Float32Array(3*c*3),v=0;v<c;v++){var y=84+50*v,F=s.getFloat32(y,!0),b=s.getFloat32(y+4,!0),A=s.getFloat32(y+8,!0);if(g){var U=s.getUint16(y+48,!0);0==(32768&U)?(r=(31&U)/31,n=(U>>5&31)/31,o=(U>>10&31)/31):(r=i,n=f,o=u)}for(var m=1;m<=3;m++){var x=y+12*m,L=3*v*3+3*(m-1);d[L]=s.getFloat32(x,!0),d[L+1]=s.getFloat32(x+4,!0),d[L+2]=s.getFloat32(x+8,!0),w[L]=F,w[L+1]=b,w[L+2]=A,g&&(a[L]=r,a[L+1]=n,a[L+2]=o)}}return h.setAttribute("position",new t.BufferAttribute(d,3)),h.setAttribute("normal",new t.BufferAttribute(w,3)),g&&(h.setAttribute("color",new t.BufferAttribute(a,3)),h.hasColors=!0,h.alpha=l),h}(o):function(e){for(var r,n=new t.BufferGeometry,o=/solid([\s\S]*?)endsolid/g,a=/facet([\s\S]*?)endfacet/g,i=0,f=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,u=new RegExp("vertex"+f+f+f,"g"),l=new RegExp("normal"+f+f+f,"g"),s=[],c=[],g=new t.Vector3,p=0,h=0,d=0;null!==(r=o.exec(e));){h=d;for(var w=r[0];null!==(r=a.exec(w));){for(var v=0,y=0,F=r[0];null!==(r=l.exec(F));)g.x=parseFloat(r[1]),g.y=parseFloat(r[2]),g.z=parseFloat(r[3]),y++;for(;null!==(r=u.exec(F));)s.push(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])),c.push(g.x,g.y,g.z),v++,d++;1!==y&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+i),3!==v&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+i),i++}var b=h,A=d-h;n.addGroup(b,A,p),p++}return n.setAttribute("position",new t.Float32BufferAttribute(s,3)),n.setAttribute("normal",new t.Float32BufferAttribute(c,3)),n}("string"!=typeof(n=e)?t.LoaderUtils.decodeText(new Uint8Array(n)):n)}}),e.loaders.STLLoader=r});
//# sourceMappingURL=../sourcemaps/loaders/STLLoader.js.map

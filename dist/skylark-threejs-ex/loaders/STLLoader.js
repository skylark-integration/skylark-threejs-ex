/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs"],function(e){return e.STLLoader=function(t){e.Loader.call(this,t)},e.STLLoader.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:e.STLLoader,load:function(t,r,n,o){var a=this,i=new e.FileLoader(a.manager);i.setPath(a.path),i.setResponseType("arraybuffer"),i.load(t,function(e){try{r(a.parse(e))}catch(e){o&&o(e)}},n,o)},parse:function(t){function r(e,t,r){for(var n=0,o=e.length;n<o;n++)if(e[n]!==t.getUint8(r+n,!1))return!1;return!0}var n,o=function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(t);return function(e){var t;if(84+50*(t=new DataView(e)).getUint32(80,!0)===t.byteLength)return!0;for(var n=[115,111,108,105,100],o=0;o<5;o++)if(r(n,t,o))return!1;return!0}(o)?function(t){for(var r,n,o,a,i,f,u,l,s=new DataView(t),g=s.getUint32(80,!0),c=!1,d=0;d<70;d++)1129270351==s.getUint32(d,!1)&&82==s.getUint8(d+4)&&61==s.getUint8(d+5)&&(c=!0,a=new Float32Array(3*g*3),i=s.getUint8(d+6)/255,f=s.getUint8(d+7)/255,u=s.getUint8(d+8)/255,l=s.getUint8(d+9)/255);for(var p=new e.BufferGeometry,h=new Float32Array(3*g*3),w=new Float32Array(3*g*3),v=0;v<g;v++){var y=84+50*v,F=s.getFloat32(y,!0),b=s.getFloat32(y+4,!0),L=s.getFloat32(y+8,!0);if(c){var A=s.getUint16(y+48,!0);0==(32768&A)?(r=(31&A)/31,n=(A>>5&31)/31,o=(A>>10&31)/31):(r=i,n=f,o=u)}for(var U=1;U<=3;U++){var m=y+12*U,x=3*v*3+3*(U-1);h[x]=s.getFloat32(m,!0),h[x+1]=s.getFloat32(m+4,!0),h[x+2]=s.getFloat32(m+8,!0),w[x]=F,w[x+1]=b,w[x+2]=L,c&&(a[x]=r,a[x+1]=n,a[x+2]=o)}}return p.setAttribute("position",new e.BufferAttribute(h,3)),p.setAttribute("normal",new e.BufferAttribute(w,3)),c&&(p.setAttribute("color",new e.BufferAttribute(a,3)),p.hasColors=!0,p.alpha=l),p}(o):function(t){for(var r,n=new e.BufferGeometry,o=/solid([\s\S]*?)endsolid/g,a=/facet([\s\S]*?)endfacet/g,i=0,f=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,u=new RegExp("vertex"+f+f+f,"g"),l=new RegExp("normal"+f+f+f,"g"),s=[],g=[],c=new e.Vector3,d=0,p=0,h=0;null!==(r=o.exec(t));){p=h;for(var w=r[0];null!==(r=a.exec(w));){for(var v=0,y=0,F=r[0];null!==(r=l.exec(F));)c.x=parseFloat(r[1]),c.y=parseFloat(r[2]),c.z=parseFloat(r[3]),y++;for(;null!==(r=u.exec(F));)s.push(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])),g.push(c.x,c.y,c.z),v++,h++;1!==y&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+i),3!==v&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+i),i++}var b=p,L=h-p;n.addGroup(b,L,d),d++}return n.setAttribute("position",new e.Float32BufferAttribute(s,3)),n.setAttribute("normal",new e.Float32BufferAttribute(g,3)),n}("string"!=typeof(n=t)?e.LoaderUtils.decodeText(new Uint8Array(n)):n)}}),e.STLLoader});
//# sourceMappingURL=../sourcemaps/loaders/STLLoader.js.map

/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs","../threex"],function(e,t){"use strict";var r=function(t){e.Loader.call(this,t),this.splitLayer=!1};return r.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:r,load:function(t,r,a,i){var o=this,n=new e.FileLoader(o.manager);n.setPath(o.path),n.load(t,function(e){r(o.parse(e))},a,i)},parse:function(t){var r={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},a=[],i=void 0,o=new e.LineBasicMaterial({color:16711680});o.name="path";var n=new e.LineBasicMaterial({color:65280});function s(e){i={vertex:[],pathVertex:[],z:e.z},a.push(i)}function v(e,t){return r.relative?t:t-e}function l(e,t){return r.relative?e+t:t}n.name="extruded";for(var u,f,d=t.replace(/;.+/g,"").split("\n"),c=0;c<d.length;c++){var p=d[c].split(" "),x=p[0].toUpperCase(),h={};if(p.splice(1).forEach(function(e){if(void 0!==e[0]){var t=e[0].toLowerCase(),r=parseFloat(e.substring(1));h[t]=r}}),"G0"===x||"G1"===x){var y={x:void 0!==h.x?l(r.x,h.x):r.x,y:void 0!==h.y?l(r.y,h.y):r.y,z:void 0!==h.z?l(r.z,h.z):r.z,e:void 0!==h.e?l(r.e,h.e):r.e,f:void 0!==h.f?l(r.f,h.f):r.f};v(r.e,y.e)>0&&(y.extruding=v(r.e,y.e)>0,void 0!=i&&y.z==i.z||s(y)),u=r,f=y,void 0===i&&s(u),y.extruding?(i.vertex.push(u.x,u.y,u.z),i.vertex.push(f.x,f.y,f.z)):(i.pathVertex.push(u.x,u.y,u.z),i.pathVertex.push(f.x,f.y,f.z)),r=y}else if("G2"===x||"G3"===x);else if("G90"===x)r.relative=!1;else if("G91"===x)r.relative=!0;else if("G92"===x){(y=r).x=void 0!==h.x?h.x:y.x,y.y=void 0!==h.y?h.y:y.y,y.z=void 0!==h.z?h.z:y.z,y.e=void 0!==h.e?h.e:y.e,r=y}}function z(t,r){var a=new e.BufferGeometry;a.setAttribute("position",new e.Float32BufferAttribute(t,3));var i=new e.LineSegments(a,r?n:o);i.name="layer"+c,g.add(i)}var g=new e.Group;if(g.name="gcode",this.splitLayer)for(c=0;c<a.length;c++){z((w=a[c]).vertex,!0),z(w.pathVertex,!1)}else{var G=[],L=[];for(c=0;c<a.length;c++){var w=a[c];G=G.concat(w.vertex),L=L.concat(w.pathVertex)}z(G,!0),z(L,!1)}return g.quaternion.setFromEuler(new e.Euler(-Math.PI/2,0,0)),g}}),t.loaders.GCodeLoader=r});
//# sourceMappingURL=../sourcemaps/loaders/GCodeLoader.js.map

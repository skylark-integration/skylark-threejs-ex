/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs"],function(e){return e.GCodeLoader=function(t){e.Loader.call(this,t),this.splitLayer=!1},e.GCodeLoader.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:e.GCodeLoader,load:function(t,r,a,o){var i=this,n=new e.FileLoader(i.manager);n.setPath(i.path),n.load(t,function(e){r(i.parse(e))},a,o)},parse:function(t){var r={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},a=[],o=void 0,i=new e.LineBasicMaterial({color:16711680});i.name="path";var n=new e.LineBasicMaterial({color:65280});function s(e){o={vertex:[],pathVertex:[],z:e.z},a.push(o)}function d(e,t){return r.relative?t:t-e}function v(e,t){return r.relative?e+t:t}n.name="extruded";for(var l,u,f=t.replace(/;.+/g,"").split("\n"),p=0;p<f.length;p++){var c=f[p].split(" "),x=c[0].toUpperCase(),h={};if(c.splice(1).forEach(function(e){if(void 0!==e[0]){var t=e[0].toLowerCase(),r=parseFloat(e.substring(1));h[t]=r}}),"G0"===x||"G1"===x){var y={x:void 0!==h.x?v(r.x,h.x):r.x,y:void 0!==h.y?v(r.y,h.y):r.y,z:void 0!==h.z?v(r.z,h.z):r.z,e:void 0!==h.e?v(r.e,h.e):r.e,f:void 0!==h.f?v(r.f,h.f):r.f};d(r.e,y.e)>0&&(y.extruding=d(r.e,y.e)>0,void 0!=o&&y.z==o.z||s(y)),l=r,u=y,void 0===o&&s(l),y.extruding?(o.vertex.push(l.x,l.y,l.z),o.vertex.push(u.x,u.y,u.z)):(o.pathVertex.push(l.x,l.y,l.z),o.pathVertex.push(u.x,u.y,u.z)),r=y}else if("G2"===x||"G3"===x);else if("G90"===x)r.relative=!1;else if("G91"===x)r.relative=!0;else if("G92"===x){(y=r).x=void 0!==h.x?h.x:y.x,y.y=void 0!==h.y?h.y:y.y,y.z=void 0!==h.z?h.z:y.z,y.e=void 0!==h.e?h.e:y.e,r=y}}function z(t,r){var a=new e.BufferGeometry;a.setAttribute("position",new e.Float32BufferAttribute(t,3));var o=new e.LineSegments(a,r?n:i);o.name="layer"+p,G.add(o)}var G=new e.Group;if(G.name="gcode",this.splitLayer)for(p=0;p<a.length;p++){z((w=a[p]).vertex,!0),z(w.pathVertex,!1)}else{var L=[],g=[];for(p=0;p<a.length;p++){var w=a[p];L=L.concat(w.vertex),g=g.concat(w.pathVertex)}z(L,!0),z(g,!1)}return G.quaternion.setFromEuler(new e.Euler(-Math.PI/2,0,0)),G}}),e.GCodeLoader});
//# sourceMappingURL=../sourcemaps/loaders/GCodeLoader.js.map

/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
define(["skylark-threejs"],function(a){return a.MTLLoader=function(t){a.Loader.call(this,t)},a.MTLLoader.prototype=Object.assign(Object.create(a.Loader.prototype),{constructor:a.MTLLoader,load:function(t,r,e,s){var i=this,o=""===this.path?a.LoaderUtils.extractUrlBase(t):this.path,n=new a.FileLoader(this.manager);n.setPath(this.path),n.load(t,function(a){r(i.parse(a,o))},e,s)},setMaterialOptions:function(a){return this.materialOptions=a,this},parse:function(t,r){for(var e=t.split("\n"),s={},i=/\s+/,o={},n=0;n<e.length;n++){var p=e[n];if(0!==(p=p.trim()).length&&"#"!==p.charAt(0)){var l=p.indexOf(" "),h=l>=0?p.substring(0,l):p;h=h.toLowerCase();var c=l>=0?p.substring(l+1):"";if(c=c.trim(),"newmtl"===h)s={name:c},o[c]=s;else if("ka"===h||"kd"===h||"ks"===h||"ke"===h){var u=c.split(i,3);s[h]=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])]}else s[h]=c}}var m=new a.MTLLoader.MaterialCreator(this.resourcePath||r,this.materialOptions);return m.setCrossOrigin(this.crossOrigin),m.setManager(this.manager),m.setMaterials(o),m}}),a.MTLLoader.MaterialCreator=function(t,r){this.baseUrl=t||"",this.options=r,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:a.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:a.RepeatWrapping},a.MTLLoader.MaterialCreator.prototype={constructor:a.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(a){return this.crossOrigin=a,this},setManager:function(a){this.manager=a},setMaterials:function(a){this.materialsInfo=this.convert(a),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(a){if(!this.options)return a;var t={};for(var r in a){var e=a[r],s={};for(var i in t[r]=s,e){var o=!0,n=e[i],p=i.toLowerCase();switch(p){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===n[0]&&0===n[1]&&0===n[2]&&(o=!1)}o&&(s[p]=n)}}return t},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0;for(var t in this.materialsInfo)this.materialsArray[a]=this.create(t),this.nameLookup[t]=a,a++;return this.materialsArray},create:function(a){return void 0===this.materials[a]&&this.createMaterial_(a),this.materials[a]},createMaterial_:function(t){var r=this,e=this.materialsInfo[t],s={name:t,side:this.side};function i(a,t){if(!s[a]){var e,i,o=r.getTextureParams(t,s),n=r.loadTexture((e=r.baseUrl,"string"!=typeof(i=o.url)||""===i?"":/^https?:\/\//i.test(i)?i:e+i));n.repeat.copy(o.scale),n.offset.copy(o.offset),n.wrapS=r.wrap,n.wrapT=r.wrap,s[a]=n}}for(var o in e){var n,p=e[o];if(""!==p)switch(o.toLowerCase()){case"kd":s.color=(new a.Color).fromArray(p);break;case"ks":s.specular=(new a.Color).fromArray(p);break;case"ke":s.emissive=(new a.Color).fromArray(p);break;case"map_kd":i("map",p);break;case"map_ks":i("specularMap",p);break;case"map_ke":i("emissiveMap",p);break;case"norm":i("normalMap",p);break;case"map_bump":case"bump":i("bumpMap",p);break;case"map_d":i("alphaMap",p),s.transparent=!0;break;case"ns":s.shininess=parseFloat(p);break;case"d":(n=parseFloat(p))<1&&(s.opacity=n,s.transparent=!0);break;case"tr":n=parseFloat(p),this.options&&this.options.invertTrProperty&&(n=1-n),n>0&&(s.opacity=1-n,s.transparent=!0)}}return this.materials[t]=new a.MeshPhongMaterial(s),this.materials[t]},getTextureParams:function(t,r){var e,s={scale:new a.Vector2(1,1),offset:new a.Vector2(0,0)},i=t.split(/\s+/);return(e=i.indexOf("-bm"))>=0&&(r.bumpScale=parseFloat(i[e+1]),i.splice(e,2)),(e=i.indexOf("-s"))>=0&&(s.scale.set(parseFloat(i[e+1]),parseFloat(i[e+2])),i.splice(e,4)),(e=i.indexOf("-o"))>=0&&(s.offset.set(parseFloat(i[e+1]),parseFloat(i[e+2])),i.splice(e,4)),s.url=i.join(" ").trim(),s},loadTexture:function(t,r,e,s,i){var o,n=void 0!==this.manager?this.manager:a.DefaultLoadingManager,p=n.getHandler(t);return null===p&&(p=new a.TextureLoader(n)),p.setCrossOrigin&&p.setCrossOrigin(this.crossOrigin),o=p.load(t,e,s,i),void 0!==r&&(o.mapping=r),o}},a.MTLLoader});
//# sourceMappingURL=../sourcemaps/loaders/MTLLoader.js.map
